{"ast":null,"code":"/* eslint-disable no-multi-spaces, key-spacing, indent, camelcase, space-before-blocks, eqeqeq, brace-style */\n\n/* eslint-disable space-infix-ops, space-before-function-paren, array-bracket-spacing, object-curly-spacing */\n\n/* eslint-disable no-nested-ternary, max-params, default-case, no-else-return, no-empty, yoda */\n\n/* eslint-disable no-param-reassign, no-var, block-scoped-var */\nimport * as geo from \"../geometry\";\nimport * as PDF from \"../pdf\";\nimport { arabicToRoman, createPromise, measureText, mergeSort } from '../util';\nimport { parseColor as utils_parseColor, support, template as compileTemplate } from \"../common\";\nimport { Path, Text, Group, Image, Circle, LinearGradient } from \"../drawing\";\nimport { encodeBase64 } from \"../util\";\nvar browser = support.browser || {};\n/*\n\n  XXX: to test:\n\n  - cloneNodes function:\n    - drawing document containing canvas with page breaking\n    - drawing document with named radio <input>-s (should not clear selection)\n    - IE9/IE10 don't support el.dataset; do they copy user data?\n\n  - repeating table headers/footers on page breaking\n\n  - forceBreak, keepTogether\n\n  - avoidLinks\n\n */\n\n/* -----[ local vars ]----- */\n\nfunction slice(thing) {\n  return Array.prototype.slice.call(thing);\n}\n\nvar KENDO_PSEUDO_ELEMENT = \"KENDO-PSEUDO-ELEMENT\";\nvar IMAGE_CACHE = {};\nvar nodeInfo = {};\nnodeInfo._root = nodeInfo;\n/* -----[ Custom Text node to speed up rendering in PDF ]----- */\n\nvar inBrowser = typeof window !== 'undefined';\nvar microsoft = inBrowser ? browser.msie || browser.edge : false;\n\nvar TextRect = function (Text) {\n  function TextRect(str, rect, options) {\n    Text.call(this, str, rect.getOrigin(), options);\n    this._pdfRect = rect;\n  }\n\n  if (Text) TextRect.__proto__ = Text;\n  TextRect.prototype = Object.create(Text && Text.prototype);\n  TextRect.prototype.constructor = TextRect;\n\n  TextRect.prototype.rect = function rect() {\n    // this is the crux of it: we can avoid a call to\n    // measure(), which is what the base class does, since we\n    // already know the rect.  measure() is s-l-o-w.\n    return this._pdfRect;\n  };\n\n  TextRect.prototype.rawBBox = function rawBBox() {\n    // also let's avoid creating a new rectangle.\n    return this._pdfRect;\n  };\n\n  return TextRect;\n}(Text);\n\nfunction addClass(el, cls) {\n  if (el.classList) {\n    el.classList.add(cls);\n  } else {\n    el.className += \" \" + cls;\n  }\n}\n\nfunction removeClass(el, cls) {\n  if (el.classList) {\n    el.classList.remove(cls);\n  } else {\n    el.className = el.className.split(/\\s+/).reduce(function (a, word) {\n      if (word != cls) {\n        a.push(word);\n      }\n\n      return a;\n    }, []).join(\" \");\n  }\n}\n\nfunction setCSS(el, styles) {\n  Object.keys(styles).forEach(function (key) {\n    el.style[key] = styles[key];\n  });\n}\n\nvar matches = typeof Element !== \"undefined\" && Element.prototype && function (p) {\n  if (p.matches) {\n    return function (el, selector) {\n      return el.matches(selector);\n    };\n  }\n\n  if (p.webkitMatchesSelector) {\n    return function (el, selector) {\n      return el.webkitMatchesSelector(selector);\n    };\n  }\n\n  if (p.mozMatchesSelector) {\n    return function (el, selector) {\n      return el.mozMatchesSelector(selector);\n    };\n  }\n\n  if (p.msMatchesSelector) {\n    return function (el, selector) {\n      return el.msMatchesSelector(selector);\n    };\n  }\n\n  return function (s) {\n    return [].indexOf.call(document.querySelectorAll(s), this) !== -1;\n  };\n}(Element.prototype);\n\nfunction closest(el, selector) {\n  if (el.closest) {\n    return el.closest(selector);\n  } // IE: stringifying rather than simply comparing with `document`,\n  // which is not iframe-proof and fails in editor export â€”\n  // https://github.com/telerik/kendo/issues/6721\n\n\n  while (el && !/^\\[object (?:HTML)?Document\\]$/.test(String(el))) {\n    if (el.nodeType == 1\n    /* Element */\n    && matches(el, selector)) {\n      return el;\n    }\n\n    el = el.parentNode;\n  }\n} // clone nodes ourselves, so that we redraw <canvas> (DOM or\n// jQuery clone will not)\n\n\nvar cloneNodes = function ($) {\n  if ($) {\n    // if we have Kendo and jQuery, use this version as it will\n    // maintain proper links between cloned element and Kendo\n    // widgets (i.e. it clones jQuery data(), which isn't the same\n    // as element's data attributes).\n    // https://github.com/telerik/kendo-ui-core/issues/2750\n    return function cloneNodes(el) {\n      var clone = el.cloneNode(false);\n\n      if (el.nodeType == 1\n      /* Element */\n      ) {\n        var $el = $(el),\n            $clone = $(clone),\n            i;\n        var data = $el.data();\n\n        for (i in data) {\n          $clone.data(i, data[i]);\n        }\n\n        if (/^canvas$/i.test(el.tagName)) {\n          clone.getContext(\"2d\").drawImage(el, 0, 0);\n        } else if (/^(?:input|select|textarea|option)$/i.test(el.tagName)) {\n          // drop the name attributes so that we don't affect the selection of the\n          // original nodes (i.e. checked status of radio buttons) when we insert our copy\n          // into the DOM.  https://github.com/telerik/kendo/issues/5409\n          clone.removeAttribute(\"id\");\n          clone.removeAttribute(\"name\");\n\n          if (!/^textarea$/i.test(el.tagName)) {\n            clone.value = el.value;\n          }\n\n          clone.checked = el.checked;\n          clone.selected = el.selected;\n        }\n\n        for (i = el.firstChild; i; i = i.nextSibling) {\n          clone.appendChild(cloneNodes(i));\n        }\n      }\n\n      return clone;\n    };\n  } else {\n    // the no-jQuery version\n    return function cloneNodes(el) {\n      var clone = function dive(node) {\n        var clone = node.cloneNode(false);\n\n        if (node._kendoExportVisual) {\n          clone._kendoExportVisual = node._kendoExportVisual;\n        }\n\n        for (var i = node.firstChild; i; i = i.nextSibling) {\n          clone.appendChild(dive(i));\n        }\n\n        return clone;\n      }(el); // re-draw canvases - https://github.com/telerik/kendo/issues/4872\n\n\n      var canvases = el.querySelectorAll(\"canvas\");\n\n      if (canvases.length) {\n        slice(clone.querySelectorAll(\"canvas\")).forEach(function (canvas, i) {\n          canvas.getContext(\"2d\").drawImage(canvases[i], 0, 0);\n        });\n      } // remove \"name\" attributes from <input> elements -\n      // https://github.com/telerik/kendo/issues/5409\n\n\n      var orig = el.querySelectorAll(\"input, select, textarea, option\");\n      slice(clone.querySelectorAll(\"input, select, textarea, option\")).forEach(function (el, i) {\n        el.removeAttribute(\"id\");\n        el.removeAttribute(\"name\");\n\n        if (!/^textarea$/i.test(el.tagName)) {\n          el.value = orig[i].value;\n        }\n\n        el.checked = orig[i].checked;\n        el.selected = orig[i].selected;\n      });\n      return clone;\n    };\n  }\n}(typeof window !== \"undefined\" && window.kendo && window.kendo.jQuery);\n\nfunction getXY(thing) {\n  if (typeof thing == \"number\") {\n    return {\n      x: thing,\n      y: thing\n    };\n  }\n\n  if (Array.isArray(thing)) {\n    return {\n      x: thing[0],\n      y: thing[1]\n    };\n  }\n\n  return {\n    x: thing.x,\n    y: thing.y\n  };\n}\n\nfunction drawDOM(element, options) {\n  if (!options) {\n    options = {};\n  }\n\n  var promise = createPromise();\n\n  if (!element) {\n    return promise.reject(\"No element to export\");\n  }\n\n  if (typeof window.getComputedStyle != \"function\") {\n    throw new Error(\"window.getComputedStyle is missing.  You are using an unsupported browser, or running in IE8 compatibility mode.  Drawing HTML is supported in Chrome, Firefox, Safari and IE9+.\");\n  }\n\n  PDF.defineFont(getFontFaces(element.ownerDocument));\n  var scale = getXY(options.scale || 1);\n\n  function doOne(element) {\n    var group = new Group(); // translate to start of page\n\n    var pos = element.getBoundingClientRect();\n    setTransform(group, [scale.x, 0, 0, scale.y, -pos.left * scale.x, -pos.top * scale.y]);\n    nodeInfo._clipbox = false;\n    nodeInfo._matrix = geo.Matrix.unit();\n    nodeInfo._stackingContext = {\n      element: element,\n      group: group\n    };\n\n    if (options.avoidLinks === true) {\n      nodeInfo._avoidLinks = \"a\";\n    } else {\n      nodeInfo._avoidLinks = options.avoidLinks;\n    }\n\n    addClass(element, \"k-pdf-export\");\n    renderElement(element, group);\n    removeClass(element, \"k-pdf-export\");\n    return group;\n  }\n\n  cacheImages([element], function () {\n    var forceBreak = options && options.forcePageBreak;\n    var hasPaperSize = options && options.paperSize && options.paperSize != \"auto\";\n    var paperOptions = PDF.getPaperOptions(function (key, def) {\n      if (key == \"paperSize\") {\n        // PDF.getPaperOptions croaks on \"auto\", just pass dummy A4 as we might\n        // still be interested in margins.\n        return hasPaperSize ? options[key] : \"A4\";\n      }\n\n      return key in options ? options[key] : def;\n    });\n    var pageWidth = hasPaperSize && paperOptions.paperSize[0];\n    var pageHeight = hasPaperSize && paperOptions.paperSize[1];\n    var margin = options.margin && paperOptions.margin;\n    var hasMargin = Boolean(margin);\n\n    if (forceBreak || pageHeight) {\n      if (!margin) {\n        margin = {\n          left: 0,\n          top: 0,\n          right: 0,\n          bottom: 0\n        };\n      } // we want paper size and margin to be unaffected by\n      // scaling in the output, so we have to reverse-scale\n      // before our calculations begin.\n\n\n      if (pageWidth) {\n        pageWidth /= scale.x;\n      }\n\n      if (pageHeight) {\n        pageHeight /= scale.y;\n      }\n\n      margin.left /= scale.x;\n      margin.right /= scale.x;\n      margin.top /= scale.y;\n      margin.bottom /= scale.y;\n      var group = new Group({\n        pdf: {\n          multiPage: true,\n          paperSize: hasPaperSize ? paperOptions.paperSize : \"auto\",\n          _ignoreMargin: hasMargin // HACK!  see exportPDF in pdf/drawing.js\n\n        }\n      });\n      handlePageBreaks(function (x) {\n        if (options.progress) {\n          var canceled = false,\n              pageNum = 0;\n\n          (function next() {\n            if (pageNum < x.pages.length) {\n              var page = doOne(x.pages[pageNum]);\n              group.append(page);\n              options.progress({\n                page: page,\n                pageNum: ++pageNum,\n                totalPages: x.pages.length,\n                cancel: function () {\n                  canceled = true;\n                }\n              });\n\n              if (!canceled) {\n                setTimeout(next);\n              } else {\n                // XXX: should we also fail() the deferred object?\n                x.container.parentNode.removeChild(x.container);\n              }\n            } else {\n              x.container.parentNode.removeChild(x.container);\n              promise.resolve(group);\n            }\n          })();\n        } else {\n          x.pages.forEach(function (page) {\n            group.append(doOne(page));\n          });\n          x.container.parentNode.removeChild(x.container);\n          promise.resolve(group);\n        }\n      }, element, forceBreak, pageWidth ? pageWidth - margin.left - margin.right : null, pageHeight ? pageHeight - margin.top - margin.bottom : null, margin, options);\n    } else {\n      promise.resolve(doOne(element));\n    }\n  });\n\n  function makeTemplate(template) {\n    if (template != null) {\n      if (typeof template == \"string\") {\n        template = compileTemplate(template.replace(/^\\s+|\\s+$/g, \"\"));\n      }\n\n      if (typeof template == \"function\") {\n        return function (data) {\n          var el = template(data);\n\n          if (el && typeof el == \"string\") {\n            var div = document.createElement(\"div\");\n            div.innerHTML = el;\n            el = div.firstElementChild;\n          }\n\n          return el;\n        };\n      } // assumed DOM element\n\n\n      return function () {\n        return template.cloneNode(true);\n      };\n    }\n  }\n\n  function handlePageBreaks(callback, element, forceBreak, pageWidth, pageHeight, margin, options) {\n    var template = makeTemplate(options.template);\n    var doc = element.ownerDocument;\n    var pages = [];\n    var copy = options._destructive ? element : cloneNodes(element);\n    var container = doc.createElement(\"KENDO-PDF-DOCUMENT\");\n    var adjust = 0; // make sure <tfoot> elements are at the end (Grid widget\n    // places TFOOT before TBODY, tricking our algorithm to\n    // insert a page break right after the header).\n    // https://github.com/telerik/kendo/issues/4699\n\n    slice(copy.querySelectorAll(\"tfoot\")).forEach(function (tfoot) {\n      tfoot.parentNode.appendChild(tfoot);\n    }); // remember the index of each LI from an ordered list.\n    // we'll use it to reconstruct the proper numbering.\n\n    slice(copy.querySelectorAll(\"ol\")).forEach(function (ol) {\n      slice(ol.children).forEach(function (li, index) {\n        li.setAttribute(\"kendo-split-index\", index);\n      });\n    });\n    setCSS(container, {\n      display: \"block\",\n      position: \"absolute\",\n      boxSizing: \"content-box\",\n      left: \"-10000px\",\n      top: \"-10000px\"\n    });\n\n    if (pageWidth) {\n      // subtle: if we don't set the width *and* margins here, the layout in this\n      // container will be different from the one in our final page elements, and we'll\n      // split at the wrong places.\n      setCSS(container, {\n        width: pageWidth + \"px\",\n        paddingLeft: margin.left + \"px\",\n        paddingRight: margin.right + \"px\"\n      }); // when the first element has a margin-top (i.e. a <h1>) the page will be\n      // inadvertently enlarged by that number (the browser will report the container's\n      // bounding box top to start at the element's top, rather than including its\n      // margin).  Adding overflow: hidden seems to fix it.\n      //\n      // to understand the difference, try the following snippets in your browser:\n      //\n      // 1. <div style=\"background: yellow\">\n      //      <h1 style=\"margin: 3em\">Foo</h1>\n      //    </div>\n      //\n      // 2. <div style=\"background: yellow; overflow: hidden\">\n      //      <h1 style=\"margin: 3em\">Foo</h1>\n      //    </div>\n      //\n      // this detail is not important when automatic page breaking is not requested, hence\n      // doing it only if pageWidth is defined.\n\n      setCSS(copy, {\n        overflow: \"hidden\"\n      });\n    }\n\n    element.parentNode.insertBefore(container, element);\n    container.appendChild(copy); // With cache disabled, images will still have height zero until their `complete` attribute\n    // is true.  `whenImagesAreActuallyLoaded` will wait for it.\n\n    if (options.beforePageBreak) {\n      whenImagesAreActuallyLoaded([container], function () {\n        options.beforePageBreak(container, doPageBreak);\n      });\n    } else {\n      whenImagesAreActuallyLoaded([container], doPageBreak);\n    }\n\n    function doPageBreak() {\n      if (forceBreak != \"-\" || pageHeight) {\n        splitElement(copy);\n      }\n\n      {\n        var page = makePage();\n        copy.parentNode.insertBefore(page, copy);\n        page.appendChild(copy);\n      }\n\n      if (template) {\n        pages.forEach(function (page, i) {\n          var el = template({\n            element: page,\n            pageNum: i + 1,\n            totalPages: pages.length\n          });\n\n          if (el) {\n            page.appendChild(el);\n          }\n        });\n      }\n\n      cacheImages(pages, callback.bind(null, {\n        pages: pages,\n        container: container\n      }));\n    }\n\n    function keepTogether(el) {\n      if (options.keepTogether && matches(el, options.keepTogether) && el.offsetHeight <= pageHeight - adjust) {\n        return true;\n      }\n\n      var tag = el.tagName;\n\n      if (/^h[1-6]$/i.test(tag) && el.offsetHeight >= pageHeight - adjust) {\n        return false;\n      }\n\n      return el.getAttribute(\"data-kendo-chart\") || /^(?:img|tr|thead|th|tfoot|iframe|svg|object|canvas|input|textarea|select|video|h[1-6])/i.test(el.tagName);\n    }\n\n    function splitElement(element) {\n      if (element.tagName == \"TABLE\") {\n        setCSS(element, {\n          tableLayout: \"fixed\"\n        });\n      }\n\n      if (keepTogether(element)) {\n        return;\n      }\n\n      var style = getComputedStyle(element);\n      var bottomPadding = parseFloat(getPropertyValue(style, \"padding-bottom\"));\n      var bottomBorder = parseFloat(getPropertyValue(style, \"border-bottom-width\"));\n      var saveAdjust = adjust;\n      adjust += bottomPadding + bottomBorder;\n      var isFirst = true;\n\n      for (var el = element.firstChild; el; el = el.nextSibling) {\n        if (el.nodeType == 1\n        /* Element */\n        ) {\n          isFirst = false;\n\n          if (matches(el, forceBreak)) {\n            breakAtElement(el);\n            continue;\n          }\n\n          if (!pageHeight) {\n            // we're in \"manual breaks mode\"\n            splitElement(el);\n            continue;\n          }\n\n          if (!/^(?:static|relative)$/.test(getPropertyValue(getComputedStyle(el), \"position\"))) {\n            continue;\n          }\n\n          var fall = fallsOnMargin(el);\n\n          if (fall == 1) {\n            // element starts on next page, break before anyway.\n            breakAtElement(el);\n          } else if (fall) {\n            // elements ends up on next page, or possibly doesn't fit on a page at\n            // all.  break before it anyway if it's an <img> or <tr>, otherwise\n            // attempt to split.\n            if (keepTogether(el)) {\n              breakAtElement(el);\n            } else {\n              splitElement(el);\n            }\n          } else {\n            splitElement(el);\n          }\n        } else if (el.nodeType == 3\n        /* Text */\n        && pageHeight) {\n          splitText(el, isFirst);\n          isFirst = false;\n        }\n      }\n\n      adjust = saveAdjust;\n    }\n\n    function firstInParent(el) {\n      var p = el.parentNode,\n          first = p.firstChild;\n\n      if (el === first) {\n        return true;\n      }\n\n      if (el === p.children[0]) {\n        if (first.nodeType == 7\n        /* comment */\n        || first.nodeType == 8\n        /* processing instruction */\n        ) {\n          return true;\n        }\n\n        if (first.nodeType == 3\n        /* text */\n        ) {\n          // if whitespace only we can probably consider it's first\n          return !/\\S/.test(first.data);\n        }\n      }\n\n      return false;\n    }\n\n    function breakAtElement(el) {\n      if (el.nodeType == 1 && el !== copy && firstInParent(el)) {\n        return breakAtElement(el.parentNode);\n      }\n\n      var table, colgroup, thead, grid, gridHead;\n      table = closest(el, \"table\");\n      colgroup = table && table.querySelector(\"colgroup\");\n\n      if (options.repeatHeaders) {\n        thead = table && table.querySelector(\"thead\"); // If we break page in a Kendo Grid, repeat its header.  This ugly hack is\n        // necessary because a scrollable grid will keep the header in a separate\n        // <table> element from its content.\n        //\n        // XXX: This is likely to break as soon as the widget HTML is modified.\n\n        grid = closest(el, \".k-grid.k-widget\");\n\n        if (grid && grid.querySelector(\".k-auto-scrollable\")) {\n          gridHead = grid.querySelector(\".k-grid-header\");\n        }\n      }\n\n      var page = makePage();\n      var range = doc.createRange();\n      range.setStartBefore(copy);\n      range.setEndBefore(el);\n      page.appendChild(range.extractContents());\n      copy.parentNode.insertBefore(page, copy);\n      preventBulletOnListItem(el.parentNode);\n\n      if (table) {\n        table = closest(el, \"table\"); // that's the <table> on next page!\n\n        if (options.repeatHeaders && thead) {\n          table.insertBefore(thead.cloneNode(true), table.firstChild);\n        }\n\n        if (colgroup) {\n          table.insertBefore(colgroup.cloneNode(true), table.firstChild);\n        }\n      }\n\n      if (options.repeatHeaders && gridHead) {\n        grid = closest(el, \".k-grid.k-widget\");\n        grid.insertBefore(gridHead.cloneNode(true), grid.firstChild);\n      }\n    }\n\n    function makePage() {\n      var page = doc.createElement(\"KENDO-PDF-PAGE\");\n      setCSS(page, {\n        display: \"block\",\n        boxSizing: \"content-box\",\n        width: pageWidth ? pageWidth + \"px\" : \"auto\",\n        padding: margin.top + \"px \" + margin.right + \"px \" + margin.bottom + \"px \" + margin.left + \"px\",\n        // allow absolutely positioned elements to be relative to current page\n        position: \"relative\",\n        // without the following we might affect layout of subsequent pages\n        height: pageHeight ? pageHeight + \"px\" : \"auto\",\n        overflow: pageHeight || pageWidth ? \"hidden\" : \"visible\",\n        clear: \"both\"\n      }); // debug\n      // $(\"<div>\").css({\n      //     position  : \"absolute\",\n      //     left      : margin.left,\n      //     top       : margin.top,\n      //     width     : pageWidth,\n      //     height    : pageHeight,\n      //     boxSizing : \"border-box\",\n      //     background: \"rgba(255, 255, 0, 0.5)\"\n      //     //border    : \"1px solid red\"\n      // }).appendTo(page);\n\n      if (options && options.pageClassName) {\n        page.className = options.pageClassName;\n      }\n\n      pages.push(page);\n      return page;\n    }\n\n    function fallsOnMargin(thing) {\n      var box = thing.getBoundingClientRect();\n\n      if (box.width === 0 || box.height === 0) {\n        // I'd say an element with dimensions zero fits on current page.\n        return 0;\n      }\n\n      var top = copy.getBoundingClientRect().top;\n      var available = pageHeight - adjust;\n      return box.height > available ? 3 : box.top - top > available ? 1 : box.bottom - top > available ? 2 : 0;\n    }\n\n    function splitText(node, isFirst) {\n      if (!/\\S/.test(node.data)) {\n        return;\n      }\n\n      var len = node.data.length;\n      var range = doc.createRange();\n      range.selectNodeContents(node);\n      var fall = fallsOnMargin(range);\n\n      if (!fall) {\n        return; // the whole text fits on current page\n      }\n\n      var nextnode = node;\n\n      if (fall == 1) {\n        // starts on next page, break before anyway.\n        if (isFirst) {\n          // avoid leaving an empty <p>, <li>, etc. on previous page.\n          breakAtElement(node.parentNode);\n        } else {\n          breakAtElement(node);\n        }\n      } else {\n        (function findEOP(min, pos, max) {\n          range.setEnd(node, pos);\n\n          if (min == pos || pos == max) {\n            return pos;\n          }\n\n          if (fallsOnMargin(range)) {\n            return findEOP(min, min + pos >> 1, pos);\n          } else {\n            return findEOP(pos, pos + max >> 1, max);\n          }\n        })(0, len >> 1, len);\n\n        if (!/\\S/.test(range.toString()) && isFirst) {\n          // avoid leaving an empty <p>, <li>, etc. on previous page.\n          breakAtElement(node.parentNode);\n        } else {\n          // This is only needed for IE, but it feels cleaner to do it anyway.  Without\n          // it, IE will truncate a very long text (playground/pdf-long-text-2.html).\n          nextnode = node.splitText(range.endOffset);\n          var page = makePage();\n          range.setStartBefore(copy);\n          page.appendChild(range.extractContents());\n          copy.parentNode.insertBefore(page, copy);\n          preventBulletOnListItem(nextnode.parentNode);\n        }\n      }\n\n      splitText(nextnode);\n    }\n\n    function preventBulletOnListItem(el) {\n      // set a hint on continued LI elements, to tell the\n      // renderer not to draw the bullet again.\n      // https://github.com/telerik/kendo-ui-core/issues/2732\n      var li = closest(el, \"li\");\n\n      if (li) {\n        li.setAttribute(\"kendo-no-bullet\", \"1\");\n        preventBulletOnListItem(li.parentNode);\n      }\n    }\n  }\n\n  return promise;\n} // This is needed for the Spreadsheet print functionality.  Since\n// there we only need to draw text, this cuts through the ceremony\n// of drawDOM/renderElement and renders the text node directly.\n\n\nfunction drawText(element) {\n  var group = new Group();\n  nodeInfo._clipbox = false;\n  nodeInfo._matrix = geo.Matrix.unit();\n  nodeInfo._stackingContext = {\n    element: element,\n    group: group\n  };\n  pushNodeInfo(element, getComputedStyle(element), group);\n\n  if (element.firstChild.nodeType == 3\n  /* Text */\n  ) {\n    // avoid the penalty of renderElement\n    renderText(element, element.firstChild, group);\n  } else {\n    _renderElement(element, group);\n  }\n\n  popNodeInfo();\n  return group;\n}\n\nvar parseBackgroundImage = function () {\n  var tok_linear_gradient = /^((-webkit-|-moz-|-o-|-ms-)?linear-gradient\\s*)\\(/; //var tok_radial_gradient  = /^((-webkit-|-moz-|-o-|-ms-)?radial-gradient\\s*)\\(/;\n\n  var tok_percent = /^([-0-9.]+%)/;\n  var tok_length = /^([-0-9.]+px)/;\n  var tok_keyword = /^(left|right|top|bottom|to|center)\\W/;\n  var tok_angle = /^([-0-9.]+(deg|grad|rad|turn)|0)/;\n  var tok_whitespace = /^(\\s+)/;\n  var tok_popen = /^(\\()/;\n  var tok_pclose = /^(\\))/;\n  var tok_comma = /^(,)/;\n  var tok_url = /^(url)\\(/;\n  var tok_content = /^(.*?)\\)/;\n  var cache1 = {},\n      cache2 = {};\n\n  function parse(input) {\n    var orig = input;\n\n    if (hasOwnProperty(cache1, orig)) {\n      return cache1[orig];\n    }\n\n    function skip_ws() {\n      var m = tok_whitespace.exec(input);\n\n      if (m) {\n        input = input.substr(m[1].length);\n      }\n    }\n\n    function read(token) {\n      skip_ws();\n      var m = token.exec(input);\n\n      if (m) {\n        input = input.substr(m[1].length);\n        return m[1];\n      }\n    }\n\n    function read_stop() {\n      var color = utils_parseColor(input, true);\n      var length, percent;\n\n      if (color) {\n        var match = /^#[0-9a-f]+/i.exec(input) || /^rgba?\\(.*?\\)/i.exec(input) || /^..*?\\b/.exec(input); // maybe named color\n\n        input = input.substr(match[0].length);\n        color = color.toRGB();\n\n        if (!(length = read(tok_length))) {\n          percent = read(tok_percent);\n        }\n\n        return {\n          color: color,\n          length: length,\n          percent: percent\n        };\n      }\n    }\n\n    function read_linear_gradient(propName) {\n      var angle;\n      var to1, to2;\n      var stops = [];\n      var reverse = false;\n\n      if (read(tok_popen)) {\n        // 1. [ <angle> || to <side-or-corner>, ]?\n        angle = read(tok_angle);\n\n        if (angle == \"0\") {\n          angle = \"0deg\"; // Edge\n        }\n\n        if (angle) {\n          angle = parseAngle(angle);\n          read(tok_comma);\n        } else {\n          to1 = read(tok_keyword);\n\n          if (to1 == \"to\") {\n            to1 = read(tok_keyword);\n          } else if (to1 && /^-/.test(propName)) {\n            reverse = true;\n          }\n\n          to2 = read(tok_keyword);\n          read(tok_comma);\n        }\n\n        if (/-moz-/.test(propName) && angle == null && to1 == null) {\n          var x = read(tok_percent),\n              y = read(tok_percent);\n          reverse = true;\n\n          if (x == \"0%\") {\n            to1 = \"left\";\n          } else if (x == \"100%\") {\n            to1 = \"right\";\n          }\n\n          if (y == \"0%\") {\n            to2 = \"top\";\n          } else if (y == \"100%\") {\n            to2 = \"bottom\";\n          }\n\n          read(tok_comma);\n        } // 2. color stops\n\n\n        while (input && !read(tok_pclose)) {\n          var stop = read_stop();\n\n          if (!stop) {\n            break;\n          }\n\n          stops.push(stop);\n          read(tok_comma);\n        }\n\n        return {\n          type: \"linear\",\n          angle: angle,\n          to: to1 && to2 ? to1 + \" \" + to2 : to1 ? to1 : to2 ? to2 : null,\n          stops: stops,\n          reverse: reverse\n        };\n      }\n    }\n\n    function read_url() {\n      if (read(tok_popen)) {\n        var url = read(tok_content);\n        url = url.replace(/^['\"]+|[\"']+$/g, \"\");\n        read(tok_pclose);\n        return {\n          type: \"url\",\n          url: url\n        };\n      }\n    }\n\n    var tok;\n\n    if (tok = read(tok_linear_gradient)) {\n      tok = read_linear_gradient(tok);\n    } else if (tok = read(tok_url)) {\n      tok = read_url();\n    }\n\n    return cache1[orig] = tok || {\n      type: \"none\"\n    };\n  }\n\n  return function (input) {\n    if (hasOwnProperty(cache2, input)) {\n      return cache2[input];\n    }\n\n    return cache2[input] = splitProperty(input).map(parse);\n  };\n}();\n\nvar splitProperty = function () {\n  var cache = {};\n  return function (input, separator) {\n    if (!separator) {\n      separator = /^\\s*,\\s*/;\n    }\n\n    var cacheKey = input + separator;\n\n    if (hasOwnProperty(cache, cacheKey)) {\n      return cache[cacheKey];\n    }\n\n    var ret = [];\n    var last = 0,\n        pos = 0;\n    var in_paren = 0;\n    var in_string = false;\n    var m;\n\n    function looking_at(rx) {\n      return m = rx.exec(input.substr(pos));\n    }\n\n    function trim(str) {\n      return str.replace(/^\\s+|\\s+$/g, \"\");\n    }\n\n    while (pos < input.length) {\n      if (!in_string && looking_at(/^[\\(\\[\\{]/)) {\n        in_paren++;\n        pos++;\n      } else if (!in_string && looking_at(/^[\\)\\]\\}]/)) {\n        in_paren--;\n        pos++;\n      } else if (!in_string && looking_at(/^[\\\"\\']/)) {\n        in_string = m[0];\n        pos++;\n      } else if (in_string == \"'\" && looking_at(/^\\\\\\'/)) {\n        pos += 2;\n      } else if (in_string == '\"' && looking_at(/^\\\\\\\"/)) {\n        pos += 2;\n      } else if (in_string == \"'\" && looking_at(/^\\'/)) {\n        in_string = false;\n        pos++;\n      } else if (in_string == '\"' && looking_at(/^\\\"/)) {\n        in_string = false;\n        pos++;\n      } else if (looking_at(separator)) {\n        if (!in_string && !in_paren && pos > last) {\n          ret.push(trim(input.substring(last, pos)));\n          last = pos + m[0].length;\n        }\n\n        pos += m[0].length;\n      } else {\n        pos++;\n      }\n    }\n\n    if (last < pos) {\n      ret.push(trim(input.substring(last, pos)));\n    }\n\n    return cache[cacheKey] = ret;\n  };\n}();\n\nvar getFontURL = function (cache) {\n  return function (el) {\n    // XXX: for IE we get here the whole cssText of the rule,\n    // because the computedStyle.src is empty.  Next time we need\n    // to fix these regexps we better write a CSS parser. :-\\\n    var url = cache[el];\n\n    if (!url) {\n      var m;\n\n      if (m = /url\\((['\"]?)([^'\")]*?)\\1\\)\\s+format\\((['\"]?)truetype\\3\\)/.exec(el)) {\n        url = cache[el] = m[2];\n      } else if (m = /url\\((['\"]?)([^'\")]*?\\.ttf)\\1\\)/.exec(el)) {\n        url = cache[el] = m[2];\n      }\n    }\n\n    return url;\n  };\n}(Object.create(null));\n\nvar getFontHeight = function (cache) {\n  return function (font) {\n    var height = cache[font];\n\n    if (height == null) {\n      height = cache[font] = measureText(\"Mapq\", {\n        font: font\n      }).height;\n    }\n\n    return height;\n  };\n}(Object.create(null));\n\nfunction getFontFaces(doc) {\n  if (doc == null) {\n    doc = document;\n  }\n\n  var result = {};\n\n  for (var i = 0; i < doc.styleSheets.length; ++i) {\n    doStylesheet(doc.styleSheets[i]);\n  }\n\n  return result;\n\n  function doStylesheet(ss) {\n    if (ss) {\n      var rules = null;\n\n      try {\n        rules = ss.cssRules;\n      } catch (ex) {}\n\n      if (rules) {\n        addRules(ss, rules);\n      }\n    }\n  }\n\n  function findFonts(rule) {\n    var src = getPropertyValue(rule.style, \"src\");\n\n    if (src) {\n      return splitProperty(src).reduce(function (a, el) {\n        var font = getFontURL(el);\n\n        if (font) {\n          a.push(font);\n        }\n\n        return a;\n      }, []);\n    } else {\n      // Internet Explorer\n      // XXX: this is gross.  should work though for valid CSS.\n      var font = getFontURL(rule.cssText);\n      return font ? [font] : [];\n    }\n  }\n\n  function addRules(styleSheet, rules) {\n    for (var i = 0; i < rules.length; ++i) {\n      var r = rules[i];\n\n      switch (r.type) {\n        case 3:\n          // CSSImportRule\n          doStylesheet(r.styleSheet);\n          break;\n\n        case 5:\n          // CSSFontFaceRule\n          var style = r.style;\n          var family = splitProperty(getPropertyValue(style, \"font-family\"));\n          var bold = /^([56789]00|bold)$/i.test(getPropertyValue(style, \"font-weight\"));\n          var italic = \"italic\" == getPropertyValue(style, \"font-style\");\n          var src = findFonts(r);\n\n          if (src.length > 0) {\n            addRule(styleSheet, family, bold, italic, src[0]);\n          }\n\n      }\n    }\n  }\n\n  function addRule(styleSheet, names, bold, italic, url) {\n    // We get full resolved absolute URLs in Chrome, but sadly\n    // not in Firefox.\n    if (!/^data:/i.test(url)) {\n      if (!(/^[^\\/:]+:\\/\\//.test(url) || /^\\//.test(url))) {\n        url = String(styleSheet.href).replace(/[^\\/]*$/, \"\") + url;\n      }\n    }\n\n    names.forEach(function (name) {\n      name = name.replace(/^(['\"]?)(.*?)\\1$/, \"$2\"); // it's quoted\n\n      if (bold) {\n        name += \"|bold\";\n      }\n\n      if (italic) {\n        name += \"|italic\";\n      }\n\n      result[name] = url;\n    });\n  }\n}\n\nfunction hasOwnProperty(obj, key) {\n  return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nfunction getCounter(name) {\n  name = \"_counter_\" + name;\n  return nodeInfo[name];\n}\n\nfunction getAllCounters(name) {\n  var values = [],\n      p = nodeInfo;\n  name = \"_counter_\" + name;\n\n  while (p) {\n    if (hasOwnProperty(p, name)) {\n      values.push(p[name]);\n    }\n\n    p = Object.getPrototypeOf(p);\n  }\n\n  return values.reverse();\n}\n\nfunction incCounter(name, inc) {\n  var p = nodeInfo;\n  name = \"_counter_\" + name;\n\n  while (p && !hasOwnProperty(p, name)) {\n    p = Object.getPrototypeOf(p);\n  }\n\n  if (!p) {\n    p = nodeInfo._root;\n  }\n\n  p[name] = (p[name] || 0) + (inc == null ? 1 : inc);\n}\n\nfunction resetCounter(name, val) {\n  name = \"_counter_\" + name;\n  nodeInfo[name] = val == null ? 0 : val;\n}\n\nfunction doCounters(a, f, def) {\n  for (var i = 0; i < a.length;) {\n    var name = a[i++];\n    var val = parseFloat(a[i]);\n\n    if (isNaN(val)) {\n      f(name, def);\n    } else {\n      f(name, val);\n      ++i;\n    }\n  }\n}\n\nfunction updateCounters(style) {\n  var counterReset = getPropertyValue(style, \"counter-reset\");\n\n  if (counterReset) {\n    doCounters(splitProperty(counterReset, /^\\s+/), resetCounter, 0);\n  }\n\n  var counterIncrement = getPropertyValue(style, \"counter-increment\");\n\n  if (counterIncrement) {\n    doCounters(splitProperty(counterIncrement, /^\\s+/), incCounter, 1);\n  }\n}\n\nfunction parseColor(str, css) {\n  var color = utils_parseColor(str, true);\n\n  if (color) {\n    color = color.toRGB();\n\n    if (css) {\n      color = color.toCssRgba();\n    } else if (color.a === 0) {\n      color = null;\n    }\n  }\n\n  return color;\n}\n\nfunction whenImagesAreActuallyLoaded(elements, callback) {\n  var pending = 0;\n  elements.forEach(function (el) {\n    var images = el.querySelectorAll(\"img\");\n\n    for (var i = 0; i < images.length; ++i) {\n      var img = images[i];\n\n      if (!img.complete) {\n        pending++;\n        img.onload = img.onerror = next;\n      }\n    }\n  });\n\n  if (!pending) {\n    next();\n  }\n\n  function next() {\n    if (--pending <= 0) {\n      callback();\n    }\n  }\n}\n\nfunction cacheImages(elements, callback) {\n  var urls = [];\n\n  function add(url) {\n    if (!IMAGE_CACHE[url]) {\n      IMAGE_CACHE[url] = true;\n      urls.push(url);\n    }\n  }\n\n  elements.forEach(function dive(element) {\n    if (/^img$/i.test(element.tagName)) {\n      add(element.src);\n    }\n\n    parseBackgroundImage(getPropertyValue(getComputedStyle(element), \"background-image\")).forEach(function (bg) {\n      if (bg.type == \"url\") {\n        add(bg.url);\n      }\n    });\n\n    if (element.children) {\n      slice(element.children).forEach(dive);\n    }\n  });\n  var count = urls.length;\n\n  function next() {\n    if (--count <= 0) {\n      // Even though we cached them, they simply won't be available immediately in the newly\n      // created DOM.  Previously we'd allow a 10ms timeout, but that's arbitrary and clearly\n      // not working in all cases (https://github.com/telerik/kendo/issues/5399), so this\n      // function will wait for their .complete attribute.\n      whenImagesAreActuallyLoaded(elements, callback);\n    }\n  }\n\n  if (count === 0) {\n    next();\n  }\n\n  urls.forEach(function (url) {\n    var img = IMAGE_CACHE[url] = new window.Image();\n\n    if (!/^data:/i.test(url)) {\n      img.crossOrigin = \"Anonymous\";\n    }\n\n    img.src = url;\n\n    if (img.complete) {\n      next();\n    } else {\n      img.onload = next;\n\n      img.onerror = function () {\n        IMAGE_CACHE[url] = null;\n        next();\n      };\n    }\n  });\n}\n\nfunction alphaNumeral(n) {\n  var result = \"\";\n\n  do {\n    var r = n % 26;\n    result = String.fromCharCode(97 + r) + result;\n    n = Math.floor(n / 26);\n  } while (n > 0);\n\n  return result;\n}\n\nfunction pushNodeInfo(element, style, group) {\n  nodeInfo = Object.create(nodeInfo);\n  nodeInfo[element.tagName.toLowerCase()] = {\n    element: element,\n    style: style\n  };\n  var decoration = getPropertyValue(style, \"text-decoration\");\n\n  if (decoration && decoration != \"none\") {\n    var color = getPropertyValue(style, \"color\");\n    decoration.split(/\\s+/g).forEach(function (name) {\n      if (!nodeInfo[name]) {\n        nodeInfo[name] = color;\n      }\n    });\n  }\n\n  if (createsStackingContext(style)) {\n    nodeInfo._stackingContext = {\n      element: element,\n      group: group\n    };\n  }\n}\n\nfunction popNodeInfo() {\n  nodeInfo = Object.getPrototypeOf(nodeInfo);\n}\n\nfunction updateClipbox(path) {\n  if (nodeInfo._clipbox != null) {\n    var box = path.bbox(nodeInfo._matrix);\n\n    if (nodeInfo._clipbox) {\n      nodeInfo._clipbox = geo.Rect.intersect(nodeInfo._clipbox, box);\n    } else {\n      nodeInfo._clipbox = box;\n    }\n  }\n}\n\nfunction emptyClipbox() {\n  var cb = nodeInfo._clipbox;\n\n  if (cb == null) {\n    return true;\n  }\n\n  if (cb) {\n    return cb.width() === 0 || cb.height() === 0;\n  }\n}\n\nfunction createsStackingContext(style) {\n  function prop(name) {\n    return getPropertyValue(style, name);\n  }\n\n  if (prop(\"transform\") != \"none\" || prop(\"position\") != \"static\" || prop(\"z-index\") != \"auto\" || prop(\"opacity\") < 1) {\n    return true;\n  }\n}\n\nfunction getComputedStyle(element, pseudoElt) {\n  return window.getComputedStyle(element, pseudoElt || null);\n}\n\nfunction getPropertyValue(style, prop, defa) {\n  var val = style.getPropertyValue(prop);\n\n  if (val == null || val === \"\") {\n    if (browser.webkit) {\n      val = style.getPropertyValue(\"-webkit-\" + prop);\n    } else if (browser.mozilla) {\n      val = style.getPropertyValue(\"-moz-\" + prop);\n    } else if (browser.opera) {\n      val = style.getPropertyValue(\"-o-\" + prop);\n    } else if (microsoft) {\n      val = style.getPropertyValue(\"-ms-\" + prop);\n    }\n  }\n\n  if (arguments.length > 2 && (val == null || val === \"\")) {\n    return defa;\n  } else {\n    return val;\n  }\n}\n\nfunction pleaseSetPropertyValue(style, prop, value, important) {\n  style.setProperty(prop, value, important);\n\n  if (browser.webkit) {\n    style.setProperty(\"-webkit-\" + prop, value, important);\n  } else if (browser.mozilla) {\n    style.setProperty(\"-moz-\" + prop, value, important);\n  } else if (browser.opera) {\n    style.setProperty(\"-o-\" + prop, value, important);\n  } else if (microsoft) {\n    style.setProperty(\"-ms-\" + prop, value, important);\n    prop = \"ms\" + prop.replace(/(^|-)([a-z])/g, function (s, p1, p2) {\n      return p1 + p2.toUpperCase();\n    });\n    style[prop] = value;\n  }\n}\n\nfunction getBorder(style, side) {\n  side = \"border-\" + side;\n  return {\n    width: parseFloat(getPropertyValue(style, side + \"-width\")),\n    style: getPropertyValue(style, side + \"-style\"),\n    color: parseColor(getPropertyValue(style, side + \"-color\"), true)\n  };\n}\n\nfunction saveStyle(element, func) {\n  var prev = element.style.cssText;\n  var result = func();\n  element.style.cssText = prev;\n  return result;\n}\n\nfunction getBorderRadius(style, side) {\n  var r = getPropertyValue(style, \"border-\" + side + \"-radius\").split(/\\s+/g).map(parseFloat);\n\n  if (r.length == 1) {\n    r.push(r[0]);\n  }\n\n  return sanitizeRadius({\n    x: r[0],\n    y: r[1]\n  });\n}\n\nfunction getContentBox(element) {\n  var box = element.getBoundingClientRect();\n  box = innerBox(box, \"border-*-width\", element);\n  box = innerBox(box, \"padding-*\", element);\n  return box;\n}\n\nfunction innerBox(box, prop, element) {\n  var style, wt, wr, wb, wl;\n\n  if (typeof prop == \"string\") {\n    style = getComputedStyle(element);\n    wt = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"top\")));\n    wr = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"right\")));\n    wb = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"bottom\")));\n    wl = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"left\")));\n  } else if (typeof prop == \"number\") {\n    wt = wr = wb = wl = prop;\n  }\n\n  return {\n    top: box.top + wt,\n    right: box.right - wr,\n    bottom: box.bottom - wb,\n    left: box.left + wl,\n    width: box.right - box.left - wr - wl,\n    height: box.bottom - box.top - wb - wt\n  };\n}\n\nfunction getTransform(style) {\n  var transform = getPropertyValue(style, \"transform\");\n\n  if (transform == \"none\") {\n    return null;\n  }\n\n  var matrix = /^\\s*matrix\\(\\s*(.*?)\\s*\\)\\s*$/.exec(transform);\n\n  if (matrix) {\n    var origin = getPropertyValue(style, \"transform-origin\");\n    matrix = matrix[1].split(/\\s*,\\s*/g).map(parseFloat);\n    origin = origin.split(/\\s+/g).map(parseFloat);\n    return {\n      matrix: matrix,\n      origin: origin\n    };\n  }\n}\n\nfunction radiansToDegrees(radians) {\n  return 180 * radians / Math.PI % 360;\n}\n\nfunction parseAngle(angle) {\n  var num = parseFloat(angle);\n\n  if (/grad$/.test(angle)) {\n    return Math.PI * num / 200;\n  } else if (/rad$/.test(angle)) {\n    return num;\n  } else if (/turn$/.test(angle)) {\n    return Math.PI * num * 2;\n  } else if (/deg$/.test(angle)) {\n    return Math.PI * num / 180;\n  }\n}\n\nfunction setTransform(shape, m) {\n  m = new geo.Matrix(m[0], m[1], m[2], m[3], m[4], m[5]);\n  shape.transform(m);\n  return m;\n}\n\nfunction setClipping(shape, clipPath) {\n  shape.clip(clipPath);\n}\n\nfunction addArcToPath(path, x, y, options) {\n  var points = new geo.Arc([x, y], options).curvePoints(),\n      i = 1;\n\n  while (i < points.length) {\n    path.curveTo(points[i++], points[i++], points[i++]);\n  }\n}\n\nfunction sanitizeRadius(r) {\n  if (r.x <= 0 || r.y <= 0) {\n    r.x = r.y = 0;\n  }\n\n  return r;\n}\n\nfunction adjustBorderRadiusForBox(box, rTL, rTR, rBR, rBL) {\n  // adjust border radiuses such that the sum of adjacent\n  // radiuses is not bigger than the length of the side.\n  // seems the correct algorithm is variant (3) from here:\n  // http://www.w3.org/Style/CSS/Tracker/issues/29?changelog\n  var tl_x = Math.max(0, rTL.x),\n      tl_y = Math.max(0, rTL.y);\n  var tr_x = Math.max(0, rTR.x),\n      tr_y = Math.max(0, rTR.y);\n  var br_x = Math.max(0, rBR.x),\n      br_y = Math.max(0, rBR.y);\n  var bl_x = Math.max(0, rBL.x),\n      bl_y = Math.max(0, rBL.y);\n  var f = Math.min(box.width / (tl_x + tr_x), box.height / (tr_y + br_y), box.width / (br_x + bl_x), box.height / (bl_y + tl_y));\n\n  if (f < 1) {\n    tl_x *= f;\n    tl_y *= f;\n    tr_x *= f;\n    tr_y *= f;\n    br_x *= f;\n    br_y *= f;\n    bl_x *= f;\n    bl_y *= f;\n  }\n\n  return {\n    tl: {\n      x: tl_x,\n      y: tl_y\n    },\n    tr: {\n      x: tr_x,\n      y: tr_y\n    },\n    br: {\n      x: br_x,\n      y: br_y\n    },\n    bl: {\n      x: bl_x,\n      y: bl_y\n    }\n  };\n}\n\nfunction elementRoundBox(element, box, type) {\n  var style = getComputedStyle(element);\n  var rTL = getBorderRadius(style, \"top-left\");\n  var rTR = getBorderRadius(style, \"top-right\");\n  var rBL = getBorderRadius(style, \"bottom-left\");\n  var rBR = getBorderRadius(style, \"bottom-right\");\n\n  if (type == \"padding\" || type == \"content\") {\n    var bt = getBorder(style, \"top\");\n    var br = getBorder(style, \"right\");\n    var bb = getBorder(style, \"bottom\");\n    var bl = getBorder(style, \"left\");\n    rTL.x -= bl.width;\n    rTL.y -= bt.width;\n    rTR.x -= br.width;\n    rTR.y -= bt.width;\n    rBR.x -= br.width;\n    rBR.y -= bb.width;\n    rBL.x -= bl.width;\n    rBL.y -= bb.width;\n\n    if (type == \"content\") {\n      var pt = parseFloat(getPropertyValue(style, \"padding-top\"));\n      var pr = parseFloat(getPropertyValue(style, \"padding-right\"));\n      var pb = parseFloat(getPropertyValue(style, \"padding-bottom\"));\n      var pl = parseFloat(getPropertyValue(style, \"padding-left\"));\n      rTL.x -= pl;\n      rTL.y -= pt;\n      rTR.x -= pr;\n      rTR.y -= pt;\n      rBR.x -= pr;\n      rBR.y -= pb;\n      rBL.x -= pl;\n      rBL.y -= pb;\n    }\n  }\n\n  if (typeof type == \"number\") {\n    rTL.x -= type;\n    rTL.y -= type;\n    rTR.x -= type;\n    rTR.y -= type;\n    rBR.x -= type;\n    rBR.y -= type;\n    rBL.x -= type;\n    rBL.y -= type;\n  }\n\n  return roundBox(box, rTL, rTR, rBR, rBL);\n} // Create a drawing.Path for a rounded rectangle.  Receives the\n// bounding box and the border-radiuses in CSS order (top-left,\n// top-right, bottom-right, bottom-left).  The radiuses must be\n// objects containing x (horiz. radius) and y (vertical radius).\n\n\nfunction roundBox(box, rTL0, rTR0, rBR0, rBL0) {\n  var tmp = adjustBorderRadiusForBox(box, rTL0, rTR0, rBR0, rBL0);\n  var rTL = tmp.tl;\n  var rTR = tmp.tr;\n  var rBR = tmp.br;\n  var rBL = tmp.bl;\n  var path = new Path({\n    fill: null,\n    stroke: null\n  });\n  path.moveTo(box.left, box.top + rTL.y);\n\n  if (rTL.x) {\n    addArcToPath(path, box.left + rTL.x, box.top + rTL.y, {\n      startAngle: -180,\n      endAngle: -90,\n      radiusX: rTL.x,\n      radiusY: rTL.y\n    });\n  }\n\n  path.lineTo(box.right - rTR.x, box.top);\n\n  if (rTR.x) {\n    addArcToPath(path, box.right - rTR.x, box.top + rTR.y, {\n      startAngle: -90,\n      endAngle: 0,\n      radiusX: rTR.x,\n      radiusY: rTR.y\n    });\n  }\n\n  path.lineTo(box.right, box.bottom - rBR.y);\n\n  if (rBR.x) {\n    addArcToPath(path, box.right - rBR.x, box.bottom - rBR.y, {\n      startAngle: 0,\n      endAngle: 90,\n      radiusX: rBR.x,\n      radiusY: rBR.y\n    });\n  }\n\n  path.lineTo(box.left + rBL.x, box.bottom);\n\n  if (rBL.x) {\n    addArcToPath(path, box.left + rBL.x, box.bottom - rBL.y, {\n      startAngle: 90,\n      endAngle: 180,\n      radiusX: rBL.x,\n      radiusY: rBL.y\n    });\n  }\n\n  return path.close();\n}\n\nfunction formatCounter(val, style) {\n  var str = String(parseFloat(val));\n\n  switch (style) {\n    case \"decimal-leading-zero\":\n      if (str.length < 2) {\n        str = \"0\" + str;\n      }\n\n      return str;\n\n    case \"lower-roman\":\n      return arabicToRoman(val).toLowerCase();\n\n    case \"upper-roman\":\n      return arabicToRoman(val).toUpperCase();\n\n    case \"lower-latin\":\n    case \"lower-alpha\":\n      return alphaNumeral(val - 1);\n\n    case \"upper-latin\":\n    case \"upper-alpha\":\n      return alphaNumeral(val - 1).toUpperCase();\n\n    default:\n      return str;\n  }\n}\n\nfunction evalPseudoElementContent(element, content) {\n  function displayCounter(name, style, separator) {\n    if (!separator) {\n      return formatCounter(getCounter(name) || 0, style);\n    }\n\n    separator = separator.replace(/^\\s*([\"'])(.*)\\1\\s*$/, \"$2\");\n    return getAllCounters(name).map(function (val) {\n      return formatCounter(val, style);\n    }).join(separator);\n  }\n\n  var a = splitProperty(content, /^\\s+/);\n  var result = [],\n      m;\n  a.forEach(function (el) {\n    var tmp;\n\n    if (m = /^\\s*([\"'])(.*)\\1\\s*$/.exec(el)) {\n      result.push(m[2].replace(/\\\\([0-9a-f]{4})/gi, function (s, p) {\n        return String.fromCharCode(parseInt(p, 16));\n      }));\n    } else if (m = /^\\s*counter\\((.*?)\\)\\s*$/.exec(el)) {\n      tmp = splitProperty(m[1]);\n      result.push(displayCounter(tmp[0], tmp[1]));\n    } else if (m = /^\\s*counters\\((.*?)\\)\\s*$/.exec(el)) {\n      tmp = splitProperty(m[1]);\n      result.push(displayCounter(tmp[0], tmp[2], tmp[1]));\n    } else if (m = /^\\s*attr\\((.*?)\\)\\s*$/.exec(el)) {\n      result.push(element.getAttribute(m[1]) || \"\");\n    } else {\n      result.push(el);\n    }\n  });\n  return result.join(\"\");\n}\n\nfunction getCssText(style) {\n  if (style.cssText) {\n    return style.cssText;\n  } // Status: NEW.  Report year: 2002.  Current year: 2014.\n  // Nice played, Mozillians.\n  // https://bugzilla.mozilla.org/show_bug.cgi?id=137687\n\n\n  var result = [];\n\n  for (var i = 0; i < style.length; ++i) {\n    result.push(style[i] + \": \" + getPropertyValue(style, style[i]));\n  }\n\n  return result.join(\";\\n\");\n}\n\nfunction _renderWithPseudoElements(element, group) {\n  if (element.tagName == KENDO_PSEUDO_ELEMENT) {\n    _renderElement(element, group);\n\n    return;\n  }\n\n  var fake = [];\n\n  function pseudo(kind, place) {\n    var style = getComputedStyle(element, kind),\n        content = style.content;\n    updateCounters(style);\n\n    if (content && content != \"normal\" && content != \"none\" && style.width != \"0px\") {\n      var psel = element.ownerDocument.createElement(KENDO_PSEUDO_ELEMENT);\n      psel.style.cssText = getCssText(style);\n      psel.textContent = evalPseudoElementContent(element, content);\n      element.insertBefore(psel, place);\n      fake.push(psel);\n    }\n  }\n\n  pseudo(\":before\", element.firstChild);\n  pseudo(\":after\", null);\n\n  if (fake.length > 0) {\n    var saveClass = element.className;\n    element.className += \" kendo-pdf-hide-pseudo-elements\";\n\n    _renderElement(element, group);\n\n    element.className = saveClass;\n    fake.forEach(function (el) {\n      element.removeChild(el);\n    });\n  } else {\n    _renderElement(element, group);\n  }\n}\n\nfunction _renderElement(element, group) {\n  var style = getComputedStyle(element);\n  var top = getBorder(style, \"top\");\n  var right = getBorder(style, \"right\");\n  var bottom = getBorder(style, \"bottom\");\n  var left = getBorder(style, \"left\");\n  var rTL0 = getBorderRadius(style, \"top-left\");\n  var rTR0 = getBorderRadius(style, \"top-right\");\n  var rBL0 = getBorderRadius(style, \"bottom-left\");\n  var rBR0 = getBorderRadius(style, \"bottom-right\");\n  var dir = getPropertyValue(style, \"direction\");\n  var backgroundColor = getPropertyValue(style, \"background-color\");\n  backgroundColor = parseColor(backgroundColor);\n  var backgroundImage = parseBackgroundImage(getPropertyValue(style, \"background-image\"));\n  var backgroundRepeat = splitProperty(getPropertyValue(style, \"background-repeat\"));\n  var backgroundPosition = splitProperty(getPropertyValue(style, \"background-position\"));\n  var backgroundOrigin = splitProperty(getPropertyValue(style, \"background-origin\"));\n  var backgroundSize = splitProperty(getPropertyValue(style, \"background-size\")); // IE shrinks the text with text-overflow: ellipsis,\n  // apparently because the returned bounding box for the range\n  // is limited to the visible area minus space for the dots,\n  // instead of being the full width of the text.\n  //\n  // https://github.com/telerik/kendo/issues/5232\n  // https://github.com/telerik/kendo-ui-core/issues/1868\n  //\n  // We have to test it here rather than in renderText because\n  // text-overflow: ellipsis could be set on a parent element (not\n  // necessarily the one containing the text); in this case,\n  // getComputedStyle(elementWithTheText) will return \"clip\", not\n  // \"ellipsis\" (which is probably a bug, but oh well...)\n\n  var textOverflow, saveTextOverflow;\n\n  if (microsoft) {\n    textOverflow = style.textOverflow; // computed style\n\n    if (textOverflow == \"ellipsis\") {\n      saveTextOverflow = element.style.textOverflow; // own style.\n\n      element.style.textOverflow = \"clip\";\n    }\n  }\n\n  if (browser.msie && browser.version < 10) {\n    // IE9 hacks.  getPropertyValue won't return the correct\n    // value.  Sucks that we have to do it here, I'd prefer to\n    // move it in getPropertyValue, but we don't have the\n    // element.\n    backgroundPosition = splitProperty(element.currentStyle.backgroundPosition);\n  }\n\n  var innerbox = innerBox(element.getBoundingClientRect(), \"border-*-width\", element); // CSS \"clip\" property - if present, replace the group with a\n  // new one which is clipped.  This must happen before drawing\n  // the borders and background.\n\n  (function () {\n    var clip = getPropertyValue(style, \"clip\");\n    var m = /^\\s*rect\\((.*)\\)\\s*$/.exec(clip);\n\n    if (m) {\n      var a = m[1].split(/[ ,]+/g);\n      var top = a[0] == \"auto\" ? innerbox.top : parseFloat(a[0]) + innerbox.top;\n      var right = a[1] == \"auto\" ? innerbox.right : parseFloat(a[1]) + innerbox.left;\n      var bottom = a[2] == \"auto\" ? innerbox.bottom : parseFloat(a[2]) + innerbox.top;\n      var left = a[3] == \"auto\" ? innerbox.left : parseFloat(a[3]) + innerbox.left;\n      var tmp = new Group();\n      var clipPath = new Path().moveTo(left, top).lineTo(right, top).lineTo(right, bottom).lineTo(left, bottom).close();\n      setClipping(tmp, clipPath);\n      group.append(tmp);\n      group = tmp;\n      updateClipbox(clipPath);\n    }\n  })();\n\n  var boxes, i, cells;\n  var display = getPropertyValue(style, \"display\");\n\n  if (display == \"table-row\") {\n    // because of rowspan/colspan, we shouldn't draw background of table row elements on the\n    // box given by its getBoundingClientRect, because if we do we risk overwritting a\n    // previously rendered cell.  https://github.com/telerik/kendo/issues/4881\n    boxes = [];\n\n    for (i = 0, cells = element.children; i < cells.length; ++i) {\n      boxes.push(cells[i].getBoundingClientRect());\n    }\n  } else {\n    boxes = element.getClientRects();\n\n    if (boxes.length == 1) {\n      // Workaround the missing borders in Chrome!  getClientRects() boxes contains values\n      // rounded to integer.  getBoundingClientRect() appears to work fine.  We still need\n      // getClientRects() to support cases where there are more boxes (continued inline\n      // elements that might have border/background).\n      boxes = [element.getBoundingClientRect()];\n    }\n  } // This function workarounds another Chrome bug, where boxes returned for a table with\n  // border-collapse: collapse will overlap the table border.  Our rendering is not perfect in\n  // such case anyway, but with this is better than without it.\n\n\n  boxes = adjustBoxes(boxes);\n\n  for (i = 0; i < boxes.length; ++i) {\n    drawOneBox(boxes[i], i === 0, i == boxes.length - 1);\n  } // Render links as separate groups.  We can't use boxes returned by element's getClientRects\n  // because if display type is \"inline\" (default for <a>), boxes will not include the height of\n  // images inside.  https://github.com/telerik/kendo-ui-core/issues/3359\n\n\n  if (element.tagName == \"A\" && element.href && !/^#?$/.test(element.getAttribute(\"href\"))) {\n    if (!nodeInfo._avoidLinks || !matches(element, nodeInfo._avoidLinks)) {\n      var r = document.createRange();\n      r.selectNodeContents(element);\n      slice(r.getClientRects()).forEach(function (box) {\n        var g = new Group();\n        g._pdfLink = {\n          url: element.href,\n          top: box.top,\n          right: box.right,\n          bottom: box.bottom,\n          left: box.left\n        };\n        group.append(g);\n      });\n    }\n  }\n\n  if (boxes.length > 0 && display == \"list-item\" && !element.getAttribute(\"kendo-no-bullet\")) {\n    drawBullet(boxes[0]);\n  } // overflow: hidden/auto - if present, replace the group with\n  // a new one clipped by the inner box.\n\n\n  (function () {\n    function clipit() {\n      var clipPath = elementRoundBox(element, innerbox, \"padding\");\n      var tmp = new Group();\n      setClipping(tmp, clipPath);\n      group.append(tmp);\n      group = tmp;\n      updateClipbox(clipPath);\n    }\n\n    if (isFormField(element)) {\n      clipit();\n    } else if (/^(hidden|auto|scroll)/.test(getPropertyValue(style, \"overflow\"))) {\n      clipit();\n    } else if (/^(hidden|auto|scroll)/.test(getPropertyValue(style, \"overflow-x\"))) {\n      clipit();\n    } else if (/^(hidden|auto|scroll)/.test(getPropertyValue(style, \"overflow-y\"))) {\n      clipit();\n    }\n  })();\n\n  if (!maybeRenderWidget(element, group)) {\n    renderContents(element, group);\n  }\n\n  if (microsoft && textOverflow == \"ellipsis\") {\n    element.style.textOverflow = saveTextOverflow;\n  }\n\n  return group; // only utility functions after this line.\n\n  function adjustBoxes(boxes) {\n    if (/^td$/i.test(element.tagName)) {\n      var table = nodeInfo.table;\n\n      if (table && getPropertyValue(table.style, \"border-collapse\") == \"collapse\") {\n        var tableBorderLeft = getBorder(table.style, \"left\").width;\n        var tableBorderTop = getBorder(table.style, \"top\").width; // check if we need to adjust\n\n        if (tableBorderLeft === 0 && tableBorderTop === 0) {\n          return boxes; // nope\n        }\n\n        var tableBox = table.element.getBoundingClientRect();\n        var firstCell = table.element.rows[0].cells[0];\n        var firstCellBox = firstCell.getBoundingClientRect();\n\n        if (firstCellBox.top == tableBox.top || firstCellBox.left == tableBox.left) {\n          return slice(boxes).map(function (box) {\n            return {\n              left: box.left + tableBorderLeft,\n              top: box.top + tableBorderTop,\n              right: box.right + tableBorderLeft,\n              bottom: box.bottom + tableBorderTop,\n              height: box.height,\n              width: box.width\n            };\n          });\n        }\n      }\n    }\n\n    return boxes;\n  } // this function will be called to draw each border.  it\n  // draws starting at origin and the resulted path must be\n  // translated/rotated to be placed in the proper position.\n  //\n  // arguments are named as if it draws the top border:\n  //\n  //    - `len` the length of the edge\n  //    - `Wtop` the width of the edge (i.e. border-top-width)\n  //    - `Wleft` the width of the left edge (border-left-width)\n  //    - `Wright` the width of the right edge\n  //    - `rl` and `rl` -- the border radius on the left and right\n  //      (objects containing x and y, for horiz/vertical radius)\n  //    - `transform` -- transformation to apply\n  //\n\n\n  function drawEdge(color, len, Wtop, Wleft, Wright, rl, rr, transform) {\n    if (Wtop <= 0) {\n      return;\n    }\n\n    var path,\n        edge = new Group();\n    setTransform(edge, transform);\n    group.append(edge);\n    sanitizeRadius(rl);\n    sanitizeRadius(rr); // draw main border.  this is the area without the rounded corners\n\n    path = new Path({\n      fill: {\n        color: color\n      },\n      stroke: null\n    });\n    edge.append(path);\n    path.moveTo(rl.x ? Math.max(rl.x, Wleft) : 0, 0).lineTo(len - (rr.x ? Math.max(rr.x, Wright) : 0), 0).lineTo(len - Math.max(rr.x, Wright), Wtop).lineTo(Math.max(rl.x, Wleft), Wtop).close();\n\n    if (rl.x) {\n      drawRoundCorner(Wleft, rl, [-1, 0, 0, 1, rl.x, 0]);\n    }\n\n    if (rr.x) {\n      drawRoundCorner(Wright, rr, [1, 0, 0, 1, len - rr.x, 0]);\n    } // draws one round corner, starting at origin (needs to be\n    // translated/rotated to be placed properly).\n\n\n    function drawRoundCorner(Wright, r, transform) {\n      var angle = Math.PI / 2 * Wright / (Wright + Wtop); // not sanitizing this one, because negative values\n      // are useful to fill the box correctly.\n\n      var ri = {\n        x: r.x - Wright,\n        y: r.y - Wtop\n      };\n      var path = new Path({\n        fill: {\n          color: color\n        },\n        stroke: null\n      }).moveTo(0, 0);\n      setTransform(path, transform);\n      addArcToPath(path, 0, r.y, {\n        startAngle: -90,\n        endAngle: -radiansToDegrees(angle),\n        radiusX: r.x,\n        radiusY: r.y\n      });\n\n      if (ri.x > 0 && ri.y > 0) {\n        path.lineTo(ri.x * Math.cos(angle), r.y - ri.y * Math.sin(angle));\n        addArcToPath(path, 0, r.y, {\n          startAngle: -radiansToDegrees(angle),\n          endAngle: -90,\n          radiusX: ri.x,\n          radiusY: ri.y,\n          anticlockwise: true\n        });\n      } else if (ri.x > 0) {\n        path.lineTo(ri.x, Wtop).lineTo(0, Wtop);\n      } else {\n        path.lineTo(ri.x, Wtop).lineTo(ri.x, 0);\n      }\n\n      edge.append(path.close());\n    }\n  }\n\n  function drawBackground(box) {\n    var background = new Group();\n    setClipping(background, roundBox(box, rTL0, rTR0, rBR0, rBL0));\n    group.append(background);\n\n    if (backgroundColor) {\n      var path = new Path({\n        fill: {\n          color: backgroundColor.toCssRgba()\n        },\n        stroke: null\n      });\n      path.moveTo(box.left, box.top).lineTo(box.right, box.top).lineTo(box.right, box.bottom).lineTo(box.left, box.bottom).close();\n      background.append(path);\n    }\n\n    for (var i = backgroundImage.length; --i >= 0;) {\n      drawOneBackground(background, box, backgroundImage[i], backgroundRepeat[i % backgroundRepeat.length], backgroundPosition[i % backgroundPosition.length], backgroundOrigin[i % backgroundOrigin.length], backgroundSize[i % backgroundSize.length]);\n    }\n  }\n\n  function drawOneBackground(group, box, background, backgroundRepeat, backgroundPosition, backgroundOrigin, backgroundSize) {\n    if (!background || background == \"none\") {\n      return;\n    }\n\n    if (background.type == \"url\") {\n      var img = IMAGE_CACHE[background.url];\n\n      if (img && img.width > 0 && img.height > 0) {\n        drawBackgroundImage(group, box, img.width, img.height, function (group, rect) {\n          group.append(new Image(background.url, rect));\n        });\n      }\n    } else if (background.type == \"linear\") {\n      drawBackgroundImage(group, box, box.width, box.height, gradientRenderer(background));\n    } else {\n      return;\n    }\n\n    function drawBackgroundImage(group, box, img_width, img_height, renderBG) {\n      var aspect_ratio = img_width / img_height,\n          f; // for background-origin: border-box the box is already appropriate\n\n      var orgBox = box;\n\n      if (backgroundOrigin == \"content-box\") {\n        orgBox = innerBox(orgBox, \"border-*-width\", element);\n        orgBox = innerBox(orgBox, \"padding-*\", element);\n      } else if (backgroundOrigin == \"padding-box\") {\n        orgBox = innerBox(orgBox, \"border-*-width\", element);\n      }\n\n      if (!/^\\s*auto(\\s+auto)?\\s*$/.test(backgroundSize)) {\n        if (backgroundSize == \"contain\") {\n          f = Math.min(orgBox.width / img_width, orgBox.height / img_height);\n          img_width *= f;\n          img_height *= f;\n        } else if (backgroundSize == \"cover\") {\n          f = Math.max(orgBox.width / img_width, orgBox.height / img_height);\n          img_width *= f;\n          img_height *= f;\n        } else {\n          var size = backgroundSize.split(/\\s+/g); // compute width\n\n          if (/%$/.test(size[0])) {\n            img_width = orgBox.width * parseFloat(size[0]) / 100;\n          } else {\n            img_width = parseFloat(size[0]);\n          } // compute height\n\n\n          if (size.length == 1 || size[1] == \"auto\") {\n            img_height = img_width / aspect_ratio;\n          } else if (/%$/.test(size[1])) {\n            img_height = orgBox.height * parseFloat(size[1]) / 100;\n          } else {\n            img_height = parseFloat(size[1]);\n          }\n        }\n      }\n\n      var pos = String(backgroundPosition); // IE sometimes reports single-word positions\n      // https://github.com/telerik/kendo-ui-core/issues/2786\n      //\n      // it seems to switch to percentages when the horizontal\n      // position is not \"center\", therefore we don't handle\n      // multi-word cases here.  All other browsers return\n      // percentages or pixels instead of keywords.  At least\n      // for now...\n\n      switch (pos) {\n        case \"bottom\":\n          pos = \"50% 100%\";\n          break;\n\n        case \"top\":\n          pos = \"50% 0\";\n          break;\n\n        case \"left\":\n          pos = \"0 50%\";\n          break;\n\n        case \"right\":\n          pos = \"100% 50%\";\n          break;\n\n        case \"center\":\n          pos = \"50% 50%\";\n          break;\n      }\n\n      pos = pos.split(/\\s+/);\n\n      if (pos.length == 1) {\n        pos[1] = \"50%\";\n      }\n\n      if (/%$/.test(pos[0])) {\n        pos[0] = parseFloat(pos[0]) / 100 * (orgBox.width - img_width);\n      } else {\n        pos[0] = parseFloat(pos[0]);\n      }\n\n      if (/%$/.test(pos[1])) {\n        pos[1] = parseFloat(pos[1]) / 100 * (orgBox.height - img_height);\n      } else {\n        pos[1] = parseFloat(pos[1]);\n      }\n\n      var rect = new geo.Rect([orgBox.left + pos[0], orgBox.top + pos[1]], [img_width, img_height]); // XXX: background-repeat could be implemented more\n      //      efficiently as a fill pattern (at least for PDF\n      //      output, probably SVG too).\n\n      function rewX() {\n        while (rect.origin.x > box.left) {\n          rect.origin.x -= img_width;\n        }\n      }\n\n      function rewY() {\n        while (rect.origin.y > box.top) {\n          rect.origin.y -= img_height;\n        }\n      }\n\n      function repeatX() {\n        while (rect.origin.x < box.right) {\n          renderBG(group, rect.clone());\n          rect.origin.x += img_width;\n        }\n      }\n\n      if (backgroundRepeat == \"no-repeat\") {\n        renderBG(group, rect);\n      } else if (backgroundRepeat == \"repeat-x\") {\n        rewX();\n        repeatX();\n      } else if (backgroundRepeat == \"repeat-y\") {\n        rewY();\n\n        while (rect.origin.y < box.bottom) {\n          renderBG(group, rect.clone());\n          rect.origin.y += img_height;\n        }\n      } else if (backgroundRepeat == \"repeat\") {\n        rewX();\n        rewY();\n        var origin = rect.origin.clone();\n\n        while (rect.origin.y < box.bottom) {\n          rect.origin.x = origin.x;\n          repeatX();\n          rect.origin.y += img_height;\n        }\n      }\n    }\n  }\n\n  function drawBullet() {\n    var listStyleType = getPropertyValue(style, \"list-style-type\");\n\n    if (listStyleType == \"none\") {\n      return;\n    }\n\n    var listStylePosition = getPropertyValue(style, \"list-style-position\");\n\n    function _drawBullet(f) {\n      saveStyle(element, function () {\n        element.style.position = \"relative\";\n        var bullet = element.ownerDocument.createElement(KENDO_PSEUDO_ELEMENT);\n        bullet.style.position = \"absolute\";\n        bullet.style.boxSizing = \"border-box\";\n\n        if (listStylePosition == \"outside\") {\n          bullet.style.width = \"6em\";\n          bullet.style.left = \"-6.8em\";\n          bullet.style.textAlign = \"right\";\n        } else {\n          bullet.style.left = \"0px\";\n        }\n\n        f(bullet);\n        element.insertBefore(bullet, element.firstChild);\n        renderElement(bullet, group);\n        element.removeChild(bullet);\n      });\n    }\n\n    function elementIndex(f) {\n      var a = element.parentNode.children;\n      var k = element.getAttribute(\"kendo-split-index\");\n\n      if (k != null) {\n        return f(k | 0, a.length);\n      }\n\n      for (var i = 0; i < a.length; ++i) {\n        if (a[i] === element) {\n          return f(i, a.length);\n        }\n      }\n    }\n\n    switch (listStyleType) {\n      case \"circle\":\n      case \"disc\":\n      case \"square\":\n        _drawBullet(function (bullet) {\n          // XXX: the science behind these values is called \"trial and error\".\n          bullet.style.fontSize = \"60%\";\n          bullet.style.lineHeight = \"200%\";\n          bullet.style.paddingRight = \"0.5em\";\n          bullet.style.fontFamily = \"DejaVu Serif\";\n          bullet.innerHTML = {\n            \"disc\": \"\\u25cf\",\n            \"circle\": \"\\u25ef\",\n            \"square\": \"\\u25a0\"\n          }[listStyleType];\n        });\n\n        break;\n\n      case \"decimal\":\n      case \"decimal-leading-zero\":\n        _drawBullet(function (bullet) {\n          elementIndex(function (idx) {\n            ++idx;\n\n            if (listStyleType == \"decimal-leading-zero\" && idx < 10) {\n              idx = \"0\" + idx;\n            }\n\n            bullet.innerHTML = idx + \".\";\n          });\n        });\n\n        break;\n\n      case \"lower-roman\":\n      case \"upper-roman\":\n        _drawBullet(function (bullet) {\n          elementIndex(function (idx) {\n            idx = arabicToRoman(idx + 1);\n\n            if (listStyleType == \"upper-roman\") {\n              idx = idx.toUpperCase();\n            }\n\n            bullet.innerHTML = idx + \".\";\n          });\n        });\n\n        break;\n\n      case \"lower-latin\":\n      case \"lower-alpha\":\n      case \"upper-latin\":\n      case \"upper-alpha\":\n        _drawBullet(function (bullet) {\n          elementIndex(function (idx) {\n            idx = alphaNumeral(idx);\n\n            if (/^upper/i.test(listStyleType)) {\n              idx = idx.toUpperCase();\n            }\n\n            bullet.innerHTML = idx + \".\";\n          });\n        });\n\n        break;\n    }\n  } // draws a single border box\n\n\n  function drawOneBox(box, isFirst, isLast) {\n    if (box.width === 0 || box.height === 0) {\n      return;\n    }\n\n    drawBackground(box);\n    var shouldDrawLeft = left.width > 0 && (isFirst && dir == \"ltr\" || isLast && dir == \"rtl\");\n    var shouldDrawRight = right.width > 0 && (isLast && dir == \"ltr\" || isFirst && dir == \"rtl\"); // The most general case is that the 4 borders have different widths and border\n    // radiuses.  The way that is handled is by drawing 3 Paths for each border: the\n    // straight line, and two round corners which represent half of the entire rounded\n    // corner.  To simplify code those shapes are drawed at origin (by the drawEdge\n    // function), then translated/rotated into the right position.\n    //\n    // However, this leads to poor results due to rounding in the simpler cases where\n    // borders are straight lines.  Therefore we handle a few such cases separately with\n    // straight lines. C^wC^wC^w -- nope, scratch that.  poor rendering was because of a bug\n    // in Chrome (getClientRects() returns rounded integer values rather than exact floats.\n    // web dev is still a ghetto.)\n    // first, just in case there is no border...\n\n    if (top.width === 0 && left.width === 0 && right.width === 0 && bottom.width === 0) {\n      return;\n    } // START paint borders\n    // if all borders have equal colors...\n\n\n    if (top.color == right.color && top.color == bottom.color && top.color == left.color) {\n      // if same widths too, we can draw the whole border by stroking a single path.\n      if (top.width == right.width && top.width == bottom.width && top.width == left.width) {\n        if (shouldDrawLeft && shouldDrawRight) {\n          // reduce box by half the border width, so we can draw it by stroking.\n          box = innerBox(box, top.width / 2); // adjust the border radiuses, again by top.width/2, and make the path element.\n\n          var path = elementRoundBox(element, box, top.width / 2);\n          path.options.stroke = {\n            color: top.color,\n            width: top.width\n          };\n          group.append(path);\n          return;\n        }\n      }\n    } // if border radiuses are zero and widths are at most one pixel, we can again use simple\n    // paths.\n\n\n    if (rTL0.x === 0 && rTR0.x === 0 && rBR0.x === 0 && rBL0.x === 0) {\n      // alright, 1.9px will do as well.  the difference in color blending should not be\n      // noticeable.\n      if (top.width < 2 && left.width < 2 && right.width < 2 && bottom.width < 2) {\n        // top border\n        if (top.width > 0) {\n          group.append(new Path({\n            stroke: {\n              width: top.width,\n              color: top.color\n            }\n          }).moveTo(box.left, box.top + top.width / 2).lineTo(box.right, box.top + top.width / 2));\n        } // bottom border\n\n\n        if (bottom.width > 0) {\n          group.append(new Path({\n            stroke: {\n              width: bottom.width,\n              color: bottom.color\n            }\n          }).moveTo(box.left, box.bottom - bottom.width / 2).lineTo(box.right, box.bottom - bottom.width / 2));\n        } // left border\n\n\n        if (shouldDrawLeft) {\n          group.append(new Path({\n            stroke: {\n              width: left.width,\n              color: left.color\n            }\n          }).moveTo(box.left + left.width / 2, box.top).lineTo(box.left + left.width / 2, box.bottom));\n        } // right border\n\n\n        if (shouldDrawRight) {\n          group.append(new Path({\n            stroke: {\n              width: right.width,\n              color: right.color\n            }\n          }).moveTo(box.right - right.width / 2, box.top).lineTo(box.right - right.width / 2, box.bottom));\n        }\n\n        return;\n      }\n    } // END paint borders\n\n\n    var tmp = adjustBorderRadiusForBox(box, rTL0, rTR0, rBR0, rBL0);\n    var rTL = tmp.tl;\n    var rTR = tmp.tr;\n    var rBR = tmp.br;\n    var rBL = tmp.bl; // top border\n\n    drawEdge(top.color, box.width, top.width, left.width, right.width, rTL, rTR, [1, 0, 0, 1, box.left, box.top]); // bottom border\n\n    drawEdge(bottom.color, box.width, bottom.width, right.width, left.width, rBR, rBL, [-1, 0, 0, -1, box.right, box.bottom]); // for left/right borders we need to invert the border-radiuses\n\n    function inv(p) {\n      return {\n        x: p.y,\n        y: p.x\n      };\n    } // left border\n\n\n    drawEdge(left.color, box.height, left.width, bottom.width, top.width, inv(rBL), inv(rTL), [0, -1, 1, 0, box.left, box.bottom]); // right border\n\n    drawEdge(right.color, box.height, right.width, top.width, bottom.width, inv(rTR), inv(rBR), [0, 1, -1, 0, box.right, box.top]);\n  }\n}\n\nfunction gradientRenderer(gradient) {\n  return function (group, rect) {\n    var width = rect.width(),\n        height = rect.height();\n\n    switch (gradient.type) {\n      case \"linear\":\n        // figure out the angle.\n        var angle = gradient.angle != null ? gradient.angle : Math.PI;\n\n        switch (gradient.to) {\n          case \"top\":\n            angle = 0;\n            break;\n\n          case \"left\":\n            angle = -Math.PI / 2;\n            break;\n\n          case \"bottom\":\n            angle = Math.PI;\n            break;\n\n          case \"right\":\n            angle = Math.PI / 2;\n            break;\n\n          case \"top left\":\n          case \"left top\":\n            angle = -Math.atan2(height, width);\n            break;\n\n          case \"top right\":\n          case \"right top\":\n            angle = Math.atan2(height, width);\n            break;\n\n          case \"bottom left\":\n          case \"left bottom\":\n            angle = Math.PI + Math.atan2(height, width);\n            break;\n\n          case \"bottom right\":\n          case \"right bottom\":\n            angle = Math.PI - Math.atan2(height, width);\n            break;\n        }\n\n        if (gradient.reverse) {\n          angle -= Math.PI;\n        } // limit the angle between 0..2PI\n\n\n        angle %= 2 * Math.PI;\n\n        if (angle < 0) {\n          angle += 2 * Math.PI;\n        } // compute gradient's start/end points.  here len is the length of the gradient line\n        // and x,y is the end point relative to the center of the rectangle in conventional\n        // (math) axis direction.\n        // this is the original (unscaled) length of the gradient line.  needed to deal with\n        // absolutely positioned color stops.  formula from the CSS spec:\n        // http://dev.w3.org/csswg/css-images-3/#linear-gradient-syntax\n\n\n        var pxlen = Math.abs(width * Math.sin(angle)) + Math.abs(height * Math.cos(angle)); // The math below is pretty simple, but it took a while to figure out.  We compute x\n        // and y, the *end* of the gradient line.  However, we want to transform them into\n        // element-based coordinates (SVG's gradientUnits=\"objectBoundingBox\").  That means,\n        // x=0 is the left edge, x=1 is the right edge, y=0 is the top edge and y=1 is the\n        // bottom edge.\n        //\n        // A naive approach would use the original angle for these calculations.  Say we'd\n        // like to draw a gradient angled at 45deg in a 100x400 box.  When we use\n        // objectBoundingBox, the renderer will draw it in a 1x1 *square* box, and then\n        // scale that to the desired dimensions.  The 45deg angle will look more like 70deg\n        // after scaling.  SVG (http://www.w3.org/TR/SVG/pservers.html#LinearGradients) says\n        // the following:\n        //\n        //     When gradientUnits=\"objectBoundingBox\" and 'gradientTransform' is the\n        //     identity matrix, the normal of the linear gradient is perpendicular to the\n        //     gradient vector in object bounding box space (i.e., the abstract coordinate\n        //     system where (0,0) is at the top/left of the object bounding box and (1,1) is\n        //     at the bottom/right of the object bounding box). When the object's bounding\n        //     box is not square, the gradient normal which is initially perpendicular to\n        //     the gradient vector within object bounding box space may render\n        //     non-perpendicular relative to the gradient vector in user space. If the\n        //     gradient vector is parallel to one of the axes of the bounding box, the\n        //     gradient normal will remain perpendicular. This transformation is due to\n        //     application of the non-uniform scaling transformation from bounding box space\n        //     to user space.\n        //\n        // which is an extremely long and confusing way to tell what I just said above.\n        //\n        // For this reason we need to apply the reverse scaling to the original angle, so\n        // that when it'll finally be rendered it'll actually be at the desired slope.  Now\n        // I'll let you figure out the math yourself.\n\n        var scaledAngle = Math.atan(width * Math.tan(angle) / height);\n        var sin = Math.sin(scaledAngle),\n            cos = Math.cos(scaledAngle);\n        var len = Math.abs(sin) + Math.abs(cos);\n        var x = len / 2 * sin;\n        var y = len / 2 * cos; // Because of the arctangent, our scaledAngle ends up between -PI/2..PI/2, possibly\n        // losing the intended direction of the gradient.  The following fixes it.\n\n        if (angle > Math.PI / 2 && angle <= 3 * Math.PI / 2) {\n          x = -x;\n          y = -y;\n        } // compute the color stops.\n\n\n        var implicit = [],\n            right = 0;\n        var stops = gradient.stops.map(function (s, i) {\n          var offset = s.percent;\n\n          if (offset) {\n            offset = parseFloat(offset) / 100;\n          } else if (s.length) {\n            offset = parseFloat(s.length) / pxlen;\n          } else if (i === 0) {\n            offset = 0;\n          } else if (i == gradient.stops.length - 1) {\n            offset = 1;\n          }\n\n          var stop = {\n            color: s.color.toCssRgba(),\n            offset: offset\n          };\n\n          if (offset != null) {\n            right = offset; // fix implicit offsets\n\n            implicit.forEach(function (s, i) {\n              var stop = s.stop;\n              stop.offset = s.left + (right - s.left) * (i + 1) / (implicit.length + 1);\n            });\n            implicit = [];\n          } else {\n            implicit.push({\n              left: right,\n              stop: stop\n            });\n          }\n\n          return stop;\n        });\n        var start = [0.5 - x, 0.5 + y];\n        var end = [0.5 + x, 0.5 - y]; // finally, draw it.\n\n        group.append(Path.fromRect(rect).stroke(null).fill(new LinearGradient({\n          start: start,\n          end: end,\n          stops: stops,\n          userSpace: false\n        })));\n        break;\n\n      case \"radial\":\n        // XXX:\n        if (window.console && window.console.log) {\n          window.console.log(\"Radial gradients are not yet supported in HTML renderer\");\n        }\n\n        break;\n    }\n  };\n}\n\nfunction maybeRenderWidget(element, group) {\n  var visual;\n\n  if (element._kendoExportVisual) {\n    visual = element._kendoExportVisual();\n  } else if (window.kendo && window.kendo.jQuery && element.getAttribute(window.kendo.attr(\"role\"))) {\n    var widget = window.kendo.widgetInstance(window.kendo.jQuery(element));\n\n    if (widget && (widget.exportDOMVisual || widget.exportVisual)) {\n      if (widget.exportDOMVisual) {\n        visual = widget.exportDOMVisual();\n      } else {\n        visual = widget.exportVisual();\n      }\n    }\n  }\n\n  if (!visual) {\n    return false;\n  }\n\n  var wrap = new Group();\n  wrap.children.push(visual);\n  var bbox = element.getBoundingClientRect();\n  wrap.transform(geo.transform().translate(bbox.left, bbox.top));\n  group.append(wrap);\n  return true;\n}\n\nfunction renderImage(element, url, group) {\n  var box = getContentBox(element);\n  var rect = new geo.Rect([box.left, box.top], [box.width, box.height]);\n  var image = new Image(url, rect);\n  setClipping(image, elementRoundBox(element, box, \"content\"));\n  group.append(image);\n}\n\nfunction zIndexSort(a, b) {\n  var sa = getComputedStyle(a);\n  var sb = getComputedStyle(b);\n  var za = parseFloat(getPropertyValue(sa, \"z-index\"));\n  var zb = parseFloat(getPropertyValue(sb, \"z-index\"));\n  var pa = getPropertyValue(sa, \"position\");\n  var pb = getPropertyValue(sb, \"position\");\n\n  if (isNaN(za) && isNaN(zb)) {\n    if (/static|absolute/.test(pa) && /static|absolute/.test(pb)) {\n      return 0;\n    }\n\n    if (pa == \"static\") {\n      return -1;\n    }\n\n    if (pb == \"static\") {\n      return 1;\n    }\n\n    return 0;\n  }\n\n  if (isNaN(za)) {\n    return zb === 0 ? 0 : zb > 0 ? -1 : 1;\n  }\n\n  if (isNaN(zb)) {\n    return za === 0 ? 0 : za > 0 ? 1 : -1;\n  }\n\n  return parseFloat(za) - parseFloat(zb);\n}\n\nfunction isFormField(element) {\n  return /^(?:textarea|select|input)$/i.test(element.tagName);\n}\n\nfunction getSelectedOption(element) {\n  if (element.selectedOptions && element.selectedOptions.length > 0) {\n    return element.selectedOptions[0];\n  }\n\n  return element.options[element.selectedIndex];\n}\n\nfunction renderCheckbox(element, group) {\n  var style = getComputedStyle(element);\n  var color = getPropertyValue(style, \"color\");\n  var box = element.getBoundingClientRect();\n\n  if (element.type == \"checkbox\") {\n    group.append(Path.fromRect(new geo.Rect([box.left + 1, box.top + 1], [box.width - 2, box.height - 2])).stroke(color, 1));\n\n    if (element.checked) {\n      // fill a rectangle inside?  looks kinda ugly.\n      // group.append(\n      //     Path.fromRect(\n      //         new geo.Rect([ box.left+4, box.top+4 ],\n      //                      [ box.width-8, box.height-8])\n      //     ).fill(color).stroke(null)\n      // );\n      // let's draw a checkmark instead.  artistic, eh?\n      group.append(new Path().stroke(color, 1.2).moveTo(box.left + 0.22 * box.width, box.top + 0.55 * box.height).lineTo(box.left + 0.45 * box.width, box.top + 0.75 * box.height).lineTo(box.left + 0.78 * box.width, box.top + 0.22 * box.width));\n    }\n  } else {\n    group.append(new Circle(new geo.Circle([(box.left + box.right) / 2, (box.top + box.bottom) / 2], Math.min(box.width - 2, box.height - 2) / 2)).stroke(color, 1));\n\n    if (element.checked) {\n      group.append(new Circle(new geo.Circle([(box.left + box.right) / 2, (box.top + box.bottom) / 2], Math.min(box.width - 8, box.height - 8) / 2)).fill(color).stroke(null));\n    }\n  }\n}\n\nfunction renderFormField(element, group) {\n  var tag = element.tagName.toLowerCase();\n\n  if (tag == \"input\" && (element.type == \"checkbox\" || element.type == \"radio\")) {\n    return renderCheckbox(element, group);\n  }\n\n  var p = element.parentNode;\n  var doc = element.ownerDocument;\n  var el = doc.createElement(KENDO_PSEUDO_ELEMENT);\n  var option;\n  el.style.cssText = getCssText(getComputedStyle(element));\n\n  if (tag == \"input\") {\n    el.style.whiteSpace = \"pre\";\n  }\n\n  if (tag == \"select\" || tag == \"textarea\") {\n    el.style.overflow = \"auto\";\n  }\n\n  if (tag == \"select\") {\n    if (element.multiple) {\n      for (var i = 0; i < element.options.length; ++i) {\n        option = doc.createElement(KENDO_PSEUDO_ELEMENT);\n        option.style.cssText = getCssText(getComputedStyle(element.options[i]));\n        option.style.display = \"block\"; // IE9 messes up without this\n\n        option.textContent = element.options[i].textContent;\n        el.appendChild(option);\n      }\n    } else {\n      option = getSelectedOption(element);\n\n      if (option) {\n        el.textContent = option.textContent;\n      }\n    }\n  } else {\n    el.textContent = element.value;\n  }\n\n  p.insertBefore(el, element);\n  el.scrollLeft = element.scrollLeft;\n  el.scrollTop = element.scrollTop; // must temporarily hide the original element, otherwise it\n  // may affect layout of the fake element we want to render.\n\n  element.style.display = \"none\";\n  renderContents(el, group);\n  element.style.display = \"\";\n  p.removeChild(el);\n}\n\nfunction serializeSVG(element) {\n  var serializer = new window.XMLSerializer();\n  var xml = serializer.serializeToString(element);\n\n  if (browser.mozilla && !(element.getAttribute(\"width\") && element.getAttribute(\"height\"))) {\n    var doc = new window.DOMParser().parseFromString(xml, \"image/svg+xml\");\n    var svg = doc.documentElement;\n    var box = getContentBox(element);\n    svg.setAttribute(\"width\", box.width);\n    svg.setAttribute(\"height\", box.height);\n    xml = serializer.serializeToString(svg);\n  }\n\n  return xml;\n}\n\nfunction renderContents(element, group) {\n  if (nodeInfo._stackingContext.element === element) {\n    // the group that was set in pushNodeInfo might have\n    // changed due to clipping/transforms, update it here.\n    nodeInfo._stackingContext.group = group;\n  }\n\n  switch (element.tagName.toLowerCase()) {\n    case \"img\":\n      renderImage(element, element.src, group);\n      break;\n\n    case \"svg\":\n      var xml = serializeSVG(element);\n      var dataURL = \"data:image/svg+xml;base64,\" + encodeBase64(xml);\n      renderImage(element, dataURL, group);\n      break;\n\n    case \"canvas\":\n      try {\n        renderImage(element, element.toDataURL(\"image/png\"), group);\n      } catch (ex) {// tainted; can't draw it, ignore.\n      }\n\n      break;\n\n    case \"textarea\":\n    case \"input\":\n    case \"select\":\n      renderFormField(element, group);\n      break;\n\n    default:\n      var children = [],\n          floats = [],\n          positioned = [];\n\n      for (var i = element.firstChild; i; i = i.nextSibling) {\n        switch (i.nodeType) {\n          case 3:\n            // Text\n            if (/\\S/.test(i.data)) {\n              renderText(element, i, group);\n            }\n\n            break;\n\n          case 1:\n            // Element\n            var style = getComputedStyle(i);\n            var floating = getPropertyValue(style, \"float\");\n            var position = getPropertyValue(style, \"position\");\n\n            if (position != \"static\") {\n              positioned.push(i);\n            } else if (floating != \"none\") {\n              floats.push(i);\n            } else {\n              children.push(i);\n            }\n\n            break;\n        }\n      }\n\n      mergeSort(children, zIndexSort).forEach(function (el) {\n        renderElement(el, group);\n      });\n      mergeSort(floats, zIndexSort).forEach(function (el) {\n        renderElement(el, group);\n      });\n      mergeSort(positioned, zIndexSort).forEach(function (el) {\n        renderElement(el, group);\n      });\n  }\n}\n\nfunction renderText(element, node, group) {\n  if (emptyClipbox()) {\n    return;\n  }\n\n  var style = getComputedStyle(element);\n\n  if (parseFloat(getPropertyValue(style, \"text-indent\")) < -500) {\n    // assume it should not be displayed.  the slider's\n    // draggable handle displays a Drag text for some reason,\n    // having text-indent: -3333px.\n    return;\n  }\n\n  var text = node.data;\n  var start = 0;\n  var end = text.search(/\\S\\s*$/) + 1;\n\n  if (!end) {\n    return; // whitespace-only node\n  }\n\n  var fontSize = getPropertyValue(style, \"font-size\");\n  var lineHeight = getPropertyValue(style, \"line-height\"); // simply getPropertyValue(\"font\") doesn't work in Firefox :-\\\n\n  var font = [getPropertyValue(style, \"font-style\"), getPropertyValue(style, \"font-variant\"), getPropertyValue(style, \"font-weight\"), fontSize, // no need for line height here; it breaks layout in FF\n  getPropertyValue(style, \"font-family\")].join(\" \");\n  fontSize = parseFloat(fontSize);\n  lineHeight = parseFloat(lineHeight);\n\n  if (fontSize === 0) {\n    return;\n  }\n\n  var color = getPropertyValue(style, \"color\");\n  var range = element.ownerDocument.createRange();\n  var align = getPropertyValue(style, \"text-align\");\n  var isJustified = align == \"justify\";\n  var columnCount = getPropertyValue(style, \"column-count\", 1);\n  var whiteSpace = getPropertyValue(style, \"white-space\");\n  var textTransform = getPropertyValue(style, \"text-transform\"); // A line of 500px, with a font of 12px, contains an average of 80 characters, but since we\n  // err, we'd like to guess a bigger number rather than a smaller one.  Multiplying by 5\n  // seems to be a good option.\n\n  var estimateLineLength = element.getBoundingClientRect().width / fontSize * 5;\n\n  if (estimateLineLength === 0) {\n    estimateLineLength = 500;\n  } // we'll maintain this so we can workaround bugs in Chrome's Range.getClientRects\n  // https://github.com/telerik/kendo/issues/5740\n\n\n  var prevLineBottom = null;\n  var underline = nodeInfo[\"underline\"];\n  var lineThrough = nodeInfo[\"line-through\"];\n  var overline = nodeInfo[\"overline\"];\n  var hasDecoration = underline || lineThrough || overline; // doChunk returns true when all text has been rendered\n\n  while (!doChunk()) {}\n\n  if (hasDecoration) {\n    range.selectNode(node);\n    slice(range.getClientRects()).forEach(decorate);\n  }\n\n  return; // only function declarations after this line\n\n  function actuallyGetRangeBoundingRect(range) {\n    // XXX: to be revised when this Chrome bug is fixed:\n    // https://bugs.chromium.org/p/chromium/issues/detail?id=612459\n    if (microsoft || browser.chrome || browser.safari) {\n      // Workaround browser bugs: IE and Chrome would sometimes\n      // return 0 or 1-width rectangles before or after the main\n      // one.  https://github.com/telerik/kendo/issues/4674\n      // Actually Chrome 50 got worse, since the rectangles can now have the width of a\n      // full character, making it hard to tell whether it's a bogus rectangle or valid\n      // selection location.  The workaround is to ignore rectangles that fall on the\n      // previous line.  https://github.com/telerik/kendo/issues/5740\n      var rectangles = range.getClientRects(),\n          box = {\n        top: Infinity,\n        right: -Infinity,\n        bottom: -Infinity,\n        left: Infinity\n      },\n          done = false;\n\n      for (var i = 0; i < rectangles.length; ++i) {\n        var b = rectangles[i];\n\n        if (b.width <= 1 || b.bottom === prevLineBottom) {\n          continue; // bogus rectangle\n        }\n\n        box.left = Math.min(b.left, box.left);\n        box.top = Math.min(b.top, box.top);\n        box.right = Math.max(b.right, box.right);\n        box.bottom = Math.max(b.bottom, box.bottom);\n        done = true;\n      }\n\n      if (!done) {\n        return range.getBoundingClientRect();\n      }\n\n      box.width = box.right - box.left;\n      box.height = box.bottom - box.top;\n      return box;\n    }\n\n    return range.getBoundingClientRect();\n  } // Render a chunk of text, typically one line (but for justified text we render each word as\n  // a separate Text object, because spacing is variable).  Returns true when it finished the\n  // current node.  After each chunk it updates `start` to just after the last rendered\n  // character.\n\n\n  function doChunk() {\n    var origStart = start;\n    var box,\n        pos = text.substr(start).search(/\\S/);\n    start += pos;\n\n    if (pos < 0 || start >= end) {\n      return true;\n    } // Select a single character to determine the height of a line of text.  The box.bottom\n    // will be essential for us to figure out where the next line begins.\n\n\n    range.setStart(node, start);\n    range.setEnd(node, start + 1);\n    box = actuallyGetRangeBoundingRect(range); // for justified text we must split at each space, because space has variable width.\n\n    var found = false;\n\n    if (isJustified || columnCount > 1) {\n      pos = text.substr(start).search(/\\s/);\n\n      if (pos >= 0) {\n        // we can only split there if it's on the same line, otherwise we'll fall back\n        // to the default mechanism (see findEOL below).\n        range.setEnd(node, start + pos);\n        var r = actuallyGetRangeBoundingRect(range);\n\n        if (r.bottom == box.bottom) {\n          box = r;\n          found = true;\n          start += pos;\n        }\n      }\n    }\n\n    if (!found) {\n      // This code does three things: (1) it selects one line of text in `range`, (2) it\n      // leaves the bounding rect of that line in `box` and (3) it returns the position\n      // just after the EOL.  We know where the line starts (`start`) but we don't know\n      // where it ends.  To figure this out, we select a piece of text and look at the\n      // bottom of the bounding box.  If it changes, we have more than one line selected\n      // and should retry with a smaller selection.\n      //\n      // To speed things up, we first try to select all text in the node (`start` ->\n      // `end`).  If there's more than one line there, then select only half of it.  And\n      // so on.  When we find a value for `end` that fits in one line, we try increasing\n      // it (also in halves) until we get to the next line.  The algorithm stops when the\n      // right side of the bounding box does not change.\n      //\n      // One more thing to note is that everything happens in a single Text DOM node.\n      // There's no other tags inside it, therefore the left/top coordinates of the\n      // bounding box will not change.\n      pos = function findEOL(min, eol, max) {\n        range.setEnd(node, eol);\n        var r = actuallyGetRangeBoundingRect(range);\n\n        if (r.bottom != box.bottom && min < eol) {\n          return findEOL(min, min + eol >> 1, eol);\n        } else if (r.right != box.right) {\n          box = r;\n\n          if (eol < max) {\n            return findEOL(eol, eol + max >> 1, max);\n          } else {\n            return eol;\n          }\n        } else {\n          return eol;\n        }\n      }(start, Math.min(end, start + estimateLineLength), end);\n\n      if (pos == start) {\n        // if EOL is at the start, then no more text fits on this line.  Skip the\n        // remainder of this node entirely to avoid a stack overflow.\n        return true;\n      }\n\n      start = pos;\n      pos = range.toString().search(/\\s+$/);\n\n      if (pos === 0) {\n        return false; // whitespace only; we should not get here.\n      }\n\n      if (pos > 0) {\n        // eliminate trailing whitespace\n        range.setEnd(node, range.startOffset + pos);\n        box = actuallyGetRangeBoundingRect(range);\n      }\n    } // another workaround for IE: if we rely on getBoundingClientRect() we'll overlap with the bullet for LI\n    // elements.  Calling getClientRects() and using the *first* rect appears to give us the correct location.\n    // Note: not to be used in Chrome as it randomly returns a zero-width rectangle from the previous line.\n\n\n    if (microsoft) {\n      box = range.getClientRects()[0];\n    }\n\n    var str = range.toString();\n\n    if (!/^(?:pre|pre-wrap)$/i.test(whiteSpace)) {\n      // node with non-significant space -- collapse whitespace.\n      str = str.replace(/\\s+/g, \" \");\n    } else if (/\\t/.test(str)) {\n      // with significant whitespace we need to do something about literal TAB characters.\n      // There's no TAB glyph in a font so they would be rendered in PDF as an empty box,\n      // and the whole text will stretch to fill the original width.  The core PDF lib\n      // does not have sufficient context to deal with it.\n      // calculate the starting column here, since we initially discarded any whitespace.\n      var cc = 0;\n\n      for (pos = origStart; pos < range.startOffset; ++pos) {\n        var code = text.charCodeAt(pos);\n\n        if (code == 9) {\n          // when we meet a TAB we must round up to the next tab stop.\n          // in all browsers TABs seem to be 8 characters.\n          cc += 8 - cc % 8;\n        } else if (code == 10 || code == 13) {\n          // just in case we meet a newline we must restart.\n          cc = 0;\n        } else {\n          // ordinary character --> advance one column\n          cc++;\n        }\n      } // based on starting column, replace any TAB characters in the string we actually\n      // have to display with spaces so that they align to columns multiple of 8.\n\n\n      while ((pos = str.search(\"\\t\")) >= 0) {\n        var indent = \"        \".substr(0, 8 - (cc + pos) % 8);\n        str = str.substr(0, pos) + indent + str.substr(pos + 1);\n      }\n    }\n\n    if (!found) {\n      prevLineBottom = box.bottom;\n    }\n\n    drawText(str, box);\n  }\n\n  function drawText(str, box) {\n    // In IE the box height will be approximately lineHeight, while in\n    // other browsers it'll (correctly) be the height of the bounding\n    // box for the current text/font.  Which is to say, IE sucks again.\n    // The only good solution I can think of is to measure the text\n    // ourselves and center the bounding box.\n    if (microsoft && !isNaN(lineHeight)) {\n      var height = getFontHeight(font);\n      var top = (box.top + box.bottom - height) / 2;\n      box = {\n        top: top,\n        right: box.right,\n        bottom: top + height,\n        left: box.left,\n        height: height,\n        width: box.right - box.left\n      };\n    } // var path = new Path({ stroke: { color: \"red\" }});\n    // path.moveTo(box.left, box.top)\n    //     .lineTo(box.right, box.top)\n    //     .lineTo(box.right, box.bottom)\n    //     .lineTo(box.left, box.bottom)\n    //     .close();\n    // group.append(path);\n\n\n    switch (textTransform) {\n      case \"uppercase\":\n        str = str.toUpperCase();\n        break;\n\n      case \"lowercase\":\n        str = str.toLowerCase();\n        break;\n\n      case \"capitalize\":\n        str = str.replace(/(?:^|\\s)\\S/g, function (l) {\n          return l.toUpperCase();\n        });\n        break;\n    }\n\n    var text = new TextRect(str, new geo.Rect([box.left, box.top], [box.width, box.height]), {\n      font: font,\n      fill: {\n        color: color\n      }\n    });\n    group.append(text);\n  }\n\n  function decorate(box) {\n    line(underline, box.bottom);\n    line(lineThrough, box.bottom - box.height / 2.7);\n    line(overline, box.top);\n\n    function line(color, ypos) {\n      if (color) {\n        var width = fontSize / 12;\n        var path = new Path({\n          stroke: {\n            width: width,\n            color: color\n          }\n        });\n        ypos -= width;\n        path.moveTo(box.left, ypos).lineTo(box.right, ypos);\n        group.append(path);\n      }\n    }\n  }\n}\n\nfunction groupInStackingContext(element, group, zIndex) {\n  var main;\n\n  if (zIndex != \"auto\") {\n    // use the current stacking context\n    main = nodeInfo._stackingContext.group;\n    zIndex = parseFloat(zIndex);\n  } else {\n    // normal flow â€” use given container.  we still have to\n    // figure out where should we insert this element with the\n    // assumption that its z-index is zero, as the group might\n    // already contain elements with higher z-index.\n    main = group;\n    zIndex = 0;\n  }\n\n  var a = main.children;\n\n  for (var i = 0; i < a.length; ++i) {\n    if (a[i]._dom_zIndex != null && a[i]._dom_zIndex > zIndex) {\n      break;\n    }\n  }\n\n  var tmp = new Group();\n  main.insert(i, tmp);\n  tmp._dom_zIndex = zIndex;\n\n  if (main !== group) {\n    // console.log(\"Placing\", element, \"in\", nodeInfo._stackingContext.element, \"at position\", i, \" / \", a.length);\n    // console.log(a.slice(i+1));\n    // if (nodeInfo._matrix) {\n    //     tmp.transform(nodeInfo._matrix);\n    // }\n    if (nodeInfo._clipbox) {\n      var m = nodeInfo._matrix.invert();\n\n      var r = nodeInfo._clipbox.transformCopy(m);\n\n      setClipping(tmp, Path.fromRect(r)); // console.log(r);\n      // tmp.append(Path.fromRect(r));\n      // tmp.append(new Text(element.className || element.id, r.topLeft()));\n    }\n  }\n\n  return tmp;\n}\n\nfunction renderElement(element, container) {\n  var style = getComputedStyle(element);\n  updateCounters(style);\n\n  if (/^(style|script|link|meta|iframe|col|colgroup)$/i.test(element.tagName)) {\n    return;\n  }\n\n  if (nodeInfo._clipbox == null) {\n    return;\n  }\n\n  var opacity = parseFloat(getPropertyValue(style, \"opacity\"));\n  var visibility = getPropertyValue(style, \"visibility\");\n  var display = getPropertyValue(style, \"display\");\n\n  if (opacity === 0 || visibility == \"hidden\" || display == \"none\") {\n    return;\n  }\n\n  var tr = getTransform(style);\n  var group;\n  var zIndex = getPropertyValue(style, \"z-index\");\n\n  if ((tr || opacity < 1) && zIndex == \"auto\") {\n    zIndex = 0;\n  }\n\n  group = groupInStackingContext(element, container, zIndex); // XXX: remove at some point\n  // group._pdfElement = element;\n  // group.options._pdfDebug = \"\";\n  // if (element.id) {\n  //     group.options._pdfDebug = \"#\" + element.id;\n  // }\n  // if (element.className) {\n  //     group.options._pdfDebug += \".\" + element.className.split(\" \").join(\".\");\n  // }\n\n  if (opacity < 1) {\n    group.opacity(opacity * group.opacity());\n  }\n\n  pushNodeInfo(element, style, group);\n\n  if (!tr) {\n    _renderWithPseudoElements(element, group);\n  } else {\n    saveStyle(element, function () {\n      // must clear transform, so getBoundingClientRect returns correct values.\n      pleaseSetPropertyValue(element.style, \"transform\", \"none\", \"important\"); // must also clear transitions, so correct values are returned *immediately*\n\n      pleaseSetPropertyValue(element.style, \"transition\", \"none\", \"important\"); // the presence of any transform makes it behave like it had position: relative,\n      // because why not.\n      // http://meyerweb.com/eric/thoughts/2011/09/12/un-fixing-fixed-elements-with-css-transforms/\n\n      if (getPropertyValue(style, \"position\") == \"static\") {\n        // but only if it's not already positioned. :-/\n        pleaseSetPropertyValue(element.style, \"position\", \"relative\", \"important\");\n      } // must translate to origin before applying the CSS\n      // transformation, then translate back.\n\n\n      var bbox = element.getBoundingClientRect();\n      var x = bbox.left + tr.origin[0];\n      var y = bbox.top + tr.origin[1];\n      var m = [1, 0, 0, 1, -x, -y];\n      m = mmul(m, tr.matrix);\n      m = mmul(m, [1, 0, 0, 1, x, y]);\n      m = setTransform(group, m);\n      nodeInfo._matrix = nodeInfo._matrix.multiplyCopy(m);\n\n      _renderWithPseudoElements(element, group);\n    });\n  }\n\n  popNodeInfo(); //drawDebugBox(element.getBoundingClientRect(), container);\n} // function drawDebugBox(box, group, color) {\n//     var path = Path.fromRect(new geo.Rect([ box.left, box.top ], [ box.width, box.height ]));\n//     if (color) {\n//         path.stroke(color);\n//     }\n//     group.append(path);\n// }\n// function dumpTextNode(node) {\n//     var txt = node.data.replace(/^\\s+/, \"\");\n//     if (txt.length < 100) {\n//         console.log(node.data.length + \": |\" + txt);\n//     } else {\n//         console.log(node.data.length + \": |\" + txt.substr(0, 50) + \"|...|\" + txt.substr(-50));\n//     }\n// }\n\n\nfunction mmul(a, b) {\n  var a1 = a[0],\n      b1 = a[1],\n      c1 = a[2],\n      d1 = a[3],\n      e1 = a[4],\n      f1 = a[5];\n  var a2 = b[0],\n      b2 = b[1],\n      c2 = b[2],\n      d2 = b[3],\n      e2 = b[4],\n      f2 = b[5];\n  return [a1 * a2 + b1 * c2, a1 * b2 + b1 * d2, c1 * a2 + d1 * c2, c1 * b2 + d1 * d2, e1 * a2 + f1 * c2 + e2, e1 * b2 + f1 * d2 + f2];\n}\n\nexport { drawDOM, drawText, getFontFaces };","map":{"version":3,"names":["geo","PDF","arabicToRoman","createPromise","measureText","mergeSort","parseColor","utils_parseColor","support","template","compileTemplate","Path","Text","Group","Image","Circle","LinearGradient","encodeBase64","browser","slice","thing","Array","prototype","call","KENDO_PSEUDO_ELEMENT","IMAGE_CACHE","nodeInfo","_root","inBrowser","window","microsoft","msie","edge","TextRect","str","rect","options","getOrigin","_pdfRect","__proto__","Object","create","constructor","rawBBox","addClass","el","cls","classList","add","className","removeClass","remove","split","reduce","a","word","push","join","setCSS","styles","keys","forEach","key","style","matches","Element","p","selector","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","s","indexOf","document","querySelectorAll","closest","test","String","nodeType","parentNode","cloneNodes","$","clone","cloneNode","$el","$clone","i","data","tagName","getContext","drawImage","removeAttribute","value","checked","selected","firstChild","nextSibling","appendChild","dive","node","_kendoExportVisual","canvases","length","canvas","orig","kendo","jQuery","getXY","x","y","isArray","drawDOM","element","promise","reject","getComputedStyle","Error","defineFont","getFontFaces","ownerDocument","scale","doOne","group","pos","getBoundingClientRect","setTransform","left","top","_clipbox","_matrix","Matrix","unit","_stackingContext","avoidLinks","_avoidLinks","renderElement","cacheImages","forceBreak","forcePageBreak","hasPaperSize","paperSize","paperOptions","getPaperOptions","def","pageWidth","pageHeight","margin","hasMargin","Boolean","right","bottom","pdf","multiPage","_ignoreMargin","handlePageBreaks","progress","canceled","pageNum","next","pages","page","append","totalPages","cancel","setTimeout","container","removeChild","resolve","makeTemplate","replace","div","createElement","innerHTML","firstElementChild","callback","doc","copy","_destructive","adjust","tfoot","ol","children","li","index","setAttribute","display","position","boxSizing","width","paddingLeft","paddingRight","overflow","insertBefore","beforePageBreak","whenImagesAreActuallyLoaded","doPageBreak","splitElement","makePage","bind","keepTogether","offsetHeight","tag","getAttribute","tableLayout","bottomPadding","parseFloat","getPropertyValue","bottomBorder","saveAdjust","isFirst","breakAtElement","fall","fallsOnMargin","splitText","firstInParent","first","table","colgroup","thead","grid","gridHead","querySelector","repeatHeaders","range","createRange","setStartBefore","setEndBefore","extractContents","preventBulletOnListItem","padding","height","clear","pageClassName","box","available","len","selectNodeContents","nextnode","findEOP","min","max","setEnd","toString","endOffset","drawText","pushNodeInfo","renderText","_renderElement","popNodeInfo","parseBackgroundImage","tok_linear_gradient","tok_percent","tok_length","tok_keyword","tok_angle","tok_whitespace","tok_popen","tok_pclose","tok_comma","tok_url","tok_content","cache1","cache2","parse","input","hasOwnProperty","skip_ws","m","exec","substr","read","token","read_stop","color","percent","match","toRGB","read_linear_gradient","propName","angle","to1","to2","stops","reverse","parseAngle","stop","type","to","read_url","url","tok","splitProperty","map","cache","separator","cacheKey","ret","last","in_paren","in_string","looking_at","rx","trim","substring","getFontURL","getFontHeight","font","result","styleSheets","doStylesheet","ss","rules","cssRules","ex","addRules","findFonts","rule","src","cssText","styleSheet","r","family","bold","italic","addRule","names","href","name","obj","getCounter","getAllCounters","values","getPrototypeOf","incCounter","inc","resetCounter","val","doCounters","f","isNaN","updateCounters","counterReset","counterIncrement","css","toCssRgba","elements","pending","images","img","complete","onload","onerror","urls","bg","count","crossOrigin","alphaNumeral","n","fromCharCode","Math","floor","toLowerCase","decoration","createsStackingContext","updateClipbox","path","bbox","Rect","intersect","emptyClipbox","cb","prop","pseudoElt","defa","webkit","mozilla","opera","arguments","pleaseSetPropertyValue","important","setProperty","p1","p2","toUpperCase","getBorder","side","saveStyle","func","prev","getBorderRadius","sanitizeRadius","getContentBox","innerBox","wt","wr","wb","wl","getTransform","transform","matrix","origin","radiansToDegrees","radians","PI","num","shape","setClipping","clipPath","clip","addArcToPath","points","Arc","curvePoints","curveTo","adjustBorderRadiusForBox","rTL","rTR","rBR","rBL","tl_x","tl_y","tr_x","tr_y","br_x","br_y","bl_x","bl_y","tl","tr","br","bl","elementRoundBox","bt","bb","pt","pr","pb","pl","roundBox","rTL0","rTR0","rBR0","rBL0","tmp","fill","stroke","moveTo","startAngle","endAngle","radiusX","radiusY","lineTo","close","formatCounter","evalPseudoElementContent","content","displayCounter","parseInt","getCssText","_renderWithPseudoElements","fake","pseudo","kind","place","psel","textContent","saveClass","dir","backgroundColor","backgroundImage","backgroundRepeat","backgroundPosition","backgroundOrigin","backgroundSize","textOverflow","saveTextOverflow","version","currentStyle","innerbox","boxes","cells","getClientRects","adjustBoxes","drawOneBox","g","_pdfLink","drawBullet","clipit","isFormField","maybeRenderWidget","renderContents","tableBorderLeft","tableBorderTop","tableBox","firstCell","rows","firstCellBox","drawEdge","Wtop","Wleft","Wright","rl","rr","drawRoundCorner","ri","cos","sin","anticlockwise","drawBackground","background","drawOneBackground","drawBackgroundImage","gradientRenderer","img_width","img_height","renderBG","aspect_ratio","orgBox","size","rewX","rewY","repeatX","listStyleType","listStylePosition","_drawBullet","bullet","textAlign","elementIndex","k","fontSize","lineHeight","fontFamily","idx","isLast","shouldDrawLeft","shouldDrawRight","inv","gradient","atan2","pxlen","abs","scaledAngle","atan","tan","implicit","offset","start","end","fromRect","userSpace","console","log","visual","attr","widget","widgetInstance","exportDOMVisual","exportVisual","wrap","translate","renderImage","image","zIndexSort","b","sa","sb","za","zb","pa","getSelectedOption","selectedOptions","selectedIndex","renderCheckbox","renderFormField","option","whiteSpace","multiple","scrollLeft","scrollTop","serializeSVG","serializer","XMLSerializer","xml","serializeToString","DOMParser","parseFromString","svg","documentElement","dataURL","toDataURL","floats","positioned","floating","text","search","align","isJustified","columnCount","textTransform","estimateLineLength","prevLineBottom","underline","lineThrough","overline","hasDecoration","doChunk","selectNode","decorate","actuallyGetRangeBoundingRect","chrome","safari","rectangles","Infinity","done","origStart","setStart","found","findEOL","eol","startOffset","cc","code","charCodeAt","indent","l","line","ypos","groupInStackingContext","zIndex","main","_dom_zIndex","insert","invert","transformCopy","opacity","visibility","mmul","multiplyCopy","a1","b1","c1","d1","e1","f1","a2","b2","c2","d2","e2","f2"],"sources":["C:/Users/asana/Documents/TEC/Semestre 5/Seguridad_Informatica/ModuloReact/Admin/frontend/node_modules/@progress/kendo-drawing/dist/es/html/core.js"],"sourcesContent":["/* eslint-disable no-multi-spaces, key-spacing, indent, camelcase, space-before-blocks, eqeqeq, brace-style */\n/* eslint-disable space-infix-ops, space-before-function-paren, array-bracket-spacing, object-curly-spacing */\n/* eslint-disable no-nested-ternary, max-params, default-case, no-else-return, no-empty, yoda */\n/* eslint-disable no-param-reassign, no-var, block-scoped-var */\n\nimport * as geo from \"../geometry\";\nimport * as PDF from \"../pdf\";\nimport { arabicToRoman, createPromise, measureText, mergeSort } from '../util';\nimport { parseColor as utils_parseColor, support, template as compileTemplate } from \"../common\";\nimport { Path, Text, Group, Image, Circle, LinearGradient } from \"../drawing\";\nimport { encodeBase64 } from \"../util\";\n\nvar browser = support.browser || {};\n/*\n\n  XXX: to test:\n\n  - cloneNodes function:\n    - drawing document containing canvas with page breaking\n    - drawing document with named radio <input>-s (should not clear selection)\n    - IE9/IE10 don't support el.dataset; do they copy user data?\n\n  - repeating table headers/footers on page breaking\n\n  - forceBreak, keepTogether\n\n  - avoidLinks\n\n */\n\n/* -----[ local vars ]----- */\n\nfunction slice(thing) {\n    return Array.prototype.slice.call(thing);\n}\n\nvar KENDO_PSEUDO_ELEMENT = \"KENDO-PSEUDO-ELEMENT\";\n\nvar IMAGE_CACHE = {};\n\nvar nodeInfo = {};\nnodeInfo._root = nodeInfo;\n\n/* -----[ Custom Text node to speed up rendering in PDF ]----- */\n\nvar inBrowser = typeof window !== 'undefined';\nvar microsoft = inBrowser ? browser.msie || browser.edge : false;\n\nvar TextRect = (function (Text) {\n  function TextRect(str, rect, options) {\n        Text.call(this, str, rect.getOrigin(), options);\n        this._pdfRect = rect;\n    }\n\n  if ( Text ) TextRect.__proto__ = Text;\n  TextRect.prototype = Object.create( Text && Text.prototype );\n  TextRect.prototype.constructor = TextRect;\n    TextRect.prototype.rect = function rect () {\n        // this is the crux of it: we can avoid a call to\n        // measure(), which is what the base class does, since we\n        // already know the rect.  measure() is s-l-o-w.\n        return this._pdfRect;\n    };\n    TextRect.prototype.rawBBox = function rawBBox () {\n        // also let's avoid creating a new rectangle.\n        return this._pdfRect;\n    };\n\n  return TextRect;\n}(Text));\n\nfunction addClass(el, cls) {\n    if (el.classList) {\n        el.classList.add(cls);\n    } else {\n        el.className += \" \" + cls;\n    }\n}\n\nfunction removeClass(el, cls) {\n    if (el.classList) {\n        el.classList.remove(cls);\n    } else {\n        el.className = el.className.split(/\\s+/).reduce(function(a, word){\n            if (word != cls) {\n                a.push(word);\n            }\n            return a;\n        }, []).join(\" \");\n    }\n}\n\nfunction setCSS(el, styles) {\n    Object.keys(styles).forEach(function(key){\n        el.style[key] = styles[key];\n    });\n}\n\nvar matches = typeof Element !== \"undefined\" && Element.prototype && (function(p){\n    if (p.matches) {\n        return function(el, selector) { return el.matches(selector); };\n    }\n    if (p.webkitMatchesSelector) {\n        return function(el, selector) { return el.webkitMatchesSelector(selector); };\n    }\n    if (p.mozMatchesSelector) {\n        return function(el, selector) { return el.mozMatchesSelector(selector); };\n    }\n    if (p.msMatchesSelector) {\n        return function(el, selector) { return el.msMatchesSelector(selector); };\n    }\n    return function(s) {\n\treturn [].indexOf.call(document.querySelectorAll(s), this) !== -1;\n    };\n})(Element.prototype);\n\nfunction closest(el, selector) {\n    if (el.closest) {\n        return el.closest(selector);\n    }\n    // IE: stringifying rather than simply comparing with `document`,\n    // which is not iframe-proof and fails in editor export â€”\n    // https://github.com/telerik/kendo/issues/6721\n    while (el && !/^\\[object (?:HTML)?Document\\]$/.test(String(el))) {\n        if (el.nodeType == 1 /* Element */ && matches(el, selector)) {\n            return el;\n        }\n        el = el.parentNode;\n    }\n}\n\n// clone nodes ourselves, so that we redraw <canvas> (DOM or\n// jQuery clone will not)\nvar cloneNodes = (function($){\n    if ($) {\n        // if we have Kendo and jQuery, use this version as it will\n        // maintain proper links between cloned element and Kendo\n        // widgets (i.e. it clones jQuery data(), which isn't the same\n        // as element's data attributes).\n        // https://github.com/telerik/kendo-ui-core/issues/2750\n        return function cloneNodes(el) {\n            var clone = el.cloneNode(false);\n            if (el.nodeType == 1 /* Element */) {\n                var $el = $(el), $clone = $(clone), i;\n                var data = $el.data();\n                for (i in data) {\n                    $clone.data(i, data[i]);\n                }\n                if (/^canvas$/i.test(el.tagName)) {\n                    clone.getContext(\"2d\").drawImage(el, 0, 0);\n                } else if (/^(?:input|select|textarea|option)$/i.test(el.tagName)) {\n                    // drop the name attributes so that we don't affect the selection of the\n                    // original nodes (i.e. checked status of radio buttons) when we insert our copy\n                    // into the DOM.  https://github.com/telerik/kendo/issues/5409\n                    clone.removeAttribute(\"id\");\n                    clone.removeAttribute(\"name\");\n                    if (!/^textarea$/i.test(el.tagName)) {\n                        clone.value = el.value;\n                    }\n                    clone.checked = el.checked;\n                    clone.selected = el.selected;\n                }\n                for (i = el.firstChild; i; i = i.nextSibling) {\n                    clone.appendChild(cloneNodes(i));\n                }\n            }\n            return clone;\n        };\n    } else {\n        // the no-jQuery version\n        return function cloneNodes(el) {\n            var clone = (function dive(node){\n                var clone = node.cloneNode(false);\n                if (node._kendoExportVisual) {\n                    clone._kendoExportVisual = node._kendoExportVisual;\n                }\n                for (var i = node.firstChild; i; i = i.nextSibling) {\n                    clone.appendChild(dive(i));\n                }\n                return clone;\n            })(el);\n\n            // re-draw canvases - https://github.com/telerik/kendo/issues/4872\n            var canvases = el.querySelectorAll(\"canvas\");\n            if (canvases.length) {\n                slice(clone.querySelectorAll(\"canvas\")).forEach(function (canvas, i) {\n                    canvas.getContext(\"2d\").drawImage(canvases[i], 0, 0);\n                });\n            }\n\n            // remove \"name\" attributes from <input> elements -\n            // https://github.com/telerik/kendo/issues/5409\n            var orig = el.querySelectorAll(\"input, select, textarea, option\");\n            slice(clone.querySelectorAll(\"input, select, textarea, option\")).forEach(function (el, i) {\n                el.removeAttribute(\"id\");\n                el.removeAttribute(\"name\");\n                if (!/^textarea$/i.test(el.tagName)) {\n                    el.value = orig[i].value;\n                }\n                el.checked = orig[i].checked;\n                el.selected = orig[i].selected;\n            });\n\n            return clone;\n        };\n    }\n})(typeof window !== \"undefined\" && window.kendo && window.kendo.jQuery);\n\nfunction getXY(thing) {\n    if (typeof thing == \"number\") {\n        return { x: thing, y: thing };\n    }\n    if (Array.isArray(thing)) {\n        return { x: thing[0], y: thing[1] };\n    }\n    return { x: thing.x, y: thing.y };\n}\n\nfunction drawDOM(element, options) {\n    if (!options) {\n        options = {};\n    }\n    var promise = createPromise();\n\n    if (!element) {\n        return promise.reject(\"No element to export\");\n    }\n\n    if (typeof window.getComputedStyle != \"function\") {\n        throw new Error(\"window.getComputedStyle is missing.  You are using an unsupported browser, or running in IE8 compatibility mode.  Drawing HTML is supported in Chrome, Firefox, Safari and IE9+.\");\n    }\n\n    PDF.defineFont(getFontFaces(element.ownerDocument));\n\n    var scale = getXY(options.scale || 1);\n\n    function doOne(element) {\n        var group = new Group();\n\n        // translate to start of page\n        var pos = element.getBoundingClientRect();\n        setTransform(group, [\n            scale.x,\n            0,\n            0,\n            scale.y,\n            (-pos.left * scale.x),\n            (-pos.top * scale.y)\n        ]);\n\n        nodeInfo._clipbox = false;\n        nodeInfo._matrix = geo.Matrix.unit();\n        nodeInfo._stackingContext = {\n            element: element,\n            group: group\n        };\n\n        if (options.avoidLinks === true) {\n            nodeInfo._avoidLinks = \"a\";\n        } else {\n            nodeInfo._avoidLinks = options.avoidLinks;\n        }\n\n        addClass(element, \"k-pdf-export\");\n        renderElement(element, group);\n        removeClass(element, \"k-pdf-export\");\n\n        return group;\n    }\n\n    cacheImages([ element ], function(){\n        var forceBreak = options && options.forcePageBreak;\n        var hasPaperSize = options && options.paperSize && options.paperSize != \"auto\";\n        var paperOptions = PDF.getPaperOptions(function(key, def){\n            if (key == \"paperSize\") {\n                // PDF.getPaperOptions croaks on \"auto\", just pass dummy A4 as we might\n                // still be interested in margins.\n                return hasPaperSize ? options[key] : \"A4\";\n            }\n            return key in options ? options[key] : def;\n        });\n        var pageWidth = hasPaperSize && paperOptions.paperSize[0];\n        var pageHeight = hasPaperSize && paperOptions.paperSize[1];\n        var margin = options.margin && paperOptions.margin;\n        var hasMargin = Boolean(margin);\n        if (forceBreak || pageHeight) {\n            if (!margin) {\n                margin = { left: 0, top: 0, right: 0, bottom: 0 };\n            }\n\n            // we want paper size and margin to be unaffected by\n            // scaling in the output, so we have to reverse-scale\n            // before our calculations begin.\n            if (pageWidth)  { pageWidth  /= scale.x; }\n            if (pageHeight) { pageHeight /= scale.y; }\n            margin.left   /= scale.x;\n            margin.right  /= scale.x;\n            margin.top    /= scale.y;\n            margin.bottom /= scale.y;\n\n            var group = new Group({\n                pdf: {\n                    multiPage     : true,\n                    paperSize     : hasPaperSize ? paperOptions.paperSize : \"auto\",\n                    _ignoreMargin : hasMargin // HACK!  see exportPDF in pdf/drawing.js\n                }\n            });\n            handlePageBreaks(\n                function(x) {\n                    if (options.progress) {\n                        var canceled = false, pageNum = 0;\n                        (function next(){\n                            if (pageNum < x.pages.length) {\n                                var page = doOne(x.pages[pageNum]);\n                                group.append(page);\n                                options.progress({\n                                    page: page,\n                                    pageNum: ++pageNum,\n                                    totalPages: x.pages.length,\n                                    cancel: function() {\n                                        canceled = true;\n                                    }\n                                });\n                                if (!canceled) {\n                                    setTimeout(next);\n                                } else {\n                                    // XXX: should we also fail() the deferred object?\n                                    x.container.parentNode.removeChild(x.container);\n                                }\n                            } else {\n                                x.container.parentNode.removeChild(x.container);\n                                promise.resolve(group);\n                            }\n                        })();\n                    } else {\n                        x.pages.forEach(function(page){\n                            group.append(doOne(page));\n                        });\n                        x.container.parentNode.removeChild(x.container);\n                        promise.resolve(group);\n                    }\n                },\n                element,\n                forceBreak,\n                pageWidth ? pageWidth - margin.left - margin.right : null,\n                pageHeight ? pageHeight - margin.top - margin.bottom : null,\n                margin,\n                options\n            );\n        } else {\n            promise.resolve(doOne(element));\n        }\n    });\n\n    function makeTemplate(template) {\n        if (template != null) {\n            if (typeof template == \"string\") {\n                template = compileTemplate(template.replace(/^\\s+|\\s+$/g, \"\"));\n            }\n            if (typeof template == \"function\") {\n                return function(data) {\n                    var el = template(data);\n                    if (el && typeof el == \"string\") {\n                        var div = document.createElement(\"div\");\n                        div.innerHTML = el;\n                        el = div.firstElementChild;\n                    }\n                    return el;\n                };\n            }\n            // assumed DOM element\n            return function() {\n                return template.cloneNode(true);\n            };\n        }\n    }\n\n    function handlePageBreaks(callback, element, forceBreak, pageWidth, pageHeight, margin, options) {\n        var template = makeTemplate(options.template);\n        var doc = element.ownerDocument;\n        var pages = [];\n        var copy = options._destructive ? element : cloneNodes(element);\n        var container = doc.createElement(\"KENDO-PDF-DOCUMENT\");\n        var adjust = 0;\n\n        // make sure <tfoot> elements are at the end (Grid widget\n        // places TFOOT before TBODY, tricking our algorithm to\n        // insert a page break right after the header).\n        // https://github.com/telerik/kendo/issues/4699\n        slice(copy.querySelectorAll(\"tfoot\")).forEach(function(tfoot){\n            tfoot.parentNode.appendChild(tfoot);\n        });\n\n        // remember the index of each LI from an ordered list.\n        // we'll use it to reconstruct the proper numbering.\n        slice(copy.querySelectorAll(\"ol\")).forEach(function(ol){\n            slice(ol.children).forEach(function(li, index){\n                li.setAttribute(\"kendo-split-index\", index);\n            });\n        });\n\n        setCSS(container, {\n            display   : \"block\",\n            position  : \"absolute\",\n            boxSizing : \"content-box\",\n            left      : \"-10000px\",\n            top       : \"-10000px\"\n        });\n\n        if (pageWidth) {\n            // subtle: if we don't set the width *and* margins here, the layout in this\n            // container will be different from the one in our final page elements, and we'll\n            // split at the wrong places.\n            setCSS(container, {\n                width        : pageWidth + \"px\",\n                paddingLeft  : margin.left + \"px\",\n                paddingRight : margin.right + \"px\"\n            });\n\n            // when the first element has a margin-top (i.e. a <h1>) the page will be\n            // inadvertently enlarged by that number (the browser will report the container's\n            // bounding box top to start at the element's top, rather than including its\n            // margin).  Adding overflow: hidden seems to fix it.\n            //\n            // to understand the difference, try the following snippets in your browser:\n            //\n            // 1. <div style=\"background: yellow\">\n            //      <h1 style=\"margin: 3em\">Foo</h1>\n            //    </div>\n            //\n            // 2. <div style=\"background: yellow; overflow: hidden\">\n            //      <h1 style=\"margin: 3em\">Foo</h1>\n            //    </div>\n            //\n            // this detail is not important when automatic page breaking is not requested, hence\n            // doing it only if pageWidth is defined.\n            setCSS(copy, { overflow: \"hidden\" });\n        }\n\n        element.parentNode.insertBefore(container, element);\n        container.appendChild(copy);\n\n        // With cache disabled, images will still have height zero until their `complete` attribute\n        // is true.  `whenImagesAreActuallyLoaded` will wait for it.\n        if (options.beforePageBreak) {\n            whenImagesAreActuallyLoaded([ container ], function() {\n                options.beforePageBreak(container, doPageBreak);\n            });\n        } else {\n            whenImagesAreActuallyLoaded([ container ], doPageBreak);\n        }\n\n        function doPageBreak() {\n            if (forceBreak != \"-\" || pageHeight) {\n                splitElement(copy);\n            }\n\n            {\n                var page = makePage();\n                copy.parentNode.insertBefore(page, copy);\n                page.appendChild(copy);\n            }\n\n            if (template) {\n                pages.forEach(function(page, i){\n                    var el = template({\n                        element    : page,\n                        pageNum    : i + 1,\n                        totalPages : pages.length\n                    });\n                    if (el) {\n                        page.appendChild(el);\n                    }\n                });\n            }\n\n            cacheImages(pages, callback.bind(null, { pages: pages, container: container }));\n        }\n\n        function keepTogether(el) {\n            if (options.keepTogether && matches(el, options.keepTogether) && el.offsetHeight <= pageHeight - adjust) {\n                return true;\n            }\n\n            var tag = el.tagName;\n            if (/^h[1-6]$/i.test(tag) && el.offsetHeight >= pageHeight - adjust) {\n                return false;\n            }\n\n            return (el.getAttribute(\"data-kendo-chart\") ||\n                    /^(?:img|tr|thead|th|tfoot|iframe|svg|object|canvas|input|textarea|select|video|h[1-6])/i.test(el.tagName));\n        }\n\n        function splitElement(element) {\n            if (element.tagName == \"TABLE\") {\n                setCSS(element, { tableLayout: \"fixed\" });\n            }\n            if (keepTogether(element)) {\n                return;\n            }\n            var style = getComputedStyle(element);\n            var bottomPadding = parseFloat(getPropertyValue(style, \"padding-bottom\"));\n            var bottomBorder = parseFloat(getPropertyValue(style, \"border-bottom-width\"));\n            var saveAdjust = adjust;\n            adjust += bottomPadding + bottomBorder;\n            var isFirst = true;\n            for (var el = element.firstChild; el; el = el.nextSibling) {\n                if (el.nodeType == 1 /* Element */) {\n                    isFirst = false;\n                    if (matches(el, forceBreak)) {\n                        breakAtElement(el);\n                        continue;\n                    }\n                    if (!pageHeight) {\n                        // we're in \"manual breaks mode\"\n                        splitElement(el);\n                        continue;\n                    }\n                    if (!/^(?:static|relative)$/.test(getPropertyValue(getComputedStyle(el), \"position\"))) {\n                        continue;\n                    }\n                    var fall = fallsOnMargin(el);\n                    if (fall == 1) {\n                        // element starts on next page, break before anyway.\n                        breakAtElement(el);\n                    }\n                    else if (fall) {\n                        // elements ends up on next page, or possibly doesn't fit on a page at\n                        // all.  break before it anyway if it's an <img> or <tr>, otherwise\n                        // attempt to split.\n                        if (keepTogether(el)) {\n                            breakAtElement(el);\n                        } else {\n                            splitElement(el);\n                        }\n                    }\n                    else {\n                        splitElement(el);\n                    }\n                }\n                else if (el.nodeType == 3 /* Text */ && pageHeight) {\n                    splitText(el, isFirst);\n                    isFirst = false;\n                }\n            }\n            adjust = saveAdjust;\n        }\n\n        function firstInParent(el) {\n            var p = el.parentNode, first = p.firstChild;\n            if (el === first) {\n                return true;\n            }\n            if (el === p.children[0]) {\n                if (first.nodeType == 7 /* comment */ ||\n                    first.nodeType == 8 /* processing instruction */) {\n                    return true;\n                }\n                if (first.nodeType == 3 /* text */) {\n                    // if whitespace only we can probably consider it's first\n                    return !/\\S/.test(first.data);\n                }\n            }\n            return false;\n        }\n\n        function breakAtElement(el) {\n            if (el.nodeType == 1 && el !== copy && firstInParent(el)) {\n                return breakAtElement(el.parentNode);\n            }\n            var table, colgroup, thead, grid, gridHead;\n            table = closest(el, \"table\");\n            colgroup = table && table.querySelector(\"colgroup\");\n            if (options.repeatHeaders) {\n                thead = table && table.querySelector(\"thead\");\n\n                // If we break page in a Kendo Grid, repeat its header.  This ugly hack is\n                // necessary because a scrollable grid will keep the header in a separate\n                // <table> element from its content.\n                //\n                // XXX: This is likely to break as soon as the widget HTML is modified.\n                grid = closest(el, \".k-grid.k-widget\");\n                if (grid && grid.querySelector(\".k-auto-scrollable\")) {\n                    gridHead = grid.querySelector(\".k-grid-header\");\n                }\n            }\n            var page = makePage();\n            var range = doc.createRange();\n            range.setStartBefore(copy);\n            range.setEndBefore(el);\n            page.appendChild(range.extractContents());\n            copy.parentNode.insertBefore(page, copy);\n            preventBulletOnListItem(el.parentNode);\n            if (table) {\n                table = closest(el, \"table\"); // that's the <table> on next page!\n                if (options.repeatHeaders && thead) {\n                    table.insertBefore(thead.cloneNode(true), table.firstChild);\n                }\n                if (colgroup) {\n                    table.insertBefore(colgroup.cloneNode(true), table.firstChild);\n                }\n            }\n            if (options.repeatHeaders && gridHead) {\n                grid = closest(el, \".k-grid.k-widget\");\n                grid.insertBefore(gridHead.cloneNode(true), grid.firstChild);\n            }\n        }\n\n        function makePage() {\n            var page = doc.createElement(\"KENDO-PDF-PAGE\");\n            setCSS(page, {\n                display  : \"block\",\n                boxSizing: \"content-box\",\n                width    : pageWidth ? (pageWidth + \"px\") : \"auto\",\n                padding  : (margin.top + \"px \" +\n                            margin.right + \"px \" +\n                            margin.bottom + \"px \" +\n                            margin.left + \"px\"),\n\n                // allow absolutely positioned elements to be relative to current page\n                position : \"relative\",\n\n                // without the following we might affect layout of subsequent pages\n                height   : pageHeight ? (pageHeight + \"px\") : \"auto\",\n                overflow : pageHeight || pageWidth ? \"hidden\" : \"visible\",\n                clear    : \"both\"\n            });\n\n            // debug\n            // $(\"<div>\").css({\n            //     position  : \"absolute\",\n            //     left      : margin.left,\n            //     top       : margin.top,\n            //     width     : pageWidth,\n            //     height    : pageHeight,\n            //     boxSizing : \"border-box\",\n            //     background: \"rgba(255, 255, 0, 0.5)\"\n            //     //border    : \"1px solid red\"\n            // }).appendTo(page);\n\n            if (options && options.pageClassName) {\n                page.className = options.pageClassName;\n            }\n            pages.push(page);\n            return page;\n        }\n\n        function fallsOnMargin(thing) {\n            var box = thing.getBoundingClientRect();\n            if (box.width === 0 || box.height === 0) {\n                // I'd say an element with dimensions zero fits on current page.\n                return 0;\n            }\n            var top = copy.getBoundingClientRect().top;\n            var available = pageHeight - adjust;\n            return (box.height > available) ? 3\n                : (box.top - top > available) ? 1\n                : (box.bottom - top > available) ? 2\n                : 0;\n        }\n\n        function splitText(node, isFirst) {\n            if (!/\\S/.test(node.data)) {\n                return;\n            }\n\n            var len = node.data.length;\n            var range = doc.createRange();\n            range.selectNodeContents(node);\n            var fall = fallsOnMargin(range);\n            if (!fall) {\n                return;     // the whole text fits on current page\n            }\n\n            var nextnode = node;\n            if (fall == 1) {\n                // starts on next page, break before anyway.\n                if (isFirst) {\n                    // avoid leaving an empty <p>, <li>, etc. on previous page.\n                    breakAtElement(node.parentNode);\n                } else {\n                    breakAtElement(node);\n                }\n            }\n            else {\n                (function findEOP(min, pos, max) {\n                    range.setEnd(node, pos);\n                    if (min == pos || pos == max) {\n                        return pos;\n                    }\n                    if (fallsOnMargin(range)) {\n                        return findEOP(min, (min + pos) >> 1, pos);\n                    } else {\n                        return findEOP(pos, (pos + max) >> 1, max);\n                    }\n                })(0, len >> 1, len);\n\n                if (!/\\S/.test(range.toString()) && isFirst) {\n                    // avoid leaving an empty <p>, <li>, etc. on previous page.\n                    breakAtElement(node.parentNode);\n                } else {\n                    // This is only needed for IE, but it feels cleaner to do it anyway.  Without\n                    // it, IE will truncate a very long text (playground/pdf-long-text-2.html).\n                    nextnode = node.splitText(range.endOffset);\n\n                    var page = makePage();\n                    range.setStartBefore(copy);\n                    page.appendChild(range.extractContents());\n                    copy.parentNode.insertBefore(page, copy);\n                    preventBulletOnListItem(nextnode.parentNode);\n                }\n            }\n\n            splitText(nextnode);\n        }\n\n        function preventBulletOnListItem(el) {\n            // set a hint on continued LI elements, to tell the\n            // renderer not to draw the bullet again.\n            // https://github.com/telerik/kendo-ui-core/issues/2732\n            var li = closest(el, \"li\");\n            if (li) {\n                li.setAttribute(\"kendo-no-bullet\", \"1\");\n                preventBulletOnListItem(li.parentNode);\n            }\n        }\n    }\n\n    return promise;\n}\n\n// This is needed for the Spreadsheet print functionality.  Since\n// there we only need to draw text, this cuts through the ceremony\n// of drawDOM/renderElement and renders the text node directly.\nfunction drawText(element) {\n    var group = new Group();\n    nodeInfo._clipbox = false;\n    nodeInfo._matrix = geo.Matrix.unit();\n    nodeInfo._stackingContext = {\n        element: element,\n        group: group\n    };\n    pushNodeInfo(element, getComputedStyle(element), group);\n    if (element.firstChild.nodeType == 3 /* Text */) {\n        // avoid the penalty of renderElement\n        renderText(element, element.firstChild, group);\n    } else {\n        _renderElement(element, group);\n    }\n    popNodeInfo();\n    return group;\n}\n\nvar parseBackgroundImage = (function(){\n    var tok_linear_gradient  = /^((-webkit-|-moz-|-o-|-ms-)?linear-gradient\\s*)\\(/;\n    //var tok_radial_gradient  = /^((-webkit-|-moz-|-o-|-ms-)?radial-gradient\\s*)\\(/;\n    var tok_percent          = /^([-0-9.]+%)/;\n    var tok_length           = /^([-0-9.]+px)/;\n    var tok_keyword          = /^(left|right|top|bottom|to|center)\\W/;\n    var tok_angle            = /^([-0-9.]+(deg|grad|rad|turn)|0)/;\n    var tok_whitespace       = /^(\\s+)/;\n    var tok_popen            = /^(\\()/;\n    var tok_pclose           = /^(\\))/;\n    var tok_comma            = /^(,)/;\n    var tok_url              = /^(url)\\(/;\n    var tok_content          = /^(.*?)\\)/;\n\n    var cache1 = {}, cache2 = {};\n\n    function parse(input) {\n        var orig = input;\n        if (hasOwnProperty(cache1, orig)) {\n            return cache1[orig];\n        }\n        function skip_ws() {\n            var m = tok_whitespace.exec(input);\n            if (m) {\n                input = input.substr(m[1].length);\n            }\n        }\n        function read(token) {\n            skip_ws();\n            var m = token.exec(input);\n            if (m) {\n                input = input.substr(m[1].length);\n                return m[1];\n            }\n        }\n\n        function read_stop() {\n            var color = utils_parseColor(input, true);\n            var length, percent;\n            if (color) {\n                var match =\n                    /^#[0-9a-f]+/i.exec(input) ||\n                    /^rgba?\\(.*?\\)/i.exec(input) ||\n                    /^..*?\\b/.exec(input); // maybe named color\n                input = input.substr(match[0].length);\n                color = color.toRGB();\n                if (!(length = read(tok_length))) {\n                    percent = read(tok_percent);\n                }\n                return { color: color, length: length, percent: percent };\n            }\n        }\n\n        function read_linear_gradient(propName) {\n            var angle;\n            var to1, to2;\n            var stops = [];\n            var reverse = false;\n\n            if (read(tok_popen)) {\n                // 1. [ <angle> || to <side-or-corner>, ]?\n                angle = read(tok_angle);\n                if (angle == \"0\") {\n                    angle = \"0deg\"; // Edge\n                }\n                if (angle) {\n                    angle = parseAngle(angle);\n                    read(tok_comma);\n                }\n                else {\n                    to1 = read(tok_keyword);\n                    if (to1 == \"to\") {\n                        to1 = read(tok_keyword);\n                    } else if (to1 && /^-/.test(propName)) {\n                        reverse = true;\n                    }\n                    to2 = read(tok_keyword);\n                    read(tok_comma);\n                }\n\n                if (/-moz-/.test(propName) && angle == null && to1 == null) {\n                    var x = read(tok_percent), y = read(tok_percent);\n                    reverse = true;\n                    if (x == \"0%\") {\n                        to1 = \"left\";\n                    } else if (x == \"100%\") {\n                        to1 = \"right\";\n                    }\n                    if (y == \"0%\") {\n                        to2 = \"top\";\n                    } else if (y == \"100%\") {\n                        to2 = \"bottom\";\n                    }\n                    read(tok_comma);\n                }\n\n                // 2. color stops\n                while (input && !read(tok_pclose)) {\n                    var stop = read_stop();\n                    if (!stop) {\n                        break;\n                    }\n                    stops.push(stop);\n                    read(tok_comma);\n                }\n\n                return {\n                    type    : \"linear\",\n                    angle   : angle,\n                    to      : to1 && to2 ? to1 + \" \" + to2 : to1 ? to1 : to2 ? to2 : null,\n                    stops   : stops,\n                    reverse : reverse\n                };\n            }\n        }\n\n        function read_url() {\n            if (read(tok_popen)) {\n                var url = read(tok_content);\n                url = url.replace(/^['\"]+|[\"']+$/g, \"\");\n                read(tok_pclose);\n                return { type: \"url\", url: url };\n            }\n        }\n\n        var tok;\n\n        if ((tok = read(tok_linear_gradient))) {\n            tok = read_linear_gradient(tok);\n        }\n        else if ((tok = read(tok_url))) {\n            tok = read_url();\n        }\n\n        return (cache1[orig] = tok || { type: \"none\" });\n    }\n\n    return function(input) {\n        if (hasOwnProperty(cache2, input)) {\n            return cache2[input];\n        }\n        return (cache2[input] = splitProperty(input).map(parse));\n    };\n})();\n\nvar splitProperty = (function(){\n    var cache = {};\n    return function(input, separator) {\n        if (!separator) {\n            separator = /^\\s*,\\s*/;\n        }\n\n        var cacheKey = input + separator;\n\n        if (hasOwnProperty(cache, cacheKey)) {\n            return cache[cacheKey];\n        }\n\n        var ret = [];\n        var last = 0, pos = 0;\n        var in_paren = 0;\n        var in_string = false;\n        var m;\n\n        function looking_at(rx) {\n            return (m = rx.exec(input.substr(pos)));\n        }\n\n        function trim(str) {\n            return str.replace(/^\\s+|\\s+$/g, \"\");\n        }\n\n        while (pos < input.length) {\n            if (!in_string && looking_at(/^[\\(\\[\\{]/)) {\n                in_paren++;\n                pos++;\n            }\n            else if (!in_string && looking_at(/^[\\)\\]\\}]/)) {\n                in_paren--;\n                pos++;\n            }\n            else if (!in_string && looking_at(/^[\\\"\\']/)) {\n                in_string = m[0];\n                pos++;\n            }\n            else if (in_string == \"'\" && looking_at(/^\\\\\\'/)) {\n                pos += 2;\n            }\n            else if (in_string == '\"' && looking_at(/^\\\\\\\"/)) {\n                pos += 2;\n            }\n            else if (in_string == \"'\" && looking_at(/^\\'/)) {\n                in_string = false;\n                pos++;\n            }\n            else if (in_string == '\"' && looking_at(/^\\\"/)) {\n                in_string = false;\n                pos++;\n            }\n            else if (looking_at(separator)) {\n                if (!in_string && !in_paren && pos > last) {\n                    ret.push(trim(input.substring(last, pos)));\n                    last = pos + m[0].length;\n                }\n                pos += m[0].length;\n            }\n            else {\n                pos++;\n            }\n        }\n        if (last < pos) {\n            ret.push(trim(input.substring(last, pos)));\n        }\n        return (cache[cacheKey] = ret);\n    };\n})();\n\nvar getFontURL = (function(cache){\n    return function(el){\n        // XXX: for IE we get here the whole cssText of the rule,\n        // because the computedStyle.src is empty.  Next time we need\n        // to fix these regexps we better write a CSS parser. :-\\\n        var url = cache[el];\n        if (!url) {\n            var m;\n            if ((m = /url\\((['\"]?)([^'\")]*?)\\1\\)\\s+format\\((['\"]?)truetype\\3\\)/.exec(el))) {\n                url = cache[el] = m[2];\n            } else if ((m = /url\\((['\"]?)([^'\")]*?\\.ttf)\\1\\)/.exec(el))) {\n                url = cache[el] = m[2];\n            }\n        }\n        return url;\n    };\n})(Object.create(null));\n\nvar getFontHeight = (function(cache){\n    return function(font) {\n        var height = cache[font];\n        if (height == null) {\n            height = cache[font] = measureText(\"Mapq\", { font: font }).height;\n        }\n        return height;\n    };\n})(Object.create(null));\n\nfunction getFontFaces(doc) {\n    if (doc == null) {\n        doc = document;\n    }\n    var result = {};\n    for (var i = 0; i < doc.styleSheets.length; ++i) {\n        doStylesheet(doc.styleSheets[i]);\n    }\n    return result;\n    function doStylesheet(ss) {\n        if (ss) {\n            var rules = null;\n            try {\n                rules = ss.cssRules;\n            } catch (ex) {}\n            if (rules) {\n                addRules(ss, rules);\n            }\n        }\n    }\n    function findFonts(rule) {\n        var src = getPropertyValue(rule.style, \"src\");\n        if (src) {\n            return splitProperty(src).reduce(function(a, el){\n                var font = getFontURL(el);\n                if (font) {\n                    a.push(font);\n                }\n                return a;\n            }, []);\n        } else {\n            // Internet Explorer\n            // XXX: this is gross.  should work though for valid CSS.\n            var font = getFontURL(rule.cssText);\n            return font ? [ font ] : [];\n        }\n    }\n    function addRules(styleSheet, rules) {\n        for (var i = 0; i < rules.length; ++i) {\n            var r = rules[i];\n            switch (r.type) {\n              case 3:       // CSSImportRule\n                doStylesheet(r.styleSheet);\n                break;\n              case 5:       // CSSFontFaceRule\n                var style  = r.style;\n                var family = splitProperty(getPropertyValue(style, \"font-family\"));\n                var bold   = /^([56789]00|bold)$/i.test(getPropertyValue(style, \"font-weight\"));\n                var italic = \"italic\" == getPropertyValue(style, \"font-style\");\n                var src    = findFonts(r);\n                if (src.length > 0) {\n                    addRule(styleSheet, family, bold, italic, src[0]);\n                }\n            }\n        }\n    }\n    function addRule(styleSheet, names, bold, italic, url) {\n        // We get full resolved absolute URLs in Chrome, but sadly\n        // not in Firefox.\n        if (!(/^data:/i.test(url))) {\n            if (!(/^[^\\/:]+:\\/\\//.test(url) || /^\\//.test(url))) {\n                url = String(styleSheet.href).replace(/[^\\/]*$/, \"\") + url;\n            }\n        }\n        names.forEach(function(name){\n            name = name.replace(/^(['\"]?)(.*?)\\1$/, \"$2\"); // it's quoted\n            if (bold) {\n                name += \"|bold\";\n            }\n            if (italic) {\n                name += \"|italic\";\n            }\n            result[name] = url;\n        });\n    }\n}\n\nfunction hasOwnProperty(obj, key) {\n    return Object.prototype.hasOwnProperty.call(obj, key);\n}\n\nfunction getCounter(name) {\n    name = \"_counter_\" + name;\n    return nodeInfo[name];\n}\n\nfunction getAllCounters(name) {\n    var values = [], p = nodeInfo;\n    name = \"_counter_\" + name;\n    while (p) {\n        if (hasOwnProperty(p, name)) {\n            values.push(p[name]);\n        }\n        p = Object.getPrototypeOf(p);\n    }\n    return values.reverse();\n}\n\nfunction incCounter(name, inc) {\n    var p = nodeInfo;\n    name = \"_counter_\" + name;\n    while (p && !hasOwnProperty(p, name)) {\n        p = Object.getPrototypeOf(p);\n    }\n    if (!p) {\n        p = nodeInfo._root;\n    }\n    p[name] = (p[name] || 0) + (inc == null ? 1 : inc);\n}\n\nfunction resetCounter(name, val) {\n    name = \"_counter_\" + name;\n    nodeInfo[name] = val == null ? 0 : val;\n}\n\nfunction doCounters(a, f, def) {\n    for (var i = 0; i < a.length;) {\n        var name = a[i++];\n        var val = parseFloat(a[i]);\n        if (isNaN(val)) {\n            f(name, def);\n        } else {\n            f(name, val);\n            ++i;\n        }\n    }\n}\n\nfunction updateCounters(style) {\n    var counterReset = getPropertyValue(style, \"counter-reset\");\n    if (counterReset) {\n        doCounters(splitProperty(counterReset, /^\\s+/), resetCounter, 0);\n    }\n    var counterIncrement = getPropertyValue(style, \"counter-increment\");\n    if (counterIncrement) {\n        doCounters(splitProperty(counterIncrement, /^\\s+/), incCounter, 1);\n    }\n}\n\nfunction parseColor(str, css) {\n    var color = utils_parseColor(str, true);\n    if (color) {\n        color = color.toRGB();\n        if (css) {\n            color = color.toCssRgba();\n        } else if (color.a === 0) {\n            color = null;\n        }\n    }\n    return color;\n}\n\nfunction whenImagesAreActuallyLoaded(elements, callback) {\n    var pending = 0;\n    elements.forEach(function(el){\n        var images = el.querySelectorAll(\"img\");\n        for (var i = 0; i < images.length; ++i) {\n            var img = images[i];\n            if (!img.complete) {\n                pending++;\n                img.onload = img.onerror = next;\n            }\n        }\n    });\n    if (!pending) {\n        next();\n    }\n    function next() {\n        if (--pending <= 0) {\n            callback();\n        }\n    }\n}\n\nfunction cacheImages(elements, callback) {\n    var urls = [];\n    function add(url) {\n        if (!IMAGE_CACHE[url]) {\n            IMAGE_CACHE[url] = true;\n            urls.push(url);\n        }\n    }\n\n    elements.forEach(function dive(element){\n        if (/^img$/i.test(element.tagName)) {\n            add(element.src);\n        }\n        parseBackgroundImage(\n            getPropertyValue(\n                getComputedStyle(element), \"background-image\"\n            )\n        ).forEach(function(bg){\n            if (bg.type == \"url\") {\n                add(bg.url);\n            }\n        });\n\n        if (element.children) {\n            slice(element.children).forEach(dive);\n        }\n    });\n\n    var count = urls.length;\n    function next() {\n        if (--count <= 0) {\n            // Even though we cached them, they simply won't be available immediately in the newly\n            // created DOM.  Previously we'd allow a 10ms timeout, but that's arbitrary and clearly\n            // not working in all cases (https://github.com/telerik/kendo/issues/5399), so this\n            // function will wait for their .complete attribute.\n            whenImagesAreActuallyLoaded(elements, callback);\n        }\n    }\n    if (count === 0) {\n        next();\n    }\n    urls.forEach(function(url){\n        var img = IMAGE_CACHE[url] = new window.Image();\n        if (!(/^data:/i.test(url))) {\n            img.crossOrigin = \"Anonymous\";\n        }\n        img.src = url;\n        if (img.complete) {\n            next();\n        } else {\n            img.onload = next;\n            img.onerror = function() {\n                IMAGE_CACHE[url] = null;\n                next();\n            };\n        }\n    });\n}\n\nfunction alphaNumeral(n) {\n    var result = \"\";\n    do {\n        var r = n % 26;\n        result = String.fromCharCode(97 + r) + result;\n        n = Math.floor(n / 26);\n    } while (n > 0);\n    return result;\n}\n\nfunction pushNodeInfo(element, style, group) {\n    nodeInfo = Object.create(nodeInfo);\n    nodeInfo[element.tagName.toLowerCase()] = {\n        element: element,\n        style: style\n    };\n    var decoration = getPropertyValue(style, \"text-decoration\");\n    if (decoration && decoration != \"none\") {\n        var color = getPropertyValue(style, \"color\");\n        decoration.split(/\\s+/g).forEach(function(name){\n            if (!nodeInfo[name]) {\n                nodeInfo[name] = color;\n            }\n        });\n    }\n\n    if (createsStackingContext(style)) {\n        nodeInfo._stackingContext = {\n            element: element,\n            group: group\n        };\n    }\n}\n\nfunction popNodeInfo() {\n    nodeInfo = Object.getPrototypeOf(nodeInfo);\n}\n\nfunction updateClipbox(path) {\n    if (nodeInfo._clipbox != null) {\n        var box = path.bbox(nodeInfo._matrix);\n        if (nodeInfo._clipbox) {\n            nodeInfo._clipbox = geo.Rect.intersect(nodeInfo._clipbox, box);\n        } else {\n            nodeInfo._clipbox = box;\n        }\n    }\n}\n\nfunction emptyClipbox() {\n    var cb = nodeInfo._clipbox;\n    if (cb == null) {\n        return true;\n    }\n    if (cb) {\n        return cb.width() === 0 || cb.height() === 0;\n    }\n}\n\nfunction createsStackingContext(style) {\n    function prop(name) { return getPropertyValue(style, name); }\n    if (prop(\"transform\") != \"none\" ||\n        prop(\"position\") != \"static\" ||\n        prop(\"z-index\") != \"auto\" ||\n        prop(\"opacity\") < 1) {\n        return true;\n    }\n}\n\nfunction getComputedStyle(element, pseudoElt) {\n    return window.getComputedStyle(element, pseudoElt || null);\n}\n\nfunction getPropertyValue(style, prop, defa) {\n    var val = style.getPropertyValue(prop);\n    if (val == null || val === \"\") {\n        if (browser.webkit) {\n            val = style.getPropertyValue(\"-webkit-\" + prop );\n        } else if (browser.mozilla) {\n            val = style.getPropertyValue(\"-moz-\" + prop );\n        } else if (browser.opera) {\n            val = style.getPropertyValue(\"-o-\" + prop);\n        } else if (microsoft) {\n            val = style.getPropertyValue(\"-ms-\" + prop);\n        }\n    }\n    if (arguments.length > 2 && (val == null || val === \"\")) {\n        return defa;\n    } else {\n        return val;\n    }\n}\n\nfunction pleaseSetPropertyValue(style, prop, value, important) {\n    style.setProperty(prop, value, important);\n    if (browser.webkit) {\n        style.setProperty(\"-webkit-\" + prop, value, important);\n    } else if (browser.mozilla) {\n        style.setProperty(\"-moz-\" + prop, value, important);\n    } else if (browser.opera) {\n        style.setProperty(\"-o-\" + prop, value, important);\n    } else if (microsoft) {\n        style.setProperty(\"-ms-\" + prop, value, important);\n        prop = \"ms\" + prop.replace(/(^|-)([a-z])/g, function(s, p1, p2){\n            return p1 + p2.toUpperCase();\n        });\n        style[prop] = value;\n    }\n}\n\nfunction getBorder(style, side) {\n    side = \"border-\" + side;\n    return {\n        width: parseFloat(getPropertyValue(style, side + \"-width\")),\n        style: getPropertyValue(style, side + \"-style\"),\n        color: parseColor(getPropertyValue(style, side + \"-color\"), true)\n    };\n}\n\nfunction saveStyle(element, func) {\n    var prev = element.style.cssText;\n    var result = func();\n    element.style.cssText = prev;\n    return result;\n}\n\nfunction getBorderRadius(style, side) {\n    var r = getPropertyValue(style, \"border-\" + side + \"-radius\").split(/\\s+/g).map(parseFloat);\n    if (r.length == 1) {\n        r.push(r[0]);\n    }\n    return sanitizeRadius({ x: r[0], y: r[1] });\n}\n\nfunction getContentBox(element) {\n    var box = element.getBoundingClientRect();\n    box = innerBox(box, \"border-*-width\", element);\n    box = innerBox(box, \"padding-*\", element);\n    return box;\n}\n\nfunction innerBox(box, prop, element) {\n    var style, wt, wr, wb, wl;\n    if (typeof prop == \"string\") {\n        style = getComputedStyle(element);\n        wt = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"top\")));\n        wr = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"right\")));\n        wb = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"bottom\")));\n        wl = parseFloat(getPropertyValue(style, prop.replace(\"*\", \"left\")));\n    }\n    else if (typeof prop == \"number\") {\n        wt = wr = wb = wl = prop;\n    }\n    return {\n        top    : box.top + wt,\n        right  : box.right - wr,\n        bottom : box.bottom - wb,\n        left   : box.left + wl,\n        width  : box.right - box.left - wr - wl,\n        height : box.bottom - box.top - wb - wt\n    };\n}\n\nfunction getTransform(style) {\n    var transform = getPropertyValue(style, \"transform\");\n    if (transform == \"none\") {\n        return null;\n    }\n    var matrix = /^\\s*matrix\\(\\s*(.*?)\\s*\\)\\s*$/.exec(transform);\n    if (matrix) {\n        var origin = getPropertyValue(style, \"transform-origin\");\n        matrix = matrix[1].split(/\\s*,\\s*/g).map(parseFloat);\n        origin = origin.split(/\\s+/g).map(parseFloat);\n        return {\n            matrix: matrix,\n            origin: origin\n        };\n    }\n}\n\nfunction radiansToDegrees(radians) {\n    return ((180 * radians) / Math.PI) % 360;\n}\n\nfunction parseAngle(angle) {\n    var num = parseFloat(angle);\n    if (/grad$/.test(angle)) {\n        return Math.PI * num / 200;\n    }\n    else if (/rad$/.test(angle)) {\n        return num;\n    }\n    else if (/turn$/.test(angle)) {\n        return Math.PI * num * 2;\n    }\n    else if (/deg$/.test(angle)) {\n        return Math.PI * num / 180;\n    }\n}\n\nfunction setTransform(shape, m) {\n    m = new geo.Matrix(m[0], m[1], m[2], m[3], m[4], m[5]);\n    shape.transform(m);\n    return m;\n}\n\nfunction setClipping(shape, clipPath) {\n    shape.clip(clipPath);\n}\n\nfunction addArcToPath(path, x, y, options) {\n    var points = new geo.Arc([ x, y ], options).curvePoints(), i = 1;\n    while (i < points.length) {\n        path.curveTo(points[i++], points[i++], points[i++]);\n    }\n}\n\nfunction sanitizeRadius(r) {\n    if (r.x <= 0 || r.y <= 0) {\n        r.x = r.y = 0;\n    }\n    return r;\n}\n\nfunction adjustBorderRadiusForBox(box, rTL, rTR, rBR, rBL) {\n    // adjust border radiuses such that the sum of adjacent\n    // radiuses is not bigger than the length of the side.\n    // seems the correct algorithm is variant (3) from here:\n    // http://www.w3.org/Style/CSS/Tracker/issues/29?changelog\n    var tl_x = Math.max(0, rTL.x), tl_y = Math.max(0, rTL.y);\n    var tr_x = Math.max(0, rTR.x), tr_y = Math.max(0, rTR.y);\n    var br_x = Math.max(0, rBR.x), br_y = Math.max(0, rBR.y);\n    var bl_x = Math.max(0, rBL.x), bl_y = Math.max(0, rBL.y);\n\n    var f = Math.min(\n        box.width / (tl_x + tr_x),\n        box.height / (tr_y + br_y),\n        box.width / (br_x + bl_x),\n        box.height / (bl_y + tl_y)\n    );\n\n    if (f < 1) {\n        tl_x *= f; tl_y *= f;\n        tr_x *= f; tr_y *= f;\n        br_x *= f; br_y *= f;\n        bl_x *= f; bl_y *= f;\n    }\n\n    return {\n        tl: { x: tl_x, y: tl_y },\n        tr: { x: tr_x, y: tr_y },\n        br: { x: br_x, y: br_y },\n        bl: { x: bl_x, y: bl_y }\n    };\n}\n\nfunction elementRoundBox(element, box, type) {\n    var style = getComputedStyle(element);\n\n    var rTL = getBorderRadius(style, \"top-left\");\n    var rTR = getBorderRadius(style, \"top-right\");\n    var rBL = getBorderRadius(style, \"bottom-left\");\n    var rBR = getBorderRadius(style, \"bottom-right\");\n\n    if (type == \"padding\" || type == \"content\") {\n        var bt = getBorder(style, \"top\");\n        var br = getBorder(style, \"right\");\n        var bb = getBorder(style, \"bottom\");\n        var bl = getBorder(style, \"left\");\n        rTL.x -= bl.width; rTL.y -= bt.width;\n        rTR.x -= br.width; rTR.y -= bt.width;\n        rBR.x -= br.width; rBR.y -= bb.width;\n        rBL.x -= bl.width; rBL.y -= bb.width;\n        if (type == \"content\") {\n            var pt = parseFloat(getPropertyValue(style, \"padding-top\"));\n            var pr = parseFloat(getPropertyValue(style, \"padding-right\"));\n            var pb = parseFloat(getPropertyValue(style, \"padding-bottom\"));\n            var pl = parseFloat(getPropertyValue(style, \"padding-left\"));\n            rTL.x -= pl; rTL.y -= pt;\n            rTR.x -= pr; rTR.y -= pt;\n            rBR.x -= pr; rBR.y -= pb;\n            rBL.x -= pl; rBL.y -= pb;\n        }\n    }\n\n    if (typeof type == \"number\") {\n        rTL.x -= type; rTL.y -= type;\n        rTR.x -= type; rTR.y -= type;\n        rBR.x -= type; rBR.y -= type;\n        rBL.x -= type; rBL.y -= type;\n    }\n\n    return roundBox(box, rTL, rTR, rBR, rBL);\n}\n\n// Create a drawing.Path for a rounded rectangle.  Receives the\n// bounding box and the border-radiuses in CSS order (top-left,\n// top-right, bottom-right, bottom-left).  The radiuses must be\n// objects containing x (horiz. radius) and y (vertical radius).\nfunction roundBox(box, rTL0, rTR0, rBR0, rBL0) {\n    var tmp = adjustBorderRadiusForBox(box, rTL0, rTR0, rBR0, rBL0);\n    var rTL = tmp.tl;\n    var rTR = tmp.tr;\n    var rBR = tmp.br;\n    var rBL = tmp.bl;\n    var path = new Path({ fill: null, stroke: null });\n    path.moveTo(box.left, box.top + rTL.y);\n    if (rTL.x) {\n        addArcToPath(path, box.left + rTL.x, box.top + rTL.y, {\n            startAngle: -180,\n            endAngle: -90,\n            radiusX: rTL.x,\n            radiusY: rTL.y\n        });\n    }\n    path.lineTo(box.right - rTR.x, box.top);\n    if (rTR.x) {\n        addArcToPath(path, box.right - rTR.x, box.top + rTR.y, {\n            startAngle: -90,\n            endAngle: 0,\n            radiusX: rTR.x,\n            radiusY: rTR.y\n        });\n    }\n    path.lineTo(box.right, box.bottom - rBR.y);\n    if (rBR.x) {\n        addArcToPath(path, box.right - rBR.x, box.bottom - rBR.y, {\n            startAngle: 0,\n            endAngle: 90,\n            radiusX: rBR.x,\n            radiusY: rBR.y\n        });\n    }\n    path.lineTo(box.left + rBL.x, box.bottom);\n    if (rBL.x) {\n        addArcToPath(path, box.left + rBL.x, box.bottom - rBL.y, {\n            startAngle: 90,\n            endAngle: 180,\n            radiusX: rBL.x,\n            radiusY: rBL.y\n        });\n    }\n    return path.close();\n}\n\nfunction formatCounter(val, style) {\n    var str = String(parseFloat(val));\n    switch (style) {\n      case \"decimal-leading-zero\":\n        if (str.length < 2) {\n            str = \"0\" + str;\n        }\n        return str;\n      case \"lower-roman\":\n        return arabicToRoman(val).toLowerCase();\n      case \"upper-roman\":\n        return arabicToRoman(val).toUpperCase();\n      case \"lower-latin\":\n      case \"lower-alpha\":\n        return alphaNumeral(val - 1);\n      case \"upper-latin\":\n      case \"upper-alpha\":\n        return alphaNumeral(val - 1).toUpperCase();\n      default:\n        return str;\n    }\n}\n\nfunction evalPseudoElementContent(element, content) {\n    function displayCounter(name, style, separator) {\n        if (!separator) {\n            return formatCounter(getCounter(name) || 0, style);\n        }\n        separator = separator.replace(/^\\s*([\"'])(.*)\\1\\s*$/, \"$2\");\n        return getAllCounters(name).map(function(val){\n            return formatCounter(val, style);\n        }).join(separator);\n    }\n    var a = splitProperty(content, /^\\s+/);\n    var result = [], m;\n    a.forEach(function(el){\n        var tmp;\n        if ((m = /^\\s*([\"'])(.*)\\1\\s*$/.exec(el))) {\n            result.push(m[2].replace(/\\\\([0-9a-f]{4})/gi, function(s, p){\n                return String.fromCharCode(parseInt(p, 16));\n            }));\n        }\n        else if ((m = /^\\s*counter\\((.*?)\\)\\s*$/.exec(el))) {\n            tmp = splitProperty(m[1]);\n            result.push(displayCounter(tmp[0], tmp[1]));\n        }\n        else if ((m = /^\\s*counters\\((.*?)\\)\\s*$/.exec(el))) {\n            tmp = splitProperty(m[1]);\n            result.push(displayCounter(tmp[0], tmp[2], tmp[1]));\n        }\n        else if ((m = /^\\s*attr\\((.*?)\\)\\s*$/.exec(el))) {\n            result.push(element.getAttribute(m[1]) || \"\");\n        }\n        else {\n            result.push(el);\n        }\n    });\n    return result.join(\"\");\n}\n\nfunction getCssText(style) {\n    if (style.cssText) {\n        return style.cssText;\n    }\n    // Status: NEW.  Report year: 2002.  Current year: 2014.\n    // Nice played, Mozillians.\n    // https://bugzilla.mozilla.org/show_bug.cgi?id=137687\n    var result = [];\n    for (var i = 0; i < style.length; ++i) {\n        result.push(style[i] + \": \" + getPropertyValue(style, style[i]));\n    }\n    return result.join(\";\\n\");\n}\n\nfunction _renderWithPseudoElements(element, group) {\n    if (element.tagName == KENDO_PSEUDO_ELEMENT) {\n        _renderElement(element, group);\n        return;\n    }\n    var fake = [];\n    function pseudo(kind, place) {\n        var style = getComputedStyle(element, kind), content = style.content;\n        updateCounters(style);\n        if (content && content != \"normal\" && content != \"none\" && style.width != \"0px\") {\n            var psel = element.ownerDocument.createElement(KENDO_PSEUDO_ELEMENT);\n            psel.style.cssText = getCssText(style);\n            psel.textContent = evalPseudoElementContent(element, content);\n            element.insertBefore(psel, place);\n            fake.push(psel);\n        }\n    }\n    pseudo(\":before\", element.firstChild);\n    pseudo(\":after\", null);\n    if (fake.length > 0) {\n        var saveClass = element.className;\n        element.className += \" kendo-pdf-hide-pseudo-elements\";\n        _renderElement(element, group);\n        element.className = saveClass;\n        fake.forEach(function(el){ element.removeChild(el); });\n    } else {\n        _renderElement(element, group);\n    }\n}\n\nfunction _renderElement(element, group) {\n    var style = getComputedStyle(element);\n\n    var top = getBorder(style, \"top\");\n    var right = getBorder(style, \"right\");\n    var bottom = getBorder(style, \"bottom\");\n    var left = getBorder(style, \"left\");\n\n    var rTL0 = getBorderRadius(style, \"top-left\");\n    var rTR0 = getBorderRadius(style, \"top-right\");\n    var rBL0 = getBorderRadius(style, \"bottom-left\");\n    var rBR0 = getBorderRadius(style, \"bottom-right\");\n\n    var dir = getPropertyValue(style, \"direction\");\n\n    var backgroundColor = getPropertyValue(style, \"background-color\");\n    backgroundColor = parseColor(backgroundColor);\n\n    var backgroundImage = parseBackgroundImage( getPropertyValue(style, \"background-image\") );\n    var backgroundRepeat = splitProperty( getPropertyValue(style, \"background-repeat\") );\n    var backgroundPosition = splitProperty( getPropertyValue(style, \"background-position\") );\n    var backgroundOrigin = splitProperty( getPropertyValue(style, \"background-origin\") );\n    var backgroundSize = splitProperty( getPropertyValue(style, \"background-size\") );\n\n    // IE shrinks the text with text-overflow: ellipsis,\n    // apparently because the returned bounding box for the range\n    // is limited to the visible area minus space for the dots,\n    // instead of being the full width of the text.\n    //\n    // https://github.com/telerik/kendo/issues/5232\n    // https://github.com/telerik/kendo-ui-core/issues/1868\n    //\n    // We have to test it here rather than in renderText because\n    // text-overflow: ellipsis could be set on a parent element (not\n    // necessarily the one containing the text); in this case,\n    // getComputedStyle(elementWithTheText) will return \"clip\", not\n    // \"ellipsis\" (which is probably a bug, but oh well...)\n    var textOverflow, saveTextOverflow;\n    if (microsoft) {\n        textOverflow = style.textOverflow;             // computed style\n        if (textOverflow == \"ellipsis\") {\n            saveTextOverflow = element.style.textOverflow; // own style.\n            element.style.textOverflow = \"clip\";\n        }\n    }\n\n    if (browser.msie && browser.version < 10) {\n        // IE9 hacks.  getPropertyValue won't return the correct\n        // value.  Sucks that we have to do it here, I'd prefer to\n        // move it in getPropertyValue, but we don't have the\n        // element.\n        backgroundPosition = splitProperty(element.currentStyle.backgroundPosition);\n    }\n\n    var innerbox = innerBox(element.getBoundingClientRect(), \"border-*-width\", element);\n\n    // CSS \"clip\" property - if present, replace the group with a\n    // new one which is clipped.  This must happen before drawing\n    // the borders and background.\n    (function(){\n        var clip = getPropertyValue(style, \"clip\");\n        var m = /^\\s*rect\\((.*)\\)\\s*$/.exec(clip);\n        if (m) {\n            var a = m[1].split(/[ ,]+/g);\n            var top = a[0] == \"auto\" ? innerbox.top : parseFloat(a[0]) + innerbox.top;\n            var right = a[1] == \"auto\" ? innerbox.right : parseFloat(a[1]) + innerbox.left;\n            var bottom = a[2] == \"auto\" ? innerbox.bottom : parseFloat(a[2]) + innerbox.top;\n            var left = a[3] == \"auto\" ? innerbox.left : parseFloat(a[3]) + innerbox.left;\n            var tmp = new Group();\n            var clipPath = new Path()\n                .moveTo(left, top)\n                .lineTo(right, top)\n                .lineTo(right, bottom)\n                .lineTo(left, bottom)\n                .close();\n            setClipping(tmp, clipPath);\n            group.append(tmp);\n            group = tmp;\n            updateClipbox(clipPath);\n        }\n    })();\n\n    var boxes, i, cells;\n    var display = getPropertyValue(style, \"display\");\n\n    if (display == \"table-row\") {\n        // because of rowspan/colspan, we shouldn't draw background of table row elements on the\n        // box given by its getBoundingClientRect, because if we do we risk overwritting a\n        // previously rendered cell.  https://github.com/telerik/kendo/issues/4881\n        boxes = [];\n        for (i = 0, cells = element.children; i < cells.length; ++i) {\n            boxes.push(cells[i].getBoundingClientRect());\n        }\n    } else {\n        boxes = element.getClientRects();\n        if (boxes.length == 1) {\n            // Workaround the missing borders in Chrome!  getClientRects() boxes contains values\n            // rounded to integer.  getBoundingClientRect() appears to work fine.  We still need\n            // getClientRects() to support cases where there are more boxes (continued inline\n            // elements that might have border/background).\n            boxes = [ element.getBoundingClientRect() ];\n        }\n    }\n\n    // This function workarounds another Chrome bug, where boxes returned for a table with\n    // border-collapse: collapse will overlap the table border.  Our rendering is not perfect in\n    // such case anyway, but with this is better than without it.\n    boxes = adjustBoxes(boxes);\n\n    for (i = 0; i < boxes.length; ++i) {\n        drawOneBox(boxes[i], i === 0, i == boxes.length - 1);\n    }\n\n    // Render links as separate groups.  We can't use boxes returned by element's getClientRects\n    // because if display type is \"inline\" (default for <a>), boxes will not include the height of\n    // images inside.  https://github.com/telerik/kendo-ui-core/issues/3359\n    if (element.tagName == \"A\" && element.href && !/^#?$/.test(element.getAttribute(\"href\"))) {\n        if (!nodeInfo._avoidLinks || !matches(element, nodeInfo._avoidLinks)) {\n            var r = document.createRange();\n            r.selectNodeContents(element);\n            slice(r.getClientRects()).forEach(function(box){\n                var g = new Group();\n                g._pdfLink = {\n                    url    : element.href,\n                    top    : box.top,\n                    right  : box.right,\n                    bottom : box.bottom,\n                    left   : box.left\n                };\n                group.append(g);\n            });\n        }\n    }\n\n    if (boxes.length > 0 && display == \"list-item\" && !element.getAttribute(\"kendo-no-bullet\")) {\n        drawBullet(boxes[0]);\n    }\n\n    // overflow: hidden/auto - if present, replace the group with\n    // a new one clipped by the inner box.\n    (function(){\n        function clipit() {\n            var clipPath = elementRoundBox(element, innerbox, \"padding\");\n            var tmp = new Group();\n            setClipping(tmp, clipPath);\n            group.append(tmp);\n            group = tmp;\n            updateClipbox(clipPath);\n        }\n        if (isFormField(element)) {\n            clipit();\n        } else if (/^(hidden|auto|scroll)/.test(getPropertyValue(style, \"overflow\"))) {\n            clipit();\n        } else if (/^(hidden|auto|scroll)/.test(getPropertyValue(style, \"overflow-x\"))) {\n            clipit();\n        } else if (/^(hidden|auto|scroll)/.test(getPropertyValue(style, \"overflow-y\"))) {\n            clipit();\n        }\n    })();\n\n    if (!maybeRenderWidget(element, group)) {\n        renderContents(element, group);\n    }\n\n    if (microsoft && textOverflow == \"ellipsis\") {\n        element.style.textOverflow = saveTextOverflow;\n    }\n\n    return group; // only utility functions after this line.\n\n    function adjustBoxes(boxes) {\n        if (/^td$/i.test(element.tagName)) {\n            var table = nodeInfo.table;\n            if (table && getPropertyValue(table.style, \"border-collapse\") == \"collapse\") {\n                var tableBorderLeft = getBorder(table.style, \"left\").width;\n                var tableBorderTop = getBorder(table.style, \"top\").width;\n                // check if we need to adjust\n                if (tableBorderLeft === 0 && tableBorderTop === 0) {\n                    return boxes; // nope\n                }\n                var tableBox = table.element.getBoundingClientRect();\n                var firstCell = table.element.rows[0].cells[0];\n                var firstCellBox = firstCell.getBoundingClientRect();\n                if (firstCellBox.top == tableBox.top || firstCellBox.left == tableBox.left) {\n                    return slice(boxes).map(function(box){\n                        return {\n                            left   : box.left + tableBorderLeft,\n                            top    : box.top + tableBorderTop,\n                            right  : box.right + tableBorderLeft,\n                            bottom : box.bottom + tableBorderTop,\n                            height : box.height,\n                            width  : box.width\n                        };\n                    });\n                }\n            }\n        }\n        return boxes;\n    }\n\n    // this function will be called to draw each border.  it\n    // draws starting at origin and the resulted path must be\n    // translated/rotated to be placed in the proper position.\n    //\n    // arguments are named as if it draws the top border:\n    //\n    //    - `len` the length of the edge\n    //    - `Wtop` the width of the edge (i.e. border-top-width)\n    //    - `Wleft` the width of the left edge (border-left-width)\n    //    - `Wright` the width of the right edge\n    //    - `rl` and `rl` -- the border radius on the left and right\n    //      (objects containing x and y, for horiz/vertical radius)\n    //    - `transform` -- transformation to apply\n    //\n    function drawEdge(color, len, Wtop, Wleft, Wright, rl, rr, transform) {\n        if (Wtop <= 0) {\n            return;\n        }\n\n        var path, edge = new Group();\n        setTransform(edge, transform);\n        group.append(edge);\n\n        sanitizeRadius(rl);\n        sanitizeRadius(rr);\n\n        // draw main border.  this is the area without the rounded corners\n        path = new Path({\n            fill: { color: color },\n            stroke: null\n        });\n        edge.append(path);\n        path.moveTo(rl.x ? Math.max(rl.x, Wleft) : 0, 0)\n            .lineTo(len - (rr.x ? Math.max(rr.x, Wright) : 0), 0)\n            .lineTo(len - Math.max(rr.x, Wright), Wtop)\n            .lineTo(Math.max(rl.x, Wleft), Wtop)\n            .close();\n\n        if (rl.x) {\n            drawRoundCorner(Wleft, rl, [ -1, 0, 0, 1, rl.x, 0 ]);\n        }\n\n        if (rr.x) {\n            drawRoundCorner(Wright, rr, [ 1, 0, 0, 1, len - rr.x, 0 ]);\n        }\n\n        // draws one round corner, starting at origin (needs to be\n        // translated/rotated to be placed properly).\n        function drawRoundCorner(Wright, r, transform) {\n            var angle = Math.PI/2 * Wright / (Wright + Wtop);\n\n            // not sanitizing this one, because negative values\n            // are useful to fill the box correctly.\n            var ri = {\n                x: r.x - Wright,\n                y: r.y - Wtop\n            };\n\n            var path = new Path({\n                fill: { color: color },\n                stroke: null\n            }).moveTo(0, 0);\n\n            setTransform(path, transform);\n\n            addArcToPath(path, 0, r.y, {\n                startAngle: -90,\n                endAngle: -radiansToDegrees(angle),\n                radiusX: r.x,\n                radiusY: r.y\n            });\n\n            if (ri.x > 0 && ri.y > 0) {\n                path.lineTo(ri.x * Math.cos(angle), r.y - ri.y * Math.sin(angle));\n                addArcToPath(path, 0, r.y, {\n                    startAngle: -radiansToDegrees(angle),\n                    endAngle: -90,\n                    radiusX: ri.x,\n                    radiusY: ri.y,\n                    anticlockwise: true\n                });\n            }\n            else if (ri.x > 0) {\n                path.lineTo(ri.x, Wtop)\n                    .lineTo(0, Wtop);\n            }\n            else {\n                path.lineTo(ri.x, Wtop)\n                    .lineTo(ri.x, 0);\n            }\n\n            edge.append(path.close());\n        }\n    }\n\n    function drawBackground(box) {\n        var background = new Group();\n        setClipping(background, roundBox(box, rTL0, rTR0, rBR0, rBL0));\n        group.append(background);\n\n        if (backgroundColor) {\n            var path = new Path({\n                fill: { color: backgroundColor.toCssRgba() },\n                stroke: null\n            });\n            path.moveTo(box.left, box.top)\n                .lineTo(box.right, box.top)\n                .lineTo(box.right, box.bottom)\n                .lineTo(box.left, box.bottom)\n                .close();\n            background.append(path);\n        }\n\n        for (var i = backgroundImage.length; --i >= 0;) {\n            drawOneBackground(\n                background, box,\n                backgroundImage[i],\n                backgroundRepeat[i % backgroundRepeat.length],\n                backgroundPosition[i % backgroundPosition.length],\n                backgroundOrigin[i % backgroundOrigin.length],\n                backgroundSize[i % backgroundSize.length]\n            );\n        }\n    }\n\n    function drawOneBackground(group, box, background, backgroundRepeat, backgroundPosition, backgroundOrigin, backgroundSize) {\n        if (!background || (background == \"none\")) {\n            return;\n        }\n\n        if (background.type == \"url\") {\n            var img = IMAGE_CACHE[background.url];\n            if (img && img.width > 0 && img.height > 0) {\n                drawBackgroundImage(group, box, img.width, img.height, function(group, rect){\n                    group.append(new Image(background.url, rect));\n                });\n            }\n        } else if (background.type == \"linear\") {\n            drawBackgroundImage(group, box, box.width, box.height, gradientRenderer(background));\n        } else {\n            return;\n        }\n\n        function drawBackgroundImage(group, box, img_width, img_height, renderBG) {\n            var aspect_ratio = img_width / img_height, f;\n\n            // for background-origin: border-box the box is already appropriate\n            var orgBox = box;\n            if (backgroundOrigin == \"content-box\") {\n                orgBox = innerBox(orgBox, \"border-*-width\", element);\n                orgBox = innerBox(orgBox, \"padding-*\", element);\n            } else if (backgroundOrigin == \"padding-box\") {\n                orgBox = innerBox(orgBox, \"border-*-width\", element);\n            }\n\n            if (!/^\\s*auto(\\s+auto)?\\s*$/.test(backgroundSize)) {\n                if (backgroundSize == \"contain\") {\n                    f = Math.min(orgBox.width / img_width,\n                                 orgBox.height / img_height);\n                    img_width *= f;\n                    img_height *= f;\n                }\n                else if (backgroundSize == \"cover\") {\n                    f = Math.max(orgBox.width / img_width,\n                                 orgBox.height / img_height);\n                    img_width *= f;\n                    img_height *= f;\n                }\n                else {\n                    var size = backgroundSize.split(/\\s+/g);\n                    // compute width\n                    if (/%$/.test(size[0])) {\n                        img_width = orgBox.width * parseFloat(size[0]) / 100;\n                    } else {\n                        img_width = parseFloat(size[0]);\n                    }\n                    // compute height\n                    if (size.length == 1 || size[1] == \"auto\") {\n                        img_height = img_width / aspect_ratio;\n                    } else if (/%$/.test(size[1])) {\n                        img_height = orgBox.height * parseFloat(size[1]) / 100;\n                    } else {\n                        img_height = parseFloat(size[1]);\n                    }\n                }\n            }\n\n            var pos = String(backgroundPosition);\n\n            // IE sometimes reports single-word positions\n            // https://github.com/telerik/kendo-ui-core/issues/2786\n            //\n            // it seems to switch to percentages when the horizontal\n            // position is not \"center\", therefore we don't handle\n            // multi-word cases here.  All other browsers return\n            // percentages or pixels instead of keywords.  At least\n            // for now...\n            switch (pos) {\n              case \"bottom\" : pos = \"50% 100%\"; break;\n              case \"top\"    : pos = \"50% 0\"; break;\n              case \"left\"   : pos = \"0 50%\"; break;\n              case \"right\"  : pos = \"100% 50%\"; break;\n              case \"center\" : pos = \"50% 50%\"; break;\n            }\n\n            pos = pos.split(/\\s+/);\n            if (pos.length == 1) {\n                pos[1] = \"50%\";\n            }\n\n            if (/%$/.test(pos[0])) {\n                pos[0] = parseFloat(pos[0]) / 100 * (orgBox.width - img_width);\n            } else {\n                pos[0] = parseFloat(pos[0]);\n            }\n            if (/%$/.test(pos[1])) {\n                pos[1] = parseFloat(pos[1]) / 100 * (orgBox.height - img_height);\n            } else {\n                pos[1] = parseFloat(pos[1]);\n            }\n\n            var rect = new geo.Rect([ orgBox.left + pos[0], orgBox.top + pos[1] ], [ img_width, img_height ]);\n\n            // XXX: background-repeat could be implemented more\n            //      efficiently as a fill pattern (at least for PDF\n            //      output, probably SVG too).\n\n            function rewX() {\n                while (rect.origin.x > box.left) {\n                    rect.origin.x -= img_width;\n                }\n            }\n\n            function rewY() {\n                while (rect.origin.y > box.top) {\n                    rect.origin.y -= img_height;\n                }\n            }\n\n            function repeatX() {\n                while (rect.origin.x < box.right) {\n                    renderBG(group, rect.clone());\n                    rect.origin.x += img_width;\n                }\n            }\n\n            if (backgroundRepeat == \"no-repeat\") {\n                renderBG(group, rect);\n            }\n            else if (backgroundRepeat == \"repeat-x\") {\n                rewX();\n                repeatX();\n            }\n            else if (backgroundRepeat == \"repeat-y\") {\n                rewY();\n                while (rect.origin.y < box.bottom) {\n                    renderBG(group, rect.clone());\n                    rect.origin.y += img_height;\n                }\n            }\n            else if (backgroundRepeat == \"repeat\") {\n                rewX();\n                rewY();\n                var origin = rect.origin.clone();\n                while (rect.origin.y < box.bottom) {\n                    rect.origin.x = origin.x;\n                    repeatX();\n                    rect.origin.y += img_height;\n                }\n            }\n        }\n    }\n\n    function drawBullet() {\n        var listStyleType = getPropertyValue(style, \"list-style-type\");\n        if (listStyleType == \"none\") {\n            return;\n        }\n        var listStylePosition = getPropertyValue(style, \"list-style-position\");\n\n        function _drawBullet(f) {\n            saveStyle(element, function(){\n                element.style.position = \"relative\";\n                var bullet = element.ownerDocument.createElement(KENDO_PSEUDO_ELEMENT);\n                bullet.style.position = \"absolute\";\n                bullet.style.boxSizing = \"border-box\";\n                if (listStylePosition == \"outside\") {\n                    bullet.style.width = \"6em\";\n                    bullet.style.left = \"-6.8em\";\n                    bullet.style.textAlign = \"right\";\n                } else {\n                    bullet.style.left = \"0px\";\n                }\n                f(bullet);\n                element.insertBefore(bullet, element.firstChild);\n                renderElement(bullet, group);\n                element.removeChild(bullet);\n            });\n        }\n\n        function elementIndex(f) {\n            var a = element.parentNode.children;\n            var k = element.getAttribute(\"kendo-split-index\");\n            if (k != null) {\n                return f(k|0, a.length);\n            }\n            for (var i = 0; i < a.length; ++i) {\n                if (a[i] === element) {\n                    return f(i, a.length);\n                }\n            }\n        }\n\n        switch (listStyleType) {\n          case \"circle\":\n          case \"disc\":\n          case \"square\":\n            _drawBullet(function(bullet){\n                // XXX: the science behind these values is called \"trial and error\".\n                bullet.style.fontSize = \"60%\";\n                bullet.style.lineHeight = \"200%\";\n                bullet.style.paddingRight = \"0.5em\";\n                bullet.style.fontFamily = \"DejaVu Serif\";\n                bullet.innerHTML = {\n                    \"disc\"   : \"\\u25cf\",\n                    \"circle\" : \"\\u25ef\",\n                    \"square\" : \"\\u25a0\"\n                }[listStyleType];\n            });\n            break;\n\n          case \"decimal\":\n          case \"decimal-leading-zero\":\n            _drawBullet(function(bullet){\n                elementIndex(function(idx){\n                    ++idx;\n                    if (listStyleType == \"decimal-leading-zero\" && idx < 10) {\n                        idx = \"0\" + idx;\n                    }\n                    bullet.innerHTML = idx + \".\";\n                });\n            });\n            break;\n\n          case \"lower-roman\":\n          case \"upper-roman\":\n            _drawBullet(function(bullet){\n                elementIndex(function(idx){\n                    idx = arabicToRoman(idx + 1);\n                    if (listStyleType == \"upper-roman\") {\n                        idx = idx.toUpperCase();\n                    }\n                    bullet.innerHTML = idx + \".\";\n                });\n            });\n            break;\n\n          case \"lower-latin\":\n          case \"lower-alpha\":\n          case \"upper-latin\":\n          case \"upper-alpha\":\n            _drawBullet(function(bullet){\n                elementIndex(function(idx){\n                    idx = alphaNumeral(idx);\n                    if (/^upper/i.test(listStyleType)) {\n                        idx = idx.toUpperCase();\n                    }\n                    bullet.innerHTML = idx + \".\";\n                });\n            });\n            break;\n        }\n    }\n\n    // draws a single border box\n    function drawOneBox(box, isFirst, isLast) {\n        if (box.width === 0 || box.height === 0) {\n            return;\n        }\n\n        drawBackground(box);\n\n        var shouldDrawLeft = (left.width > 0 && ((isFirst && dir == \"ltr\") || (isLast && dir == \"rtl\")));\n        var shouldDrawRight = (right.width > 0 && ((isLast && dir == \"ltr\") || (isFirst && dir == \"rtl\")));\n\n        // The most general case is that the 4 borders have different widths and border\n        // radiuses.  The way that is handled is by drawing 3 Paths for each border: the\n        // straight line, and two round corners which represent half of the entire rounded\n        // corner.  To simplify code those shapes are drawed at origin (by the drawEdge\n        // function), then translated/rotated into the right position.\n        //\n        // However, this leads to poor results due to rounding in the simpler cases where\n        // borders are straight lines.  Therefore we handle a few such cases separately with\n        // straight lines. C^wC^wC^w -- nope, scratch that.  poor rendering was because of a bug\n        // in Chrome (getClientRects() returns rounded integer values rather than exact floats.\n        // web dev is still a ghetto.)\n\n        // first, just in case there is no border...\n        if (top.width === 0 && left.width === 0 && right.width === 0 && bottom.width === 0) {\n            return;\n        }\n\n        // START paint borders\n        // if all borders have equal colors...\n        if (top.color == right.color && top.color == bottom.color && top.color == left.color) {\n\n            // if same widths too, we can draw the whole border by stroking a single path.\n            if (top.width == right.width && top.width == bottom.width && top.width == left.width)\n            {\n                if (shouldDrawLeft && shouldDrawRight) {\n                    // reduce box by half the border width, so we can draw it by stroking.\n                    box = innerBox(box, top.width/2);\n\n                    // adjust the border radiuses, again by top.width/2, and make the path element.\n                    var path = elementRoundBox(element, box, top.width/2);\n                    path.options.stroke = {\n                        color: top.color,\n                        width: top.width\n                    };\n                    group.append(path);\n                    return;\n                }\n            }\n        }\n\n        // if border radiuses are zero and widths are at most one pixel, we can again use simple\n        // paths.\n        if (rTL0.x === 0 && rTR0.x === 0 && rBR0.x === 0 && rBL0.x === 0) {\n            // alright, 1.9px will do as well.  the difference in color blending should not be\n            // noticeable.\n            if (top.width < 2 && left.width < 2 && right.width < 2 && bottom.width < 2) {\n                // top border\n                if (top.width > 0) {\n                    group.append(\n                        new Path({\n                            stroke: { width: top.width, color: top.color }\n                        })\n                            .moveTo(box.left, box.top + top.width/2)\n                            .lineTo(box.right, box.top + top.width/2)\n                    );\n                }\n\n                // bottom border\n                if (bottom.width > 0) {\n                    group.append(\n                        new Path({\n                            stroke: { width: bottom.width, color: bottom.color }\n                        })\n                            .moveTo(box.left, box.bottom - bottom.width/2)\n                            .lineTo(box.right, box.bottom - bottom.width/2)\n                    );\n                }\n\n                // left border\n                if (shouldDrawLeft) {\n                    group.append(\n                        new Path({\n                            stroke: { width: left.width, color: left.color }\n                        })\n                            .moveTo(box.left + left.width/2, box.top)\n                            .lineTo(box.left + left.width/2, box.bottom)\n                    );\n                }\n\n                // right border\n                if (shouldDrawRight) {\n                    group.append(\n                        new Path({\n                            stroke: { width: right.width, color: right.color }\n                        })\n                            .moveTo(box.right - right.width/2, box.top)\n                            .lineTo(box.right - right.width/2, box.bottom)\n                    );\n                }\n\n                return;\n            }\n        }\n        // END paint borders\n\n        var tmp = adjustBorderRadiusForBox(box, rTL0, rTR0, rBR0, rBL0);\n        var rTL = tmp.tl;\n        var rTR = tmp.tr;\n        var rBR = tmp.br;\n        var rBL = tmp.bl;\n\n        // top border\n        drawEdge(top.color,\n                 box.width, top.width, left.width, right.width,\n                 rTL, rTR,\n                 [ 1, 0, 0, 1, box.left, box.top ]);\n\n        // bottom border\n        drawEdge(bottom.color,\n                 box.width, bottom.width, right.width, left.width,\n                 rBR, rBL,\n                 [ -1, 0, 0, -1, box.right, box.bottom ]);\n\n        // for left/right borders we need to invert the border-radiuses\n        function inv(p) {\n            return { x: p.y, y: p.x };\n        }\n\n        // left border\n        drawEdge(left.color,\n                 box.height, left.width, bottom.width, top.width,\n                 inv(rBL), inv(rTL),\n                 [ 0, -1, 1, 0, box.left, box.bottom ]);\n\n        // right border\n        drawEdge(right.color,\n                 box.height, right.width, top.width, bottom.width,\n                 inv(rTR), inv(rBR),\n                 [ 0, 1, -1, 0, box.right, box.top ]);\n    }\n}\n\nfunction gradientRenderer(gradient) {\n    return function(group, rect) {\n        var width = rect.width(), height = rect.height();\n\n        switch (gradient.type) {\n          case \"linear\":\n\n            // figure out the angle.\n            var angle = gradient.angle != null ? gradient.angle : Math.PI;\n            switch (gradient.to) {\n              case \"top\":\n                angle = 0;\n                break;\n              case \"left\":\n                angle = -Math.PI / 2;\n                break;\n              case \"bottom\":\n                angle = Math.PI;\n                break;\n              case \"right\":\n                angle = Math.PI / 2;\n                break;\n              case \"top left\": case \"left top\":\n                angle = -Math.atan2(height, width);\n                break;\n              case \"top right\": case \"right top\":\n                angle = Math.atan2(height, width);\n                break;\n              case \"bottom left\": case \"left bottom\":\n                angle = Math.PI + Math.atan2(height, width);\n                break;\n              case \"bottom right\": case \"right bottom\":\n                angle = Math.PI - Math.atan2(height, width);\n                break;\n            }\n\n            if (gradient.reverse) {\n                angle -= Math.PI;\n            }\n\n            // limit the angle between 0..2PI\n            angle %= 2 * Math.PI;\n            if (angle < 0) {\n                angle += 2 * Math.PI;\n            }\n\n            // compute gradient's start/end points.  here len is the length of the gradient line\n            // and x,y is the end point relative to the center of the rectangle in conventional\n            // (math) axis direction.\n\n            // this is the original (unscaled) length of the gradient line.  needed to deal with\n            // absolutely positioned color stops.  formula from the CSS spec:\n            // http://dev.w3.org/csswg/css-images-3/#linear-gradient-syntax\n            var pxlen = Math.abs(width * Math.sin(angle)) + Math.abs(height * Math.cos(angle));\n\n            // The math below is pretty simple, but it took a while to figure out.  We compute x\n            // and y, the *end* of the gradient line.  However, we want to transform them into\n            // element-based coordinates (SVG's gradientUnits=\"objectBoundingBox\").  That means,\n            // x=0 is the left edge, x=1 is the right edge, y=0 is the top edge and y=1 is the\n            // bottom edge.\n            //\n            // A naive approach would use the original angle for these calculations.  Say we'd\n            // like to draw a gradient angled at 45deg in a 100x400 box.  When we use\n            // objectBoundingBox, the renderer will draw it in a 1x1 *square* box, and then\n            // scale that to the desired dimensions.  The 45deg angle will look more like 70deg\n            // after scaling.  SVG (http://www.w3.org/TR/SVG/pservers.html#LinearGradients) says\n            // the following:\n            //\n            //     When gradientUnits=\"objectBoundingBox\" and 'gradientTransform' is the\n            //     identity matrix, the normal of the linear gradient is perpendicular to the\n            //     gradient vector in object bounding box space (i.e., the abstract coordinate\n            //     system where (0,0) is at the top/left of the object bounding box and (1,1) is\n            //     at the bottom/right of the object bounding box). When the object's bounding\n            //     box is not square, the gradient normal which is initially perpendicular to\n            //     the gradient vector within object bounding box space may render\n            //     non-perpendicular relative to the gradient vector in user space. If the\n            //     gradient vector is parallel to one of the axes of the bounding box, the\n            //     gradient normal will remain perpendicular. This transformation is due to\n            //     application of the non-uniform scaling transformation from bounding box space\n            //     to user space.\n            //\n            // which is an extremely long and confusing way to tell what I just said above.\n            //\n            // For this reason we need to apply the reverse scaling to the original angle, so\n            // that when it'll finally be rendered it'll actually be at the desired slope.  Now\n            // I'll let you figure out the math yourself.\n\n            var scaledAngle = Math.atan(width * Math.tan(angle) / height);\n            var sin = Math.sin(scaledAngle), cos = Math.cos(scaledAngle);\n            var len = Math.abs(sin) + Math.abs(cos);\n            var x = len/2 * sin;\n            var y = len/2 * cos;\n\n            // Because of the arctangent, our scaledAngle ends up between -PI/2..PI/2, possibly\n            // losing the intended direction of the gradient.  The following fixes it.\n            if (angle > Math.PI/2 && angle <= 3*Math.PI/2) {\n                x = -x;\n                y = -y;\n            }\n\n            // compute the color stops.\n            var implicit = [], right = 0;\n            var stops = gradient.stops.map(function(s, i){\n                var offset = s.percent;\n                if (offset) {\n                    offset = parseFloat(offset) / 100;\n                } else if (s.length) {\n                    offset = parseFloat(s.length) / pxlen;\n                } else if (i === 0) {\n                    offset = 0;\n                } else if (i == gradient.stops.length - 1) {\n                    offset = 1;\n                }\n                var stop = {\n                    color: s.color.toCssRgba(),\n                    offset: offset\n                };\n                if (offset != null) {\n                    right = offset;\n                    // fix implicit offsets\n                    implicit.forEach(function(s, i){\n                        var stop = s.stop;\n                        stop.offset = s.left + (right - s.left) * (i + 1) / (implicit.length + 1);\n                    });\n                    implicit = [];\n                } else {\n                    implicit.push({ left: right, stop: stop });\n                }\n                return stop;\n            });\n\n            var start = [ 0.5 - x, 0.5 + y ];\n            var end = [ 0.5 + x, 0.5 - y ];\n\n            // finally, draw it.\n            group.append(\n                Path.fromRect(rect)\n                    .stroke(null)\n                    .fill(new LinearGradient({\n                        start     : start,\n                        end       : end,\n                        stops     : stops,\n                        userSpace : false\n                    }))\n            );\n            break;\n          case \"radial\":\n            // XXX:\n            if (window.console && window.console.log) {\n                window.console.log(\"Radial gradients are not yet supported in HTML renderer\");\n            }\n            break;\n        }\n    };\n}\n\nfunction maybeRenderWidget(element, group) {\n    var visual;\n\n    if (element._kendoExportVisual) {\n        visual = element._kendoExportVisual();\n    } else if (window.kendo && window.kendo.jQuery && element.getAttribute(window.kendo.attr(\"role\"))) {\n        var widget = window.kendo.widgetInstance(window.kendo.jQuery(element));\n        if (widget && (widget.exportDOMVisual || widget.exportVisual)) {\n            if (widget.exportDOMVisual) {\n                visual = widget.exportDOMVisual();\n            } else {\n                visual = widget.exportVisual();\n            }\n        }\n    }\n\n    if (!visual) {\n        return false;\n    }\n\n    var wrap = new Group();\n    wrap.children.push(visual);\n\n    var bbox = element.getBoundingClientRect();\n    wrap.transform(geo.transform().translate(bbox.left, bbox.top));\n\n    group.append(wrap);\n\n    return true;\n}\n\nfunction renderImage(element, url, group) {\n    var box = getContentBox(element);\n    var rect = new geo.Rect([ box.left, box.top ], [ box.width, box.height ]);\n    var image = new Image(url, rect);\n    setClipping(image, elementRoundBox(element, box, \"content\"));\n    group.append(image);\n}\n\nfunction zIndexSort(a, b) {\n    var sa = getComputedStyle(a);\n    var sb = getComputedStyle(b);\n    var za = parseFloat(getPropertyValue(sa, \"z-index\"));\n    var zb = parseFloat(getPropertyValue(sb, \"z-index\"));\n    var pa = getPropertyValue(sa, \"position\");\n    var pb = getPropertyValue(sb, \"position\");\n    if (isNaN(za) && isNaN(zb)) {\n        if ((/static|absolute/.test(pa)) && (/static|absolute/.test(pb))) {\n            return 0;\n        }\n        if (pa == \"static\") {\n            return -1;\n        }\n        if (pb == \"static\") {\n            return 1;\n        }\n        return 0;\n    }\n    if (isNaN(za)) {\n        return zb === 0 ? 0 : zb > 0 ? -1 : 1;\n    }\n    if (isNaN(zb)) {\n        return za === 0 ? 0 : za > 0 ? 1 : -1;\n    }\n    return parseFloat(za) - parseFloat(zb);\n}\n\nfunction isFormField(element) {\n    return /^(?:textarea|select|input)$/i.test(element.tagName);\n}\n\nfunction getSelectedOption(element) {\n    if (element.selectedOptions && element.selectedOptions.length > 0) {\n        return element.selectedOptions[0];\n    }\n    return element.options[element.selectedIndex];\n}\n\nfunction renderCheckbox(element, group) {\n    var style = getComputedStyle(element);\n    var color = getPropertyValue(style, \"color\");\n    var box = element.getBoundingClientRect();\n    if (element.type == \"checkbox\") {\n        group.append(\n            Path.fromRect(\n                new geo.Rect([ box.left+1, box.top+1 ],\n                             [ box.width-2, box.height-2 ])\n            ).stroke(color, 1)\n        );\n        if (element.checked) {\n            // fill a rectangle inside?  looks kinda ugly.\n            // group.append(\n            //     Path.fromRect(\n            //         new geo.Rect([ box.left+4, box.top+4 ],\n            //                      [ box.width-8, box.height-8])\n            //     ).fill(color).stroke(null)\n            // );\n\n            // let's draw a checkmark instead.  artistic, eh?\n            group.append(\n                new Path()\n                    .stroke(color, 1.2)\n                    .moveTo(box.left + 0.22 * box.width,\n                            box.top + 0.55 * box.height)\n                    .lineTo(box.left + 0.45 * box.width,\n                            box.top + 0.75 * box.height)\n                    .lineTo(box.left + 0.78 * box.width,\n                            box.top + 0.22 * box.width)\n            );\n        }\n    } else {\n        group.append(\n            new Circle(\n                new geo.Circle([\n                    (box.left + box.right) / 2,\n                    (box.top + box.bottom) / 2\n                ], Math.min(box.width-2, box.height-2) / 2)\n            ).stroke(color, 1)\n        );\n        if (element.checked) {\n            group.append(\n                new Circle(\n                    new geo.Circle([\n                        (box.left + box.right) / 2,\n                        (box.top + box.bottom) / 2\n                    ], Math.min(box.width-8, box.height-8) / 2)\n                ).fill(color).stroke(null)\n            );\n        }\n    }\n}\n\nfunction renderFormField(element, group) {\n    var tag = element.tagName.toLowerCase();\n    if (tag == \"input\" && (element.type == \"checkbox\" || element.type == \"radio\")) {\n        return renderCheckbox(element, group);\n    }\n    var p = element.parentNode;\n    var doc = element.ownerDocument;\n    var el = doc.createElement(KENDO_PSEUDO_ELEMENT);\n    var option;\n    el.style.cssText = getCssText(getComputedStyle(element));\n    if (tag == \"input\") {\n        el.style.whiteSpace = \"pre\";\n    }\n    if (tag == \"select\" || tag == \"textarea\") {\n        el.style.overflow = \"auto\";\n    }\n    if (tag == \"select\") {\n        if (element.multiple) {\n            for (var i = 0; i < element.options.length; ++i) {\n                option = doc.createElement(KENDO_PSEUDO_ELEMENT);\n                option.style.cssText = getCssText(getComputedStyle(element.options[i]));\n                option.style.display = \"block\"; // IE9 messes up without this\n                option.textContent = element.options[i].textContent;\n                el.appendChild(option);\n            }\n        } else {\n            option = getSelectedOption(element);\n            if (option) {\n                el.textContent = option.textContent;\n            }\n        }\n    } else {\n        el.textContent = element.value;\n    }\n    p.insertBefore(el, element);\n    el.scrollLeft = element.scrollLeft;\n    el.scrollTop = element.scrollTop;\n\n    // must temporarily hide the original element, otherwise it\n    // may affect layout of the fake element we want to render.\n    element.style.display = \"none\";\n\n    renderContents(el, group);\n    element.style.display = \"\";\n    p.removeChild(el);\n}\n\nfunction serializeSVG(element) {\n    var serializer = new window.XMLSerializer();\n    var xml = serializer.serializeToString(element);\n\n    if (browser.mozilla && !(element.getAttribute(\"width\") && element.getAttribute(\"height\"))) {\n        var doc = new window.DOMParser().parseFromString(xml, \"image/svg+xml\");\n        var svg = doc.documentElement;\n        var box = getContentBox(element);\n        svg.setAttribute(\"width\", box.width);\n        svg.setAttribute(\"height\", box.height);\n        xml = serializer.serializeToString(svg);\n    }\n\n    return xml;\n}\n\nfunction renderContents(element, group) {\n    if (nodeInfo._stackingContext.element === element) {\n        // the group that was set in pushNodeInfo might have\n        // changed due to clipping/transforms, update it here.\n        nodeInfo._stackingContext.group = group;\n    }\n    switch (element.tagName.toLowerCase()) {\n      case \"img\":\n        renderImage(element, element.src, group);\n        break;\n\n      case \"svg\":\n        var xml = serializeSVG(element);\n        var dataURL = \"data:image/svg+xml;base64,\" + (encodeBase64(xml));\n        renderImage(element, dataURL, group);\n        break;\n\n      case \"canvas\":\n        try {\n            renderImage(element, element.toDataURL(\"image/png\"), group);\n        } catch (ex) {\n            // tainted; can't draw it, ignore.\n        }\n        break;\n\n      case \"textarea\":\n      case \"input\":\n      case \"select\":\n        renderFormField(element, group);\n        break;\n\n      default:\n        var children = [], floats = [], positioned = [];\n        for (var i = element.firstChild; i; i = i.nextSibling) {\n            switch (i.nodeType) {\n              case 3:         // Text\n                if (/\\S/.test(i.data)) {\n                    renderText(element, i, group);\n                }\n                break;\n              case 1:         // Element\n                var style = getComputedStyle(i);\n                var floating = getPropertyValue(style, \"float\");\n                var position = getPropertyValue(style, \"position\");\n                if (position != \"static\") {\n                    positioned.push(i);\n                }\n                else if (floating != \"none\") {\n                    floats.push(i);\n                } else {\n                    children.push(i);\n                }\n                break;\n            }\n        }\n\n        mergeSort(children, zIndexSort).forEach(function(el){ renderElement(el, group); });\n        mergeSort(floats, zIndexSort).forEach(function(el){ renderElement(el, group); });\n        mergeSort(positioned, zIndexSort).forEach(function(el){ renderElement(el, group); });\n    }\n}\n\nfunction renderText(element, node, group) {\n    if (emptyClipbox()) {\n        return;\n    }\n    var style = getComputedStyle(element);\n\n    if (parseFloat(getPropertyValue(style, \"text-indent\")) < -500) {\n        // assume it should not be displayed.  the slider's\n        // draggable handle displays a Drag text for some reason,\n        // having text-indent: -3333px.\n        return;\n    }\n\n    var text = node.data;\n    var start = 0;\n    var end = text.search(/\\S\\s*$/) + 1;\n\n    if (!end) {\n        return; // whitespace-only node\n    }\n\n    var fontSize = getPropertyValue(style, \"font-size\");\n    var lineHeight = getPropertyValue(style, \"line-height\");\n\n    // simply getPropertyValue(\"font\") doesn't work in Firefox :-\\\n    var font = [\n        getPropertyValue(style, \"font-style\"),\n        getPropertyValue(style, \"font-variant\"),\n        getPropertyValue(style, \"font-weight\"),\n        fontSize, // no need for line height here; it breaks layout in FF\n        getPropertyValue(style, \"font-family\")\n    ].join(\" \");\n\n    fontSize = parseFloat(fontSize);\n    lineHeight = parseFloat(lineHeight);\n\n    if (fontSize === 0) {\n        return;\n    }\n\n    var color = getPropertyValue(style, \"color\");\n    var range = element.ownerDocument.createRange();\n    var align = getPropertyValue(style, \"text-align\");\n    var isJustified = align == \"justify\";\n    var columnCount = getPropertyValue(style, \"column-count\", 1);\n    var whiteSpace = getPropertyValue(style, \"white-space\");\n    var textTransform = getPropertyValue(style, \"text-transform\");\n\n    // A line of 500px, with a font of 12px, contains an average of 80 characters, but since we\n    // err, we'd like to guess a bigger number rather than a smaller one.  Multiplying by 5\n    // seems to be a good option.\n    var estimateLineLength = element.getBoundingClientRect().width / fontSize * 5;\n    if (estimateLineLength === 0) {\n        estimateLineLength = 500;\n    }\n\n    // we'll maintain this so we can workaround bugs in Chrome's Range.getClientRects\n    // https://github.com/telerik/kendo/issues/5740\n    var prevLineBottom = null;\n\n    var underline = nodeInfo[\"underline\"];\n    var lineThrough = nodeInfo[\"line-through\"];\n    var overline = nodeInfo[\"overline\"];\n    var hasDecoration = underline || lineThrough || overline;\n\n    // doChunk returns true when all text has been rendered\n    while (!doChunk()) {}\n\n    if (hasDecoration) {\n        range.selectNode(node);\n        slice(range.getClientRects()).forEach(decorate);\n    }\n\n    return;                 // only function declarations after this line\n\n    function actuallyGetRangeBoundingRect(range) {\n        // XXX: to be revised when this Chrome bug is fixed:\n        // https://bugs.chromium.org/p/chromium/issues/detail?id=612459\n        if (microsoft || browser.chrome || browser.safari) {\n            // Workaround browser bugs: IE and Chrome would sometimes\n            // return 0 or 1-width rectangles before or after the main\n            // one.  https://github.com/telerik/kendo/issues/4674\n\n            // Actually Chrome 50 got worse, since the rectangles can now have the width of a\n            // full character, making it hard to tell whether it's a bogus rectangle or valid\n            // selection location.  The workaround is to ignore rectangles that fall on the\n            // previous line.  https://github.com/telerik/kendo/issues/5740\n            var rectangles = range.getClientRects(), box = {\n                top    :  Infinity,\n                right  : -Infinity,\n                bottom : -Infinity,\n                left   :  Infinity\n            }, done = false;\n            for (var i = 0; i < rectangles.length; ++i) {\n                var b = rectangles[i];\n                if (b.width <= 1 || b.bottom === prevLineBottom) {\n                    continue;   // bogus rectangle\n                }\n                box.left   = Math.min(b.left   , box.left);\n                box.top    = Math.min(b.top    , box.top);\n                box.right  = Math.max(b.right  , box.right);\n                box.bottom = Math.max(b.bottom , box.bottom);\n                done = true;\n            }\n            if (!done) {\n                return range.getBoundingClientRect();\n            }\n            box.width = box.right - box.left;\n            box.height = box.bottom - box.top;\n            return box;\n        }\n        return range.getBoundingClientRect();\n    }\n\n    // Render a chunk of text, typically one line (but for justified text we render each word as\n    // a separate Text object, because spacing is variable).  Returns true when it finished the\n    // current node.  After each chunk it updates `start` to just after the last rendered\n    // character.\n    function doChunk() {\n        var origStart = start;\n        var box, pos = text.substr(start).search(/\\S/);\n        start += pos;\n        if (pos < 0 || start >= end) {\n            return true;\n        }\n\n        // Select a single character to determine the height of a line of text.  The box.bottom\n        // will be essential for us to figure out where the next line begins.\n        range.setStart(node, start);\n        range.setEnd(node, start + 1);\n        box = actuallyGetRangeBoundingRect(range);\n\n        // for justified text we must split at each space, because space has variable width.\n        var found = false;\n        if (isJustified || columnCount > 1) {\n            pos = text.substr(start).search(/\\s/);\n            if (pos >= 0) {\n                // we can only split there if it's on the same line, otherwise we'll fall back\n                // to the default mechanism (see findEOL below).\n                range.setEnd(node, start + pos);\n                var r = actuallyGetRangeBoundingRect(range);\n                if (r.bottom == box.bottom) {\n                    box = r;\n                    found = true;\n                    start += pos;\n                }\n            }\n        }\n\n        if (!found) {\n            // This code does three things: (1) it selects one line of text in `range`, (2) it\n            // leaves the bounding rect of that line in `box` and (3) it returns the position\n            // just after the EOL.  We know where the line starts (`start`) but we don't know\n            // where it ends.  To figure this out, we select a piece of text and look at the\n            // bottom of the bounding box.  If it changes, we have more than one line selected\n            // and should retry with a smaller selection.\n            //\n            // To speed things up, we first try to select all text in the node (`start` ->\n            // `end`).  If there's more than one line there, then select only half of it.  And\n            // so on.  When we find a value for `end` that fits in one line, we try increasing\n            // it (also in halves) until we get to the next line.  The algorithm stops when the\n            // right side of the bounding box does not change.\n            //\n            // One more thing to note is that everything happens in a single Text DOM node.\n            // There's no other tags inside it, therefore the left/top coordinates of the\n            // bounding box will not change.\n            pos = (function findEOL(min, eol, max){\n                range.setEnd(node, eol);\n                var r = actuallyGetRangeBoundingRect(range);\n                if (r.bottom != box.bottom && min < eol) {\n                    return findEOL(min, (min + eol) >> 1, eol);\n                } else if (r.right != box.right) {\n                    box = r;\n                    if (eol < max) {\n                        return findEOL(eol, (eol + max) >> 1, max);\n                    } else {\n                        return eol;\n                    }\n                } else {\n                    return eol;\n                }\n            })(start, Math.min(end, start + estimateLineLength), end);\n\n            if (pos == start) {\n                // if EOL is at the start, then no more text fits on this line.  Skip the\n                // remainder of this node entirely to avoid a stack overflow.\n                return true;\n            }\n            start = pos;\n\n            pos = range.toString().search(/\\s+$/);\n            if (pos === 0) {\n                return false; // whitespace only; we should not get here.\n            }\n            if (pos > 0) {\n                // eliminate trailing whitespace\n                range.setEnd(node, range.startOffset + pos);\n                box = actuallyGetRangeBoundingRect(range);\n            }\n        }\n\n        // another workaround for IE: if we rely on getBoundingClientRect() we'll overlap with the bullet for LI\n        // elements.  Calling getClientRects() and using the *first* rect appears to give us the correct location.\n        // Note: not to be used in Chrome as it randomly returns a zero-width rectangle from the previous line.\n        if (microsoft) {\n            box = range.getClientRects()[0];\n        }\n\n        var str = range.toString();\n        if (!/^(?:pre|pre-wrap)$/i.test(whiteSpace)) {\n            // node with non-significant space -- collapse whitespace.\n            str = str.replace(/\\s+/g, \" \");\n        }\n        else if (/\\t/.test(str)) {\n            // with significant whitespace we need to do something about literal TAB characters.\n            // There's no TAB glyph in a font so they would be rendered in PDF as an empty box,\n            // and the whole text will stretch to fill the original width.  The core PDF lib\n            // does not have sufficient context to deal with it.\n\n            // calculate the starting column here, since we initially discarded any whitespace.\n            var cc = 0;\n            for (pos = origStart; pos < range.startOffset; ++pos) {\n                var code = text.charCodeAt(pos);\n                if (code == 9) {\n                    // when we meet a TAB we must round up to the next tab stop.\n                    // in all browsers TABs seem to be 8 characters.\n                    cc += 8 - cc % 8;\n                } else if (code == 10 || code == 13) {\n                    // just in case we meet a newline we must restart.\n                    cc = 0;\n                } else {\n                    // ordinary character --> advance one column\n                    cc++;\n                }\n            }\n\n            // based on starting column, replace any TAB characters in the string we actually\n            // have to display with spaces so that they align to columns multiple of 8.\n            while ((pos = str.search(\"\\t\")) >= 0) {\n                var indent = \"        \".substr(0, 8 - (cc + pos) % 8);\n                str = str.substr(0, pos) + indent + str.substr(pos + 1);\n            }\n        }\n\n        if (!found) {\n            prevLineBottom = box.bottom;\n        }\n        drawText(str, box);\n    }\n\n    function drawText(str, box) {\n        // In IE the box height will be approximately lineHeight, while in\n        // other browsers it'll (correctly) be the height of the bounding\n        // box for the current text/font.  Which is to say, IE sucks again.\n        // The only good solution I can think of is to measure the text\n        // ourselves and center the bounding box.\n        if (microsoft && !isNaN(lineHeight)) {\n            var height = getFontHeight(font);\n            var top = (box.top + box.bottom - height) / 2;\n            box = {\n                top    : top,\n                right  : box.right,\n                bottom : top + height,\n                left   : box.left,\n                height : height,\n                width  : box.right - box.left\n            };\n        }\n\n        // var path = new Path({ stroke: { color: \"red\" }});\n        // path.moveTo(box.left, box.top)\n        //     .lineTo(box.right, box.top)\n        //     .lineTo(box.right, box.bottom)\n        //     .lineTo(box.left, box.bottom)\n        //     .close();\n        // group.append(path);\n\n        switch (textTransform) {\n          case \"uppercase\":\n            str = str.toUpperCase();\n            break;\n          case \"lowercase\":\n            str = str.toLowerCase();\n            break;\n          case \"capitalize\":\n            str = str.replace(/(?:^|\\s)\\S/g, function (l) { return l.toUpperCase(); });\n            break;\n        }\n\n        var text = new TextRect(\n            str, new geo.Rect([ box.left, box.top ],\n                              [ box.width, box.height ]),\n            {\n                font: font,\n                fill: { color: color }\n            }\n        );\n        group.append(text);\n    }\n\n    function decorate(box) {\n        line(underline, box.bottom);\n        line(lineThrough, box.bottom - box.height / 2.7);\n        line(overline, box.top);\n        function line(color, ypos) {\n            if (color) {\n                var width = fontSize / 12;\n                var path = new Path({ stroke: {\n                    width: width,\n                    color: color\n                }});\n\n                ypos -= width;\n                path.moveTo(box.left, ypos)\n                    .lineTo(box.right, ypos);\n                group.append(path);\n            }\n        }\n    }\n}\n\nfunction groupInStackingContext(element, group, zIndex) {\n    var main;\n    if (zIndex != \"auto\") {\n        // use the current stacking context\n        main = nodeInfo._stackingContext.group;\n        zIndex = parseFloat(zIndex);\n    } else {\n        // normal flow â€” use given container.  we still have to\n        // figure out where should we insert this element with the\n        // assumption that its z-index is zero, as the group might\n        // already contain elements with higher z-index.\n        main = group;\n        zIndex = 0;\n    }\n    var a = main.children;\n    for (var i = 0; i < a.length; ++i) {\n        if (a[i]._dom_zIndex != null && a[i]._dom_zIndex > zIndex) {\n            break;\n        }\n    }\n\n    var tmp = new Group();\n    main.insert(i, tmp);\n    tmp._dom_zIndex = zIndex;\n\n    if (main !== group) {\n        // console.log(\"Placing\", element, \"in\", nodeInfo._stackingContext.element, \"at position\", i, \" / \", a.length);\n        // console.log(a.slice(i+1));\n\n        // if (nodeInfo._matrix) {\n        //     tmp.transform(nodeInfo._matrix);\n        // }\n        if (nodeInfo._clipbox) {\n            var m = nodeInfo._matrix.invert();\n            var r = nodeInfo._clipbox.transformCopy(m);\n            setClipping(tmp, Path.fromRect(r));\n            // console.log(r);\n            // tmp.append(Path.fromRect(r));\n            // tmp.append(new Text(element.className || element.id, r.topLeft()));\n        }\n    }\n\n    return tmp;\n}\n\nfunction renderElement(element, container) {\n    var style = getComputedStyle(element);\n\n    updateCounters(style);\n\n    if (/^(style|script|link|meta|iframe|col|colgroup)$/i.test(element.tagName)) {\n        return;\n    }\n\n    if (nodeInfo._clipbox == null) {\n        return;\n    }\n\n    var opacity = parseFloat(getPropertyValue(style, \"opacity\"));\n    var visibility = getPropertyValue(style, \"visibility\");\n    var display = getPropertyValue(style, \"display\");\n\n    if (opacity === 0 || visibility == \"hidden\" || display == \"none\") {\n        return;\n    }\n\n    var tr = getTransform(style);\n    var group;\n\n    var zIndex = getPropertyValue(style, \"z-index\");\n    if ((tr || opacity < 1) && zIndex == \"auto\") {\n        zIndex = 0;\n    }\n    group = groupInStackingContext(element, container, zIndex);\n\n    // XXX: remove at some point\n    // group._pdfElement = element;\n    // group.options._pdfDebug = \"\";\n    // if (element.id) {\n    //     group.options._pdfDebug = \"#\" + element.id;\n    // }\n    // if (element.className) {\n    //     group.options._pdfDebug += \".\" + element.className.split(\" \").join(\".\");\n    // }\n\n    if (opacity < 1) {\n        group.opacity(opacity * group.opacity());\n    }\n\n    pushNodeInfo(element, style, group);\n\n    if (!tr) {\n        _renderWithPseudoElements(element, group);\n    }\n    else {\n        saveStyle(element, function(){\n            // must clear transform, so getBoundingClientRect returns correct values.\n            pleaseSetPropertyValue(element.style, \"transform\", \"none\", \"important\");\n\n            // must also clear transitions, so correct values are returned *immediately*\n            pleaseSetPropertyValue(element.style, \"transition\", \"none\", \"important\");\n\n            // the presence of any transform makes it behave like it had position: relative,\n            // because why not.\n            // http://meyerweb.com/eric/thoughts/2011/09/12/un-fixing-fixed-elements-with-css-transforms/\n            if (getPropertyValue(style, \"position\") == \"static\") {\n                // but only if it's not already positioned. :-/\n                pleaseSetPropertyValue(element.style, \"position\", \"relative\", \"important\");\n            }\n\n            // must translate to origin before applying the CSS\n            // transformation, then translate back.\n            var bbox = element.getBoundingClientRect();\n            var x = bbox.left + tr.origin[0];\n            var y = bbox.top + tr.origin[1];\n            var m = [ 1, 0, 0, 1, -x, -y ];\n            m = mmul(m, tr.matrix);\n            m = mmul(m, [ 1, 0, 0, 1, x, y ]);\n            m = setTransform(group, m);\n\n            nodeInfo._matrix = nodeInfo._matrix.multiplyCopy(m);\n\n            _renderWithPseudoElements(element, group);\n        });\n    }\n\n    popNodeInfo();\n\n    //drawDebugBox(element.getBoundingClientRect(), container);\n}\n\n// function drawDebugBox(box, group, color) {\n//     var path = Path.fromRect(new geo.Rect([ box.left, box.top ], [ box.width, box.height ]));\n//     if (color) {\n//         path.stroke(color);\n//     }\n//     group.append(path);\n// }\n\n// function dumpTextNode(node) {\n//     var txt = node.data.replace(/^\\s+/, \"\");\n//     if (txt.length < 100) {\n//         console.log(node.data.length + \": |\" + txt);\n//     } else {\n//         console.log(node.data.length + \": |\" + txt.substr(0, 50) + \"|...|\" + txt.substr(-50));\n//     }\n// }\n\nfunction mmul(a, b) {\n    var a1 = a[0], b1 = a[1], c1 = a[2], d1 = a[3], e1 = a[4], f1 = a[5];\n    var a2 = b[0], b2 = b[1], c2 = b[2], d2 = b[3], e2 = b[4], f2 = b[5];\n    return [\n        a1*a2 + b1*c2,          a1*b2 + b1*d2,\n        c1*a2 + d1*c2,          c1*b2 + d1*d2,\n        e1*a2 + f1*c2 + e2,     e1*b2 + f1*d2 + f2\n    ];\n}\n\nexport { drawDOM, drawText, getFontFaces };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}