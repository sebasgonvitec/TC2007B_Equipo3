{"ast":null,"code":"/* eslint-disable no-multi-spaces, key-spacing, indent, camelcase, space-before-blocks, eqeqeq, brace-style */\n\n/* eslint-disable space-infix-ops, space-before-function-paren, array-bracket-spacing, object-curly-spacing */\n\n/* eslint-disable no-nested-ternary, max-params, default-case, no-else-return, no-empty */\n\n/* eslint-disable no-param-reassign, no-var, block-scoped-var */\nimport { createPromise } from \"../util\";\nimport { parseColor as utils_parseColor, saveAs as util_saveAs, support } from \"../common\";\nimport * as PDF from \"./core\";\nimport { Group, Path, MultiPath, Gradient, RadialGradient } from '../drawing';\nimport * as geo from \"../geometry\";\nvar DEFAULT_IMAGE_DPI = 300;\nvar TEXT_RENDERING_MODE = PDF.TEXT_RENDERING_MODE;\nvar DASH_PATTERNS = {\n  dash: [4],\n  dashDot: [4, 2, 1, 2],\n  dot: [1, 2],\n  longDash: [8, 2],\n  longDashDot: [8, 2, 1, 2],\n  longDashDotDot: [8, 2, 1, 2, 1, 2],\n  solid: []\n};\nvar LINE_CAP = {\n  butt: 0,\n  round: 1,\n  square: 2\n};\nvar LINE_JOIN = {\n  miter: 0,\n  round: 1,\n  bevel: 2\n};\n\nfunction render(group, callback) {\n  var fonts = [],\n      images = {},\n      options = group.options;\n\n  function getOption(name, defval, hash) {\n    if (!hash) {\n      hash = options;\n    }\n\n    if (hash.pdf && hash.pdf[name] != null) {\n      return hash.pdf[name];\n    }\n\n    return defval;\n  }\n\n  var multiPage = getOption(\"multiPage\");\n  var imgDPI = getOption(\"imgDPI\", DEFAULT_IMAGE_DPI);\n  PDF.clearImageCache();\n  group.traverse(function (element) {\n    dispatch({\n      Image: function (element) {\n        var url = element.src();\n        var size = element.bbox().size;\n\n        if (imgDPI) {\n          var prev = images[url];\n          size = {\n            width: Math.ceil(size.width * imgDPI / 72),\n            height: Math.ceil(size.height * imgDPI / 72)\n          };\n\n          if (prev) {\n            size.width = Math.max(prev.width, size.width);\n            size.height = Math.max(prev.height, size.height);\n          }\n        }\n\n        images[url] = size;\n      },\n      Text: function (element) {\n        var style = PDF.parseFontDef(element.options.font);\n        var url = PDF.getFontURL(style);\n\n        if (fonts.indexOf(url) < 0) {\n          fonts.push(url);\n        }\n      }\n    }, element);\n  });\n\n  function doIt() {\n    if (--count > 0) {\n      return;\n    }\n\n    var pdf = new PDF.Document({\n      producer: getOption(\"producer\"),\n      title: getOption(\"title\"),\n      author: getOption(\"author\"),\n      subject: getOption(\"subject\"),\n      keywords: getOption(\"keywords\"),\n      creator: getOption(\"creator\"),\n      date: getOption(\"date\"),\n      autoPrint: getOption(\"autoPrint\")\n    });\n\n    function drawPage(group) {\n      var options = group.options;\n      var tmp = optimize(group);\n      var bbox = tmp.bbox;\n      group = tmp.root; // var tmp, bbox;\n\n      var paperSize = getOption(\"paperSize\", getOption(\"paperSize\", \"auto\"), options),\n          addMargin = false;\n\n      if (paperSize == \"auto\") {\n        if (bbox) {\n          var size = bbox.getSize();\n          paperSize = [size.width, size.height];\n          addMargin = true;\n          var origin = bbox.getOrigin();\n          tmp = new Group();\n          tmp.transform(new geo.Matrix(1, 0, 0, 1, -origin.x, -origin.y));\n          tmp.append(group);\n          group = tmp;\n        } else {\n          paperSize = \"A4\";\n        }\n      }\n\n      var page;\n      page = pdf.addPage({\n        paperSize: paperSize,\n        margin: getOption(\"margin\", getOption(\"margin\"), options),\n        addMargin: addMargin,\n        landscape: getOption(\"landscape\", getOption(\"landscape\", false), options)\n      });\n      drawElement(group, page, pdf);\n    }\n\n    if (multiPage) {\n      group.children.forEach(drawPage);\n    } else {\n      drawPage(group);\n    }\n\n    callback(pdf.render(), pdf);\n  }\n\n  var count = 2;\n  PDF.loadFonts(fonts, doIt);\n  PDF.loadImages(images, doIt, {\n    jpegQuality: getOption(\"jpegQuality\", 0.92),\n    keepPNG: getOption(\"keepPNG\", false)\n  });\n}\n\nfunction toDataURL(group, callback) {\n  render(group, function (data) {\n    callback(\"data:application/pdf;base64,\" + data.base64());\n  });\n}\n\nfunction toBlob(group, callback) {\n  render(group, function (data) {\n    callback(new window.Blob([data.get()], {\n      type: \"application/pdf\"\n    }));\n  });\n}\n\nfunction saveAs(group, filename, proxy, callback) {\n  // XXX: Safari has Blob, but does not support the download attribute\n  //      so we'd end up converting to dataURL and using the proxy anyway.\n  if (window.Blob && !support.browser.safari) {\n    toBlob(group, function (blob) {\n      util_saveAs({\n        dataURI: blob,\n        fileName: filename\n      });\n\n      if (callback) {\n        callback(blob);\n      }\n    });\n  } else {\n    toDataURL(group, function (dataURL) {\n      util_saveAs({\n        dataURI: dataURL,\n        fileName: filename,\n        proxyURL: proxy\n      });\n\n      if (callback) {\n        callback(dataURL);\n      }\n    });\n  }\n}\n\nfunction dispatch(handlers, element) {\n  var handler = handlers[element.nodeType];\n\n  if (handler) {\n    return handler.call.apply(handler, arguments);\n  }\n\n  return element;\n}\n\nfunction drawElement(element, page, pdf) {\n  if (element.options._pdfDebug) {\n    page.comment(\"BEGIN: \" + element.options._pdfDebug);\n  }\n\n  var transform = element.transform();\n  var opacity = element.opacity();\n  page.save();\n\n  if (opacity != null && opacity < 1) {\n    page.setOpacity(opacity);\n  }\n\n  setStrokeOptions(element, page, pdf);\n  setFillOptions(element, page, pdf);\n\n  if (transform) {\n    var m = transform.matrix();\n    page.transform(m.a, m.b, m.c, m.d, m.e, m.f);\n  }\n\n  setClipping(element, page, pdf);\n  dispatch({\n    Path: drawPath,\n    MultiPath: drawMultiPath,\n    Circle: drawCircle,\n    Arc: drawArc,\n    Text: drawText,\n    Image: drawImage,\n    Group: drawGroup,\n    Rect: drawRect\n  }, element, page, pdf);\n  page.restore();\n\n  if (element.options._pdfDebug) {\n    page.comment(\"END: \" + element.options._pdfDebug);\n  }\n}\n\nfunction setStrokeOptions(element, page) {\n  var stroke = element.stroke && element.stroke();\n\n  if (!stroke) {\n    return;\n  }\n\n  var color = stroke.color;\n\n  if (color) {\n    color = parseColor(color);\n\n    if (color == null) {\n      return; // no stroke\n    }\n\n    page.setStrokeColor(color.r, color.g, color.b);\n\n    if (color.a != 1) {\n      page.setStrokeOpacity(color.a);\n    }\n  }\n\n  var width = stroke.width;\n\n  if (width != null) {\n    if (width === 0) {\n      return; // no stroke\n    }\n\n    page.setLineWidth(width);\n  }\n\n  var dashType = stroke.dashType;\n\n  if (dashType) {\n    page.setDashPattern(DASH_PATTERNS[dashType], 0);\n  }\n\n  var lineCap = stroke.lineCap;\n\n  if (lineCap) {\n    page.setLineCap(LINE_CAP[lineCap]);\n  }\n\n  var lineJoin = stroke.lineJoin;\n\n  if (lineJoin) {\n    page.setLineJoin(LINE_JOIN[lineJoin]);\n  }\n\n  var opacity = stroke.opacity;\n\n  if (opacity != null) {\n    page.setStrokeOpacity(opacity);\n  }\n}\n\nfunction setFillOptions(element, page) {\n  var fill = element.fill && element.fill();\n\n  if (!fill) {\n    return;\n  }\n\n  if (fill instanceof Gradient) {\n    return;\n  }\n\n  var color = fill.color;\n\n  if (color) {\n    color = parseColor(color);\n\n    if (color == null) {\n      return; // no fill\n    }\n\n    page.setFillColor(color.r, color.g, color.b);\n\n    if (color.a != 1) {\n      page.setFillOpacity(color.a);\n    }\n  }\n\n  var opacity = fill.opacity;\n\n  if (opacity != null) {\n    page.setFillOpacity(opacity);\n  }\n}\n\nfunction setClipping(element, page, pdf) {\n  // XXX: only Path supported at the moment.\n  var clip = element.clip();\n\n  if (clip) {\n    _drawPath(clip, page, pdf);\n\n    page.clip(); // page.setStrokeColor(Math.random(), Math.random(), Math.random());\n    // page.setLineWidth(1);\n    // page.stroke();\n  }\n}\n\nfunction shouldDraw(thing) {\n  return thing && (thing instanceof Gradient || thing.color && !/^(none|transparent)$/i.test(thing.color) && (thing.width == null || thing.width > 0) && (thing.opacity == null || thing.opacity > 0));\n}\n\nfunction maybeGradient(element, page, pdf, stroke) {\n  var fill = element.fill();\n\n  if (fill instanceof Gradient) {\n    if (stroke) {\n      page.clipStroke();\n    } else {\n      page.clip();\n    }\n\n    var isRadial = fill instanceof RadialGradient;\n    var start, end;\n\n    if (isRadial) {\n      start = {\n        x: fill.center().x,\n        y: fill.center().y,\n        r: 0\n      };\n      end = {\n        x: fill.center().x,\n        y: fill.center().y,\n        r: fill.radius()\n      };\n    } else {\n      start = {\n        x: fill.start().x,\n        y: fill.start().y\n      };\n      end = {\n        x: fill.end().x,\n        y: fill.end().y\n      };\n    }\n\n    var stops = fill.stops.elements().map(function (stop) {\n      var offset = stop.offset();\n\n      if (/%$/.test(offset)) {\n        offset = parseFloat(offset) / 100;\n      } else {\n        offset = parseFloat(offset);\n      }\n\n      var color = parseColor(stop.color());\n      color.a *= stop.opacity();\n      return {\n        offset: offset,\n        color: color\n      };\n    }); // Duplicats first and last stop to fix\n    // https://github.com/telerik/kendo-ui-core/issues/1782\n\n    stops.unshift(stops[0]);\n    stops.push(stops[stops.length - 1]);\n    var gradient = {\n      userSpace: fill.userSpace(),\n      type: isRadial ? \"radial\" : \"linear\",\n      start: start,\n      end: end,\n      stops: stops\n    };\n    var box = element.rawBBox();\n    var tl = box.topLeft(),\n        size = box.getSize();\n    box = {\n      left: tl.x,\n      top: tl.y,\n      width: size.width,\n      height: size.height\n    };\n    page.gradient(gradient, box);\n    return true;\n  }\n}\n\nfunction maybeFillStroke(element, page, pdf) {\n  if (shouldDraw(element.fill()) && shouldDraw(element.stroke())) {\n    if (!maybeGradient(element, page, pdf, true)) {\n      page.fillStroke();\n    }\n  } else if (shouldDraw(element.fill())) {\n    if (!maybeGradient(element, page, pdf, false)) {\n      page.fill();\n    }\n  } else if (shouldDraw(element.stroke())) {\n    page.stroke();\n  } else {\n    // we should not get here; the path should have been\n    // optimized away.  but let's be prepared.\n    page.nop();\n  }\n}\n\nfunction maybeDrawRect(path, page) {\n  var segments = path.segments;\n\n  if (segments.length == 4 && path.options.closed) {\n    // detect if this path looks like a rectangle parallel to the axis\n    var a = [];\n\n    for (var i = 0; i < segments.length; ++i) {\n      if (segments[i].controlIn()) {\n        // has curve?\n        return false;\n      }\n\n      a[i] = segments[i].anchor();\n    } // it's a rectangle if the y/x/y/x or x/y/x/y coords of\n    // consecutive points are the same.\n\n\n    var isRect = a[0].y == a[1].y && a[1].x == a[2].x && a[2].y == a[3].y && a[3].x == a[0].x || a[0].x == a[1].x && a[1].y == a[2].y && a[2].x == a[3].x && a[3].y == a[0].y;\n\n    if (isRect) {\n      // this saves a bunch of instructions in PDF:\n      // moveTo, lineTo, lineTo, lineTo, close -> rect.\n      page.rect(a[0].x, a[0].y, a[2].x - a[0].x\n      /*width*/\n      , a[2].y - a[0].y\n      /*height*/\n      );\n      return true;\n    }\n  }\n}\n\nfunction _drawPath(element, page, pdf) {\n  var segments = element.segments;\n\n  if (segments.length === 0) {\n    return;\n  }\n\n  if (!maybeDrawRect(element, page, pdf)) {\n    for (var prev, i = 0; i < segments.length; ++i) {\n      var seg = segments[i];\n      var anchor = seg.anchor();\n\n      if (!prev) {\n        page.moveTo(anchor.x, anchor.y);\n      } else {\n        var prevOut = prev.controlOut();\n        var controlIn = seg.controlIn();\n\n        if (prevOut && controlIn) {\n          page.bezier(prevOut.x, prevOut.y, controlIn.x, controlIn.y, anchor.x, anchor.y);\n        } else {\n          page.lineTo(anchor.x, anchor.y);\n        }\n      }\n\n      prev = seg;\n    }\n\n    if (element.options.closed) {\n      page.close();\n    }\n  }\n}\n\nfunction drawPath(element, page, pdf) {\n  _drawPath(element, page, pdf);\n\n  maybeFillStroke(element, page, pdf);\n}\n\nfunction drawMultiPath(element, page, pdf) {\n  var paths = element.paths;\n\n  for (var i = 0; i < paths.length; ++i) {\n    _drawPath(paths[i], page, pdf);\n  }\n\n  maybeFillStroke(element, page, pdf);\n}\n\nfunction drawCircle(element, page, pdf) {\n  var g = element.geometry();\n  page.circle(g.center.x, g.center.y, g.radius);\n  maybeFillStroke(element, page, pdf);\n}\n\nfunction drawArc(element, page, pdf) {\n  var points = element.geometry().curvePoints();\n  page.moveTo(points[0].x, points[0].y);\n\n  for (var i = 1; i < points.length;) {\n    page.bezier(points[i].x, points[i++].y, points[i].x, points[i++].y, points[i].x, points[i++].y);\n  }\n\n  maybeFillStroke(element, page, pdf);\n}\n\nfunction drawText(element, page) {\n  var style = PDF.parseFontDef(element.options.font);\n  var pos = element._position;\n  var mode;\n\n  if (element.fill() && element.stroke()) {\n    mode = TEXT_RENDERING_MODE.fillAndStroke;\n  } else if (element.fill()) {\n    mode = TEXT_RENDERING_MODE.fill;\n  } else if (element.stroke()) {\n    mode = TEXT_RENDERING_MODE.stroke;\n  }\n\n  page.transform(1, 0, 0, -1, pos.x, pos.y + style.fontSize);\n  page.beginText();\n  page.setFont(PDF.getFontURL(style), style.fontSize);\n  page.setTextRenderingMode(mode);\n  page.showText(element.content(), element._pdfRect ? element._pdfRect.width() : null);\n  page.endText();\n}\n\nfunction drawGroup(element, page, pdf) {\n  if (element._pdfLink) {\n    page.addLink(element._pdfLink.url, element._pdfLink);\n  }\n\n  var children = element.children;\n\n  for (var i = 0; i < children.length; ++i) {\n    drawElement(children[i], page, pdf);\n  }\n}\n\nfunction drawImage(element, page) {\n  var url = element.src();\n\n  if (!url) {\n    return;\n  }\n\n  var rect = element.rect();\n  var tl = rect.getOrigin();\n  var sz = rect.getSize();\n  page.transform(sz.width, 0, 0, -sz.height, tl.x, tl.y + sz.height);\n  page.drawImage(url);\n}\n\nfunction drawRect(element, page, pdf) {\n  var geometry = element.geometry();\n  var ref = geometry.cornerRadius;\n  var rx = ref[0];\n  var ry = ref[1];\n\n  if (rx === 0 && ry === 0) {\n    page.rect(geometry.origin.x, geometry.origin.y, geometry.size.width, geometry.size.height);\n    maybeFillStroke(element, page, pdf);\n  } else {\n    drawPath(Path.fromRect(geometry, element.options), page, pdf);\n  }\n}\n\nfunction parseColor(value) {\n  var color = utils_parseColor(value, true);\n  return color ? color.toRGB() : null;\n}\n\nfunction optimize(root) {\n  var clipbox = false;\n  var matrix = geo.Matrix.unit();\n  var currentBox = null;\n  var changed;\n\n  do {\n    changed = false;\n    root = opt(root);\n  } while (root && changed);\n\n  return {\n    root: root,\n    bbox: currentBox\n  };\n\n  function change(newShape) {\n    changed = true;\n    return newShape;\n  }\n\n  function visible(shape) {\n    return shape.visible() && shape.opacity() > 0 && (shouldDraw(shape.fill()) || shouldDraw(shape.stroke()));\n  }\n\n  function optArray(a) {\n    var b = [];\n\n    for (var i = 0; i < a.length; ++i) {\n      var el = opt(a[i]);\n\n      if (el != null) {\n        b.push(el);\n      }\n    }\n\n    return b;\n  }\n\n  function withClipping(shape, f) {\n    var saveclipbox = clipbox;\n    var savematrix = matrix;\n\n    if (shape.transform()) {\n      matrix = matrix.multiplyCopy(shape.transform().matrix());\n    }\n\n    var clip = shape.clip();\n\n    if (clip) {\n      clip = clip.bbox();\n\n      if (clip) {\n        clip = clip.bbox(matrix);\n        clipbox = clipbox ? geo.Rect.intersect(clipbox, clip) : clip;\n      }\n    }\n\n    try {\n      return f();\n    } finally {\n      clipbox = saveclipbox;\n      matrix = savematrix;\n    }\n  }\n\n  function inClipbox(shape) {\n    if (clipbox == null) {\n      return false;\n    }\n\n    var box = shape.rawBBox().bbox(matrix);\n\n    if (clipbox && box) {\n      box = geo.Rect.intersect(box, clipbox);\n    }\n\n    return box;\n  }\n\n  function opt(shape) {\n    return withClipping(shape, function () {\n      if (!(shape instanceof Group || shape instanceof MultiPath)) {\n        var box = inClipbox(shape);\n\n        if (!box) {\n          return change(null);\n        }\n\n        currentBox = currentBox ? geo.Rect.union(currentBox, box) : box;\n      }\n\n      return dispatch({\n        Path: function (shape) {\n          if (shape.segments.length === 0 || !visible(shape)) {\n            return change(null);\n          }\n\n          return shape;\n        },\n        MultiPath: function (shape) {\n          if (!visible(shape)) {\n            return change(null);\n          }\n\n          var el = new MultiPath(shape.options);\n          el.paths = optArray(shape.paths);\n\n          if (el.paths.length === 0) {\n            return change(null);\n          }\n\n          return el;\n        },\n        Circle: function (shape) {\n          if (!visible(shape)) {\n            return change(null);\n          }\n\n          return shape;\n        },\n        Arc: function (shape) {\n          if (!visible(shape)) {\n            return change(null);\n          }\n\n          return shape;\n        },\n        Text: function (shape) {\n          if (!/\\S/.test(shape.content()) || !visible(shape)) {\n            return change(null);\n          }\n\n          return shape;\n        },\n        Image: function (shape) {\n          if (!(shape.visible() && shape.opacity() > 0)) {\n            return change(null);\n          }\n\n          return shape;\n        },\n        Group: function (shape) {\n          if (!(shape.visible() && shape.opacity() > 0)) {\n            return change(null);\n          }\n\n          var el = new Group(shape.options);\n          el.children = optArray(shape.children);\n          el._pdfLink = shape._pdfLink;\n\n          if (shape !== root && el.children.length === 0 && !shape._pdfLink) {\n            return change(null);\n          }\n\n          return el;\n        },\n        Rect: function (shape) {\n          if (!visible(shape)) {\n            return change(null);\n          }\n\n          return shape;\n        }\n      }, shape);\n    });\n  }\n}\n\nfunction exportPDF(group, options) {\n  var promise = createPromise();\n\n  for (var i in options) {\n    if (i == \"margin\" && group.options.pdf && group.options.pdf._ignoreMargin) {\n      // This hackish option is set by the page breaking code in drawDOM.  The idea is\n      // that margin is already taken into account there (that's required to do proper\n      // page breaking) and we don't want to set it again here, as it would double the\n      // top-left margin, and truncate the content on bottom/right.\n      continue;\n    }\n\n    group.options.set(\"pdf.\" + i, options[i]);\n  }\n\n  toDataURL(group, promise.resolve);\n  return promise;\n} // XXX: the duplication is in order to keep exportPDF return a data\n// URI, which is what previous versions do.  Currently only IE9 does\n// not support Blob, IMO we should switch to Blob by default\n// everywhere.\n\n\nfunction exportPDFToBlob(group, options) {\n  var promise = createPromise();\n\n  for (var i in options) {\n    if (i == \"margin\" && group.options.pdf && group.options.pdf._ignoreMargin) {\n      // This hackish option is set by the page breaking code in drawDOM.  The idea is\n      // that margin is already taken into account there (that's required to do proper\n      // page breaking) and we don't want to set it again here, as it would double the\n      // top-left margin, and truncate the content on bottom/right.\n      continue;\n    }\n\n    group.options.set(\"pdf.\" + i, options[i]);\n  }\n\n  if (window.Blob && !support.browser.safari) {\n    toBlob(group, promise.resolve);\n  } else {\n    toDataURL(group, promise.resolve);\n  }\n\n  return promise;\n}\n\nexport { exportPDF, exportPDFToBlob, saveAs, toDataURL, toBlob, render };","map":{"version":3,"names":["createPromise","parseColor","utils_parseColor","saveAs","util_saveAs","support","PDF","Group","Path","MultiPath","Gradient","RadialGradient","geo","DEFAULT_IMAGE_DPI","TEXT_RENDERING_MODE","DASH_PATTERNS","dash","dashDot","dot","longDash","longDashDot","longDashDotDot","solid","LINE_CAP","butt","round","square","LINE_JOIN","miter","bevel","render","group","callback","fonts","images","options","getOption","name","defval","hash","pdf","multiPage","imgDPI","clearImageCache","traverse","element","dispatch","Image","url","src","size","bbox","prev","width","Math","ceil","height","max","Text","style","parseFontDef","font","getFontURL","indexOf","push","doIt","count","Document","producer","title","author","subject","keywords","creator","date","autoPrint","drawPage","tmp","optimize","root","paperSize","addMargin","getSize","origin","getOrigin","transform","Matrix","x","y","append","page","addPage","margin","landscape","drawElement","children","forEach","loadFonts","loadImages","jpegQuality","keepPNG","toDataURL","data","base64","toBlob","window","Blob","get","type","filename","proxy","browser","safari","blob","dataURI","fileName","dataURL","proxyURL","handlers","handler","nodeType","call","apply","arguments","_pdfDebug","comment","opacity","save","setOpacity","setStrokeOptions","setFillOptions","m","matrix","a","b","c","d","e","f","setClipping","drawPath","drawMultiPath","Circle","drawCircle","Arc","drawArc","drawText","drawImage","drawGroup","Rect","drawRect","restore","stroke","color","setStrokeColor","r","g","setStrokeOpacity","setLineWidth","dashType","setDashPattern","lineCap","setLineCap","lineJoin","setLineJoin","fill","setFillColor","setFillOpacity","clip","_drawPath","shouldDraw","thing","test","maybeGradient","clipStroke","isRadial","start","end","center","radius","stops","elements","map","stop","offset","parseFloat","unshift","length","gradient","userSpace","box","rawBBox","tl","topLeft","left","top","maybeFillStroke","fillStroke","nop","maybeDrawRect","path","segments","closed","i","controlIn","anchor","isRect","rect","seg","moveTo","prevOut","controlOut","bezier","lineTo","close","paths","geometry","circle","points","curvePoints","pos","_position","mode","fillAndStroke","fontSize","beginText","setFont","setTextRenderingMode","showText","content","_pdfRect","endText","_pdfLink","addLink","sz","ref","cornerRadius","rx","ry","fromRect","value","toRGB","clipbox","unit","currentBox","changed","opt","change","newShape","visible","shape","optArray","el","withClipping","saveclipbox","savematrix","multiplyCopy","intersect","inClipbox","union","exportPDF","promise","_ignoreMargin","set","resolve","exportPDFToBlob"],"sources":["C:/Users/asana/Documents/TEC/Semestre 5/Seguridad_Informatica/ModuloReact/Admin/frontend/node_modules/@progress/kendo-drawing/dist/es/pdf/drawing.js"],"sourcesContent":["/* eslint-disable no-multi-spaces, key-spacing, indent, camelcase, space-before-blocks, eqeqeq, brace-style */\n/* eslint-disable space-infix-ops, space-before-function-paren, array-bracket-spacing, object-curly-spacing */\n/* eslint-disable no-nested-ternary, max-params, default-case, no-else-return, no-empty */\n/* eslint-disable no-param-reassign, no-var, block-scoped-var */\n\nimport { createPromise } from \"../util\";\nimport { parseColor as utils_parseColor, saveAs as util_saveAs, support } from \"../common\";\nimport * as PDF from \"./core\";\nimport { Group, Path, MultiPath, Gradient, RadialGradient } from '../drawing';\nimport * as geo from \"../geometry\";\n\nvar DEFAULT_IMAGE_DPI = 300;\nvar TEXT_RENDERING_MODE = PDF.TEXT_RENDERING_MODE;\n\nvar DASH_PATTERNS = {\n    dash           : [ 4 ],\n    dashDot        : [ 4, 2, 1, 2 ],\n    dot            : [ 1, 2 ],\n    longDash       : [ 8, 2 ],\n    longDashDot    : [ 8, 2, 1, 2 ],\n    longDashDotDot : [ 8, 2, 1, 2, 1, 2 ],\n    solid          : []\n};\n\nvar LINE_CAP = {\n    butt   : 0,\n    round  : 1,\n    square : 2\n};\n\nvar LINE_JOIN = {\n    miter : 0,\n    round : 1,\n    bevel : 2\n};\n\nfunction render(group, callback) {\n    var fonts = [], images = {}, options = group.options;\n\n    function getOption(name, defval, hash) {\n        if (!hash) {\n            hash = options;\n        }\n        if (hash.pdf && hash.pdf[name] != null) {\n            return hash.pdf[name];\n        }\n        return defval;\n    }\n\n    var multiPage = getOption(\"multiPage\");\n    var imgDPI = getOption(\"imgDPI\", DEFAULT_IMAGE_DPI);\n\n    PDF.clearImageCache();\n\n    group.traverse(function(element){\n        dispatch({\n            Image: function(element) {\n                var url = element.src();\n                var size = element.bbox().size;\n                if (imgDPI) {\n                    var prev = images[url];\n                    size = {\n                      width: Math.ceil(size.width * imgDPI / 72),\n                      height: Math.ceil(size.height * imgDPI / 72)\n                    };\n\n                    if (prev) {\n                      size.width = Math.max(prev.width, size.width);\n                      size.height = Math.max(prev.height, size.height);\n                    }\n                }\n\n                images[url] = size;\n            },\n            Text: function(element) {\n                var style = PDF.parseFontDef(element.options.font);\n                var url = PDF.getFontURL(style);\n                if (fonts.indexOf(url) < 0) {\n                    fonts.push(url);\n                }\n            }\n        }, element);\n    });\n\n    function doIt() {\n        if (--count > 0) {\n            return;\n        }\n\n        var pdf = new (PDF.Document)({\n            producer  : getOption(\"producer\"),\n            title     : getOption(\"title\"),\n            author    : getOption(\"author\"),\n            subject   : getOption(\"subject\"),\n            keywords  : getOption(\"keywords\"),\n            creator   : getOption(\"creator\"),\n            date      : getOption(\"date\"),\n\n            autoPrint : getOption(\"autoPrint\")\n        });\n\n        function drawPage(group) {\n            var options = group.options;\n\n            var tmp = optimize(group);\n            var bbox = tmp.bbox;\n            group = tmp.root;\n            // var tmp, bbox;\n\n            var paperSize = getOption(\"paperSize\", getOption(\"paperSize\", \"auto\"), options), addMargin = false;\n            if (paperSize == \"auto\") {\n                if (bbox) {\n                    var size = bbox.getSize();\n                    paperSize = [ size.width, size.height ];\n                    addMargin = true;\n                    var origin = bbox.getOrigin();\n                    tmp = new Group();\n                    tmp.transform(new geo.Matrix(1, 0, 0, 1, -origin.x, -origin.y));\n                    tmp.append(group);\n                    group = tmp;\n                }\n                else {\n                    paperSize = \"A4\";\n                }\n            }\n\n            var page;\n            page = pdf.addPage({\n                paperSize : paperSize,\n                margin    : getOption(\"margin\", getOption(\"margin\"), options),\n                addMargin : addMargin,\n                landscape : getOption(\"landscape\", getOption(\"landscape\", false), options)\n            });\n            drawElement(group, page, pdf);\n        }\n\n        if (multiPage) {\n            group.children.forEach(drawPage);\n        } else {\n            drawPage(group);\n        }\n\n        callback(pdf.render(), pdf);\n    }\n\n    var count = 2;\n    PDF.loadFonts(fonts, doIt);\n    PDF.loadImages(images, doIt, {\n        jpegQuality : getOption(\"jpegQuality\", 0.92),\n        keepPNG     : getOption(\"keepPNG\", false)\n    });\n}\n\nfunction toDataURL(group, callback) {\n    render(group, function(data){\n        callback(\"data:application/pdf;base64,\" + data.base64());\n    });\n}\n\nfunction toBlob(group, callback) {\n    render(group, function(data){\n        callback(new window.Blob([ data.get() ], { type: \"application/pdf\" }));\n    });\n}\n\nfunction saveAs(group, filename, proxy, callback) {\n    // XXX: Safari has Blob, but does not support the download attribute\n    //      so we'd end up converting to dataURL and using the proxy anyway.\n    if (window.Blob && !support.browser.safari) {\n        toBlob(group, function(blob){\n            util_saveAs({ dataURI: blob, fileName: filename });\n            if (callback) {\n                callback(blob);\n            }\n        });\n    } else {\n        toDataURL(group, function(dataURL){\n            util_saveAs({ dataURI: dataURL, fileName: filename, proxyURL: proxy });\n            if (callback) {\n                callback(dataURL);\n            }\n        });\n    }\n}\n\nfunction dispatch(handlers, element) {\n    var handler = handlers[element.nodeType];\n    if (handler) {\n        return handler.call.apply(handler, arguments);\n    }\n    return element;\n}\n\nfunction drawElement(element, page, pdf) {\n    if (element.options._pdfDebug) {\n        page.comment(\"BEGIN: \" + element.options._pdfDebug);\n    }\n\n    var transform = element.transform();\n    var opacity = element.opacity();\n\n    page.save();\n\n    if (opacity != null && opacity < 1) {\n        page.setOpacity(opacity);\n    }\n\n    setStrokeOptions(element, page, pdf);\n    setFillOptions(element, page, pdf);\n\n    if (transform) {\n        var m = transform.matrix();\n        page.transform(m.a, m.b, m.c, m.d, m.e, m.f);\n    }\n\n    setClipping(element, page, pdf);\n\n    dispatch({\n        Path      : drawPath,\n        MultiPath : drawMultiPath,\n        Circle    : drawCircle,\n        Arc       : drawArc,\n        Text      : drawText,\n        Image     : drawImage,\n        Group     : drawGroup,\n        Rect      : drawRect\n    }, element, page, pdf);\n\n    page.restore();\n\n    if (element.options._pdfDebug) {\n        page.comment(\"END: \" + element.options._pdfDebug);\n    }\n}\n\nfunction setStrokeOptions(element, page) {\n    var stroke = element.stroke && element.stroke();\n    if (!stroke) {\n        return;\n    }\n\n    var color = stroke.color;\n    if (color) {\n        color = parseColor(color);\n        if (color == null) {\n            return; // no stroke\n        }\n        page.setStrokeColor(color.r, color.g, color.b);\n        if (color.a != 1) {\n            page.setStrokeOpacity(color.a);\n        }\n    }\n\n    var width = stroke.width;\n    if (width != null) {\n        if (width === 0) {\n            return; // no stroke\n        }\n        page.setLineWidth(width);\n    }\n\n    var dashType = stroke.dashType;\n    if (dashType) {\n        page.setDashPattern(DASH_PATTERNS[dashType], 0);\n    }\n\n    var lineCap = stroke.lineCap;\n    if (lineCap) {\n        page.setLineCap(LINE_CAP[lineCap]);\n    }\n\n    var lineJoin = stroke.lineJoin;\n    if (lineJoin) {\n        page.setLineJoin(LINE_JOIN[lineJoin]);\n    }\n\n    var opacity = stroke.opacity;\n    if (opacity != null) {\n        page.setStrokeOpacity(opacity);\n    }\n}\n\nfunction setFillOptions(element, page) {\n    var fill = element.fill && element.fill();\n    if (!fill) {\n        return;\n    }\n\n    if (fill instanceof Gradient) {\n        return;\n    }\n\n    var color = fill.color;\n    if (color) {\n        color = parseColor(color);\n        if (color == null) {\n            return; // no fill\n        }\n        page.setFillColor(color.r, color.g, color.b);\n        if (color.a != 1) {\n            page.setFillOpacity(color.a);\n        }\n    }\n\n    var opacity = fill.opacity;\n    if (opacity != null) {\n        page.setFillOpacity(opacity);\n    }\n}\n\nfunction setClipping(element, page, pdf) {\n    // XXX: only Path supported at the moment.\n    var clip = element.clip();\n    if (clip) {\n        _drawPath(clip, page, pdf);\n        page.clip();\n        // page.setStrokeColor(Math.random(), Math.random(), Math.random());\n        // page.setLineWidth(1);\n        // page.stroke();\n    }\n}\n\nfunction shouldDraw(thing) {\n    return (thing &&\n            (thing instanceof Gradient ||\n             (thing.color && !/^(none|transparent)$/i.test(thing.color) &&\n              (thing.width == null || thing.width > 0) &&\n              (thing.opacity == null || thing.opacity > 0))));\n}\n\nfunction maybeGradient(element, page, pdf, stroke) {\n    var fill = element.fill();\n    if (fill instanceof Gradient) {\n        if (stroke) {\n            page.clipStroke();\n        } else {\n            page.clip();\n        }\n        var isRadial = fill instanceof RadialGradient;\n        var start, end;\n        if (isRadial) {\n            start = { x: fill.center().x , y: fill.center().y , r: 0 };\n            end   = { x: fill.center().x , y: fill.center().y , r: fill.radius() };\n        } else {\n            start = { x: fill.start().x , y: fill.start().y };\n            end   = { x: fill.end().x   , y: fill.end().y   };\n        }\n\n        var stops = fill.stops.elements().map(function(stop){\n            var offset = stop.offset();\n            if (/%$/.test(offset)) {\n                offset = parseFloat(offset) / 100;\n            } else {\n                offset = parseFloat(offset);\n            }\n            var color = parseColor(stop.color());\n            color.a *= stop.opacity();\n            return {\n                offset: offset,\n                color: color\n            };\n        });\n\n        // Duplicats first and last stop to fix\n        // https://github.com/telerik/kendo-ui-core/issues/1782\n        stops.unshift(stops[0]);\n        stops.push(stops[stops.length - 1]);\n\n        var gradient = {\n            userSpace : fill.userSpace(),\n            type      : isRadial ? \"radial\" : \"linear\",\n            start     : start,\n            end       : end,\n            stops     : stops\n        };\n        var box = element.rawBBox();\n        var tl = box.topLeft(), size = box.getSize();\n        box = {\n            left   : tl.x,\n            top    : tl.y,\n            width  : size.width,\n            height : size.height\n        };\n        page.gradient(gradient, box);\n        return true;\n    }\n}\n\nfunction maybeFillStroke(element, page, pdf) {\n    if (shouldDraw(element.fill()) && shouldDraw(element.stroke())) {\n        if (!maybeGradient(element, page, pdf, true)) {\n            page.fillStroke();\n        }\n    } else if (shouldDraw(element.fill())) {\n        if (!maybeGradient(element, page, pdf, false)) {\n            page.fill();\n        }\n    } else if (shouldDraw(element.stroke())) {\n        page.stroke();\n    } else {\n        // we should not get here; the path should have been\n        // optimized away.  but let's be prepared.\n        page.nop();\n    }\n}\n\nfunction maybeDrawRect(path, page) {\n    var segments = path.segments;\n    if (segments.length == 4 && path.options.closed) {\n        // detect if this path looks like a rectangle parallel to the axis\n        var a = [];\n        for (var i = 0; i < segments.length; ++i) {\n            if (segments[i].controlIn()) { // has curve?\n                return false;\n            }\n            a[i] = segments[i].anchor();\n        }\n        // it's a rectangle if the y/x/y/x or x/y/x/y coords of\n        // consecutive points are the same.\n        var isRect = (\n            a[0].y == a[1].y && a[1].x == a[2].x && a[2].y == a[3].y && a[3].x == a[0].x\n        ) || (\n            a[0].x == a[1].x && a[1].y == a[2].y && a[2].x == a[3].x && a[3].y == a[0].y\n        );\n        if (isRect) {\n            // this saves a bunch of instructions in PDF:\n            // moveTo, lineTo, lineTo, lineTo, close -> rect.\n            page.rect(a[0].x, a[0].y,\n                      a[2].x - a[0].x /*width*/,\n                      a[2].y - a[0].y /*height*/);\n            return true;\n        }\n    }\n}\n\nfunction _drawPath(element, page, pdf) {\n    var segments = element.segments;\n    if (segments.length === 0) {\n        return;\n    }\n    if (!maybeDrawRect(element, page, pdf)) {\n        for (var prev, i = 0; i < segments.length; ++i) {\n            var seg = segments[i];\n            var anchor = seg.anchor();\n            if (!prev) {\n                page.moveTo(anchor.x, anchor.y);\n            } else {\n                var prevOut = prev.controlOut();\n                var controlIn = seg.controlIn();\n                if (prevOut && controlIn) {\n                    page.bezier(\n                        prevOut.x   , prevOut.y,\n                        controlIn.x , controlIn.y,\n                        anchor.x    , anchor.y\n                    );\n                } else {\n                    page.lineTo(anchor.x, anchor.y);\n                }\n            }\n            prev = seg;\n        }\n        if (element.options.closed) {\n            page.close();\n        }\n    }\n}\n\nfunction drawPath(element, page, pdf) {\n    _drawPath(element, page, pdf);\n    maybeFillStroke(element, page, pdf);\n}\n\nfunction drawMultiPath(element, page, pdf) {\n    var paths = element.paths;\n    for (var i = 0; i < paths.length; ++i) {\n        _drawPath(paths[i], page, pdf);\n    }\n    maybeFillStroke(element, page, pdf);\n}\n\nfunction drawCircle(element, page, pdf) {\n    var g = element.geometry();\n    page.circle(g.center.x, g.center.y, g.radius);\n    maybeFillStroke(element, page, pdf);\n}\n\nfunction drawArc(element, page, pdf) {\n    var points = element.geometry().curvePoints();\n    page.moveTo(points[0].x, points[0].y);\n    for (var i = 1; i < points.length;) {\n        page.bezier(\n            points[i].x, points[i++].y,\n            points[i].x, points[i++].y,\n            points[i].x, points[i++].y\n        );\n    }\n    maybeFillStroke(element, page, pdf);\n}\n\nfunction drawText(element, page) {\n    var style = PDF.parseFontDef(element.options.font);\n    var pos = element._position;\n    var mode;\n    if (element.fill() && element.stroke()) {\n        mode = TEXT_RENDERING_MODE.fillAndStroke;\n    } else if (element.fill()) {\n        mode = TEXT_RENDERING_MODE.fill;\n    } else if (element.stroke()) {\n        mode = TEXT_RENDERING_MODE.stroke;\n    }\n\n    page.transform(1, 0, 0, -1, pos.x, pos.y + style.fontSize);\n    page.beginText();\n    page.setFont(PDF.getFontURL(style), style.fontSize);\n    page.setTextRenderingMode(mode);\n    page.showText(element.content(), element._pdfRect ? element._pdfRect.width() : null);\n    page.endText();\n}\n\nfunction drawGroup(element, page, pdf) {\n    if (element._pdfLink) {\n        page.addLink(element._pdfLink.url, element._pdfLink);\n    }\n    var children = element.children;\n    for (var i = 0; i < children.length; ++i) {\n        drawElement(children[i], page, pdf);\n    }\n}\n\nfunction drawImage(element, page) {\n    var url = element.src();\n    if (!url) {\n        return;\n    }\n\n    var rect = element.rect();\n    var tl = rect.getOrigin();\n    var sz = rect.getSize();\n    page.transform(sz.width, 0, 0, -sz.height, tl.x, tl.y + sz.height);\n    page.drawImage(url);\n}\n\nfunction drawRect(element, page, pdf) {\n    var geometry = element.geometry();\n    var ref = geometry.cornerRadius;\n    var rx = ref[0];\n    var ry = ref[1];\n    if (rx === 0 && ry === 0) {\n        page.rect(geometry.origin.x, geometry.origin.y, geometry.size.width, geometry.size.height);\n        maybeFillStroke(element, page, pdf);\n    } else {\n        drawPath(Path.fromRect(geometry, element.options), page, pdf);\n    }\n}\n\nfunction parseColor(value) {\n    var color = utils_parseColor(value, true);\n    return color ? color.toRGB() : null;\n}\n\nfunction optimize(root) {\n    var clipbox = false;\n    var matrix = geo.Matrix.unit();\n    var currentBox = null;\n    var changed;\n    do {\n        changed = false;\n        root = opt(root);\n    } while (root && changed);\n    return { root: root, bbox: currentBox };\n\n    function change(newShape) {\n        changed = true;\n        return newShape;\n    }\n\n    function visible(shape) {\n        return (shape.visible() && shape.opacity() > 0 &&\n                ( shouldDraw(shape.fill()) ||\n                  shouldDraw(shape.stroke()) ));\n    }\n\n    function optArray(a) {\n        var b = [];\n        for (var i = 0; i < a.length; ++i) {\n            var el = opt(a[i]);\n            if (el != null) {\n                b.push(el);\n            }\n        }\n        return b;\n    }\n\n    function withClipping(shape, f) {\n        var saveclipbox = clipbox;\n        var savematrix = matrix;\n\n        if (shape.transform()) {\n            matrix = matrix.multiplyCopy(shape.transform().matrix());\n        }\n\n        var clip = shape.clip();\n        if (clip) {\n            clip = clip.bbox();\n            if (clip) {\n                clip = clip.bbox(matrix);\n                clipbox = clipbox ? geo.Rect.intersect(clipbox, clip) : clip;\n            }\n        }\n\n        try {\n            return f();\n        }\n        finally {\n            clipbox = saveclipbox;\n            matrix = savematrix;\n        }\n    }\n\n    function inClipbox(shape) {\n        if (clipbox == null) {\n            return false;\n        }\n        var box = shape.rawBBox().bbox(matrix);\n        if (clipbox && box) {\n            box = geo.Rect.intersect(box, clipbox);\n        }\n        return box;\n    }\n\n    function opt(shape) {\n        return withClipping(shape, function(){\n            if (!(shape instanceof Group || shape instanceof MultiPath)) {\n                var box = inClipbox(shape);\n                if (!box) {\n                    return change(null);\n                }\n                currentBox = currentBox ? geo.Rect.union(currentBox, box) : box;\n            }\n            return dispatch({\n                Path: function(shape) {\n                    if (shape.segments.length === 0 || !visible(shape)) {\n                        return change(null);\n                    }\n                    return shape;\n                },\n                MultiPath: function(shape) {\n                    if (!visible(shape)) {\n                        return change(null);\n                    }\n                    var el = new MultiPath(shape.options);\n                    el.paths = optArray(shape.paths);\n                    if (el.paths.length === 0) {\n                        return change(null);\n                    }\n                    return el;\n                },\n                Circle: function(shape) {\n                    if (!visible(shape)) {\n                        return change(null);\n                    }\n                    return shape;\n                },\n                Arc: function(shape) {\n                    if (!visible(shape)) {\n                        return change(null);\n                    }\n                    return shape;\n                },\n                Text: function(shape) {\n                    if (!/\\S/.test(shape.content()) || !visible(shape)) {\n                        return change(null);\n                    }\n                    return shape;\n                },\n                Image: function(shape) {\n                    if (!(shape.visible() && shape.opacity() > 0)) {\n                        return change(null);\n                    }\n                    return shape;\n                },\n                Group: function(shape) {\n                    if (!(shape.visible() && shape.opacity() > 0)) {\n                        return change(null);\n                    }\n                    var el = new Group(shape.options);\n                    el.children = optArray(shape.children);\n                    el._pdfLink = shape._pdfLink;\n                    if (shape !== root && el.children.length === 0 && !shape._pdfLink) {\n                        return change(null);\n                    }\n                    return el;\n                },\n                Rect: function(shape) {\n                    if (!visible(shape)) {\n                        return change(null);\n                    }\n                    return shape;\n                }\n            }, shape);\n        });\n    }\n}\n\nfunction exportPDF(group, options) {\n    var promise = createPromise();\n\n    for (var i in options) {\n        if (i == \"margin\" && group.options.pdf && group.options.pdf._ignoreMargin) {\n            // This hackish option is set by the page breaking code in drawDOM.  The idea is\n            // that margin is already taken into account there (that's required to do proper\n            // page breaking) and we don't want to set it again here, as it would double the\n            // top-left margin, and truncate the content on bottom/right.\n            continue;\n        }\n        group.options.set(\"pdf.\" + i, options[i]);\n    }\n\n    toDataURL(group, promise.resolve);\n\n    return promise;\n}\n\n// XXX: the duplication is in order to keep exportPDF return a data\n// URI, which is what previous versions do.  Currently only IE9 does\n// not support Blob, IMO we should switch to Blob by default\n// everywhere.\nfunction exportPDFToBlob(group, options) {\n    var promise = createPromise();\n\n    for (var i in options) {\n        if (i == \"margin\" && group.options.pdf && group.options.pdf._ignoreMargin) {\n            // This hackish option is set by the page breaking code in drawDOM.  The idea is\n            // that margin is already taken into account there (that's required to do proper\n            // page breaking) and we don't want to set it again here, as it would double the\n            // top-left margin, and truncate the content on bottom/right.\n            continue;\n        }\n        group.options.set(\"pdf.\" + i, options[i]);\n    }\n\n    if (window.Blob && !support.browser.safari) {\n        toBlob(group, promise.resolve);\n    } else {\n        toDataURL(group, promise.resolve);\n    }\n\n    return promise;\n}\n\n\nexport { exportPDF, exportPDFToBlob, saveAs, toDataURL, toBlob, render };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}